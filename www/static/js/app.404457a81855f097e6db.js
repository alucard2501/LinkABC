webpackJsonp([1],{0:function(e,t){},"22e4":function(e,t,i){"use strict";(function(e){var a=i("//Fk"),o=i.n(a),s=i("Xxa5"),n=i.n(s),l=i("exGp"),c=i.n(l),r=i("NVJ6"),u=i("gQoh"),d=i("uxah"),m=i("XF4N");t.a={udp_client:null,ip:"",port:0,resetNetworkInfo:function(e,t){this.ip=e,this.port=t,u.a.log("切换到"+e+":"+t),this.udp_client=new UDP.Client(e,t)},sendRequestAddr:function(t,i){var a=this.buildCommand([13],0,0,r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_BUS,r.a.FUNCTION_CODE.READ);Object(m.e)(i,t).send(e.from(a))},sendRequestAddrDemo:function(){var t;if(null!=u.a.golbal.myProject.buses&&0!=u.a.golbal.myProject.buses.length){t=u.a.golbal.myProject.buses[0];var i=this.buildCommand([13],0,0,r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_BUS,r.a.FUNCTION_CODE.READ),a=Object(m.e)(d.a.receiveData,t.ws_url);Object(m.j)(e.from(i),a,t)}},buildCommand:function(e,t,i,a,o){var s=9;null!=e&&(s+=e.length);var n=[];if(n.push(r.a.HEAD[0]),n.push(r.a.HEAD[1]),n.push(s),n.push(null==t?0:parseInt(t)),n.push(null==i?0:parseInt(i)),n.push(a>>8),n.push(255&a),n.push(o),null!=e)for(var l=0;l<e.length;l++)n.push(e[l]);var c=0;for(l=3;l<n.length;l++)c+=n[l];return n.push(255&c),n},sendSaveBusUserid:function(t,i){var a=u.a.hexStringToBytes(t.addr),o=[];o.push(64),o.push(13);for(var s=0;s<12;s++)o.push(a[s]);var n=new Date;o.push(n.getSeconds()),o.push(n.getMinutes()),o.push(n.getHours()),o.push(n.getDate()),o.push(n.getDay()),o.push(n.getMonth()+1),o.push(n.getFullYear()-2e3),o.push(i>>24&255),o.push(i>>16&255),o.push(i>>8&255),o.push(255&i);var l=[];l.push(170),l.push(170),l.push(o.length+8),l.push(0),l.push(0),l.push(1),l.push(5);for(s=0;s<o.length;s++)l.push(o[s]);var c=0;for(s=3;s<l.length;s++)c+=l[s];l.push(255&c),console.log("==> "+u.a.bytes2hex(l));var r=Object(m.e)(d.a.receiveData,t.ws_url);Object(m.j)(e.from(l),r,t)},sendAction:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=this.getDeviceType(t),o=[],s=0;if(a==r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_SCENE||a==r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_SCENE||a==r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN_SCENE||a==r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE||a==r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_CURTAIN_SCENE||a==r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_CURTAIN_SCENE)switch(t.type){case"light":s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;var n=0;t.isOn&&(n=100),o.push(t.channel),o.push(n);break;case"dimmer":case"process_curtain":case"curtain":s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,o.push(t.channel),o.push(t.value);break;case"scene":s=r.a.FUNCTION_CODE.WRITE+7;n=0;t.isOn&&(n=100),o.push(t.channel),o.push(n)}else switch(t.type){case"light":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;n=0;t.isOn&&(n=100),o.push(t.channel),o.push(n);break;case"dimmer":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,o.push(t.channel),o.push(t.value);break;case"process_curtain":case"curtain":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,o.push(t.channel),o.push(t.value);break;case"ac":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_AC,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;var l=0;t.isOn&&(l+=128),l+=t.lock<<5,l+=t.fan<<3,"制冷"==t.mode?l+=1:"制热"==t.mode?l+=2:"送风"==t.mode&&(l+=3),o.push(l),o.push(t.value),o.push(128),o.push(28),o.push(128),o.push(25),o.push(0);break;case"scene":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SCENE,s=r.a.FUNCTION_CODE.WRITE+7;n=0;t.isOn&&(n=100),o.push(t.channel),o.push(n);break;case"heating":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_AC,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;l=0;t.isOn&&(l+=128),l+=t.lock<<5,o.push(128),o.push(25),o.push(l),o.push(t.value),o.push(128),o.push(25),o.push(0);break;case"fan":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_AC,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;l=0;t.isOn&&(l+=128),l+=t.lock<<5,l+=t.fan<<3,o.push(128),o.push(28),o.push(128),o.push(28),o.push(l),o.push(t.value),o.push(0);break;case"module_light":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_LIGHT,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;n=0;t.isOn&&(n=100),o.push(t.channel),o.push(n);break;case"module_dimmer":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_DIMMER,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,o.push(t.channel),o.push(t.value);break;case"nl_lock":a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_NL_LOCK,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,o.push(1)}var c=this.buildCommand(o,t.areacode,t.addr,a,s);console.log("==> "+u.a.bytes2hex(c));var h=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(c),h,i,!0)}},sendACAction:function(t,i){var a=u.a.getVOBus(t);if(null!=a){var o,s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,n=[];switch("fan"==t.type?s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AIR:"ac"==t.type?s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AC:"heating"==t.type&&(s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_HEAT),o=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,n.push(1),"fan"==t.type?n.push(3):"ac"==t.type?n.push(1):"heating"==t.type&&n.push(2),n.push(i),i){case 1:t.isOn?n.push(1):n.push(0);break;case 2:n.push(t.value);break;case 3:"制冷"==t.mode?n.push(1):"制热"==t.mode?n.push(2):"送风"==t.mode&&n.push(3);break;case 4:n.push(parseInt(t.fan));break;case 5:n.push(parseInt(t.lock))}var l=this.buildCommand(n,t.areacode,t.addr,s,o);u.a.log("==> "+u.a.bytes2hex(l));var c=Object(m.e)(d.a.receiveData,a.ws_url);Object(m.j)(e.from(l),c,a,!0)}},sendComboAction:function(t,i){var a=u.a.getVOBus(t);if(null!=a){var o,s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,n=[];s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_COMBO,o=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,n.push(1),null!=i&&(n.push(i.channel),n.push(i.paramindex),n.push(i.val));var l=this.buildCommand(n,t.areacode,t.addr,s,o);console.log("==> "+u.a.bytes2hex(l));var c=Object(m.e)(d.a.receiveData,a.ws_url);Object(m.j)(e.from(l),c,a,!0)}},sendRemoteAction:function(t,i){var a=u.a.getVOBus(t);if(null!=a){var o,s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,n=[];s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_REMOTE,o=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;var l=null;if(null!=t.keyMaps)for(var c=0;c<t.keyMaps.length;c++)t.keyMaps[c].val==i&&(l=t.keyMaps[c]);if(null!=l&&null!=l.cmd&&0!=l.cmd.length){var h=u.a.hexStringToBytes(l.cmd);n.push(1),n.push(h.length);for(c=0;c<h.length;c++)n.push(h[c]);var v=this.buildCommand(n,t.areacode,t.addr,s,o);console.log("==> "+u.a.bytes2hex(v));var p=Object(m.e)(d.a.receiveData,a.ws_url);Object(m.j)(e.from(v),p,a,!0)}}},sendDesignSceneStart:function(){var t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,i=[],a=r.a.FUNCTION_CODE.WRITE;i.push(49),i.push(4),i.push(0),i.push(0),i.push(0);var o=0,s=[];for(o=0;o<u.a.golbal.arrDesignLogic.length;o++){var n=parseInt(u.a.golbal.arrDesignLogic[o].addr);s.indexOf(n)>-1||s.push(n)}i.push(s.length),i.push(3);var l=this.buildCommand(i,0,0,t,a);if(console.log("==> "+u.a.bytes2hex(l)),null!=u.a.golbal.myProject&&null!=u.a.golbal.myProject.buses)for(o=0;o<u.a.golbal.myProject.buses.length;o++){var c=u.a.golbal.myProject.buses[o],h=Object(m.e)(d.a.receiveData,c.ws_url);Object(m.j)(e.from(l),h,c)}},sendDesignSceneEnd:function(){var t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,i=[],a=r.a.FUNCTION_CODE.WRITE;i.push(49),i.push(4),i.push(0),i.push(0),i.push(0);var o=0,s=[];for(o=0;o<u.a.golbal.arrDesignLogic.length;o++){var n=parseInt(u.a.golbal.arrDesignLogic[o].addr);s.indexOf(n)>-1||s.push(n)}i.push(s.length),i.push(2);var l=this.buildCommand(i,0,0,t,a);if(console.log("==> "+u.a.bytes2hex(l)),null!=u.a.golbal.myProject&&null!=u.a.golbal.myProject.buses)for(o=0;o<u.a.golbal.myProject.buses.length;o++){var c=u.a.golbal.myProject.buses[o],h=Object(m.e)(d.a.receiveData,c.ws_url);Object(m.j)(e.from(l),h,c)}},sendDesignSceneAllOn:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,o=[],s=r.a.FUNCTION_CODE.WRITE;o.push(49),o.push(4),o.push(parseInt(t.areacode)),o.push(parseInt(t.addr)),o.push(t.channel);var n=0,l=[];for(n=0;n<u.a.golbal.arrDesignLogic.length;n++){var c=parseInt(u.a.golbal.arrDesignLogic[n].addr);l.indexOf(c)>-1||l.push(c)}o.push(l.length),o.push(1);var h=this.buildCommand(o,0,0,a,s);console.log("==> "+u.a.bytes2hex(h));var v=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(h),v,i)}},sendDesignSceneAllOff:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,o=[],s=r.a.FUNCTION_CODE.WRITE;o.push(49),o.push(4),o.push(parseInt(t.areacode)),o.push(parseInt(t.addr)),o.push(t.channel);var n=0,l=[];for(n=0;n<u.a.golbal.arrDesignLogic.length;n++){var c=parseInt(u.a.golbal.arrDesignLogic[n].addr);l.indexOf(c)>-1||l.push(c)}o.push(l.length),o.push(0);var h=this.buildCommand(o,0,0,a,s);console.log("==> "+u.a.bytes2hex(h));var v=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(h),v,i)}},sendDesignScene:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,o=[],s=r.a.FUNCTION_CODE.WRITE;o.push(49),o.push(4),o.push(parseInt(t.areacode)),o.push(parseInt(t.addr)),o.push(t.channel);var n=[],l=0;for(l=0;l<u.a.golbal.arrDesignLogic.length;l++){for(var c=u.a.golbal.arrDesignLogic[l],h=null,v=0;v<n.length;v++)null==h&&n[v].addr==c.addr&&(h=n[v]);null!=h?h.value=h.value+Math.pow(2,c.channel-1):(h={addr:c.addr,value:Math.pow(2,c.channel-1)},n.push(h))}for(o.push(n.length),l=0;l<n.length;l++)o.push(n[l].addr),o.push(n[l].value);var p=this.buildCommand(o,0,0,a,s);console.log("==> "+u.a.bytes2hex(p));var g=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(p),g,i)}},sendDeleteAutomationOrTimer:function(t){var i=[],a=[],o=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,s=null,n=r.a.FUNCTION_CODE.WRITE,l=null;if(null!=u.a.golbal.myProject.buses&&u.a.golbal.myProject.buses.length>0)if(null!=t.busId)for(var c=0;c<u.a.golbal.myProject.buses.length;c++)t.busId==u.a.golbal.myProject.buses[c].addr&&(l=u.a.golbal.myProject.buses[c]);else l=u.a.golbal.myProject.buses[0];if(null!=l){o=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_AI_GENIC,s=this.buildClearConditionBody(t,l),a=null!=l?this.buildCommand(s,l.areacode,l.areaaddr,o,n):this.buildCommand(s,1,255,o,n),i.push({data:a,bus:l});for(c=0;c<i.length;c++){var h=i[c];if(null!=h.bus){var v=Object(m.e)(d.a.receiveData,h.bus.ws_url);Object(m.j)(e.from(h.data),v,h.bus)}}}},sendDeleteScene:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,o=[],s=r.a.FUNCTION_CODE.WRITE;o.push(49),o.push(3),o.push(parseInt(t.areacode)),o.push(parseInt(t.addr)),o.push(t.channel);var n=this.buildCommand(o,0,0,a,s);console.log("==> "+u.a.bytes2hex(n));var l=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(n),l,i)}},sendDesignRelative:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,o=[],s=r.a.FUNCTION_CODE.WRITE;o.push(50),o.push(0),o.push(parseInt(t.areacode)),o.push(parseInt(t.addr)),o.push(t.channel);var n=0,l=[];for(n=0;n<u.a.golbal.arrDesignLogic.length;n++){for(var c=u.a.golbal.arrDesignLogic[n],h=null,v=0;v<l.length;v++)null==h&&l[v].addr==c.addr&&(h=l[v]);null!=h?h.value=h.value+Math.pow(2,c.channel-1):(h={addr:c.addr,value:Math.pow(2,c.channel-1)},l.push(h))}for(o.push(l.length),n=0;n<l.length;n++)o.push(l[n].addr),o.push(l[n].value);var p=this.buildCommand(o,0,0,a,s);console.log("==> "+u.a.bytes2hex(p));var g=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(p),g,i)}},sendDeleteRelative:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,o=[],s=r.a.FUNCTION_CODE.WRITE;o.push(50),o.push(1),o.push(parseInt(t.areacode)),o.push(parseInt(t.addr)),o.push(t.channel);var n=this.buildCommand(o,0,0,a,s);console.log("==> "+u.a.bytes2hex(n));var l=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(n),l,i)}},sendAutomation:function(){var t=c()(n.a.mark(function t(i,a,o){var s,l,c,h,v,p,g,f,b,_,y,C,k,E,T,D,S,w,I,j,O,P,R;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=null,l=[],c=[],h=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,v=null,p=r.a.FUNCTION_CODE.WRITE,g=null,null!=u.a.golbal.myProject.buses&&u.a.golbal.myProject.buses.length>0)if(null!=i.busId)for(f=0;f<u.a.golbal.myProject.buses.length;f++)i.busId==u.a.golbal.myProject.buses[f].addr&&(g=u.a.golbal.myProject.buses[f]);else if("SCENE"==i.sceneType)for(f=0;f<u.a.golbal.myProject.buses.length;f++)i.conditions[0].device.busId==u.a.golbal.myProject.buses[f].addr&&(g=u.a.golbal.myProject.buses[f]);else g=u.a.golbal.myProject.buses[0];if(b=[],null!=i.actions&&i.actions.length>0&&null!=a&&a.length>0)for(f=0;f<a.length;f++)if(_=a[f],y=null,null!=_.device&&(y=_.device),null!=_.deviceId&&(y=u.a.getVODeviceById(_.deviceId)),null!=y){for(C=!1,k=0;k<i.actions.length;k++)E=i.actions[k],T=null,null!=E.device&&(T=E.device),null!=E.deviceId&&(T=u.a.getVODeviceById(E.deviceId)),null!=T&&T.addr==y.addr&&T.areacode==y.areacode&&(C=!0);if(!C){for(C=!1,k=0;k<b.length;k++)b[k].addr==y.addr&&b[k].areacode==y.areacode&&(C=!0);C||(D={device:y,areacode:y.areacode,addr:y.addr,typecode:this.getDeviceType(y)},b.push(D))}}else null!=_.type&&"custom"==_.type&&(console.log("删除自定义"),v=this.buildActionCustomBody(i,g),c=this.buildCommand(v,g.areacode,g.areaaddr,261,p),l.push({data:c,bus:g}));if("RELATIVE"==i.sceneType){t.next=26;break}if(h=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_AI_GENIC,v=this.buildConditionBody(i,g),c=null!=g?this.buildCommand(v,g.areacode,g.areaaddr,h,p):this.buildCommand(v,1,255,h,p),l.push({data:c,bus:g}),S=[],0,!(null!=i.actions&&i.actions.length>0)){t.next=23;break}return t.next=21,this.sendActionList(i,S,o);case 21:(v=this.buildActionCustomBody(i,g)).length>6&&(c=this.buildCommand(v,g.areacode,g.areaaddr,261,p),l.push({data:c,bus:g}));case 23:for(f=0;f<b.length;f++)s=u.a.getVOBus(b[f].device),v=this.buildClearActionBody(i,b[f],s),c=this.buildCommand(v,b[f].areacode,b[f].addr,b[f].typecode,p),l.push({data:c,bus:s});t.next=47;break;case 26:if(null!=i.conditions&&0!=i.conditions.length){t.next=29;break}return u.a.golbal.fullscreenLoading=!1,t.abrupt("return");case 29:if(null!=i.actions&&0!=i.actions.length){t.next=32;break}return u.a.golbal.fullscreenLoading=!1,t.abrupt("return");case 32:for(w=i.conditions[0],I=i.actions,j=[],f=0;f<I.length;f++)if(E=I[f],T=null,null!=E.device&&(T=E.device),null!=E.deviceId&&(T=u.a.getVODeviceById(E.deviceId)),O=null,null!=T){for(k=0;k<j.length;k++)null==O&&j[k].id==T.addr&&(O=j[k]);null!=O?O.value=O.value+Math.pow(2,T.channel-1):(O={id:T.addr,value:Math.pow(2,T.channel-1)},j.push(O)),s=this.getBusByDecice(T)}for(h=0,(v=[]).push(50),v.push(0),v.push(w.device.areacode),v.push(w.device.addr),v.push(w.device.channel),v.push(j.length),f=0;f<j.length;f++)E=j[f],v.push(E.id),v.push(E.value);c=this.buildCommand(v,0,0,h,p),l.push({data:c,bus:s});case 47:for(f=0;f<l.length;f++)null!=(P=l[f]).bus&&(R=Object(m.e)(d.a.receiveData,P.bus.ws_url),Object(m.j)(e.from(P.data),R,P.bus));u.a.golbal.fullscreenLoading=!1,t.next=56;break;case 51:t.prev=51,t.t0=t.catch(0),console.log(t.t0),null!=u.a.root&&u.a.root.$message({message:"发送失败",type:"error",duration:3e3}),u.a.golbal.fullscreenLoading=!1;case 56:case"end":return t.stop()}},t,this,[[0,51]])}));return function(e,i,a){return t.apply(this,arguments)}}(),sendActionList:function(e,t,i){var a=this;return c()(n.a.mark(function o(){var s,l;return n.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:s=0;case 1:if(!(s<e.actions.length)){o.next=18;break}if(l=e.actions[s],null==i||!i){o.next=13;break}return o.next=6,a.sendActionOneWithReturn(l,t,e);case 6:if(o.sent){o.next=11;break}return u.a.golbal.fullscreenLoading=!1,null!=u.a.root&&u.a.root.$message({message:"发送超时",type:"error",duration:3e3}),o.abrupt("return");case 11:o.next=15;break;case 13:return o.next=15,a.sendActionOne(l,t,e);case 15:s++,o.next=1;break;case 18:case"end":return o.stop()}},o,a)}))()},sendActionOne:function(t,i,a){var o=this;return c()(n.a.mark(function s(){var l,c,h,v,p,g,f,b,_;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(l=null,null!=t.device&&(l=t.device),null!=t.deviceId&&(l=u.a.getVODeviceById(t.deviceId)),null==l||null!=t.type&&"device"!=t.type){s.next=18;break}for(c=o.getDeviceType(l),h={addr:l.addr,areacode:l.areacode,typecode:c,deviceId:l.id},v=!0,p=0;p<i.length;p++)h.addr==i[p].addr&&h.areacode==i[p].areacode&&(v=!1);if(!v){s.next=18;break}if(g=u.a.getVOBus(l),f=o.buildActionBody(a,h,g),b=o.buildCommand(f,h.areacode,h.addr,h.typecode,r.a.FUNCTION_CODE.WRITE),null==g){s.next=17;break}return _=Object(m.e)(d.a.receiveData,g.ws_url),Object(m.j)(e.from(b),_,g),s.next=17,o.sleep(350);case 17:i.push(h);case 18:return s.abrupt("return",!0);case 19:case"end":return s.stop()}},s,o)}))()},sendActionOneWithReturn:function(t,i,a){var o=this;return c()(n.a.mark(function s(){var l,c,h,v,p,g,f,b,_,y,C;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(l=null,null!=t.device&&(l=t.device),null!=t.deviceId&&(l=u.a.getVODeviceById(t.deviceId)),null==l||null!=t.type&&"device"!=t.type){s.next=26;break}for(c=o.getDeviceType(l),h={addr:l.addr,areacode:l.areacode,typecode:c,deviceId:l.id},v=!0,p=0;p<i.length;p++)h.addr==i[p].addr&&h.areacode==i[p].areacode&&(v=!1);if(!v){s.next=26;break}if(g=u.a.getVOBus(l),f=o.buildActionBody(a,h,g),b=o.buildCommand(f,h.areacode,h.addr,h.typecode,r.a.FUNCTION_CODE.WRITE),null==g){s.next=25;break}_=Object(m.e)(d.a.receiveData,g.ws_url),y=[],C=3;case 16:return Object(m.j)(e.from(b),_,g),s.next=19,o.tryToReadOne();case 19:(y=s.sent).length>5&&(y[3]==b[3]&&y[4]==b[4]||(y=[])),C-=1;case 22:if(y.length<5&&C>0){s.next=16;break}case 23:if(!(y.length<5&&0==C)){s.next=25;break}return s.abrupt("return",!1);case 25:i.push(h);case 26:return s.abrupt("return",!0);case 27:case"end":return s.stop()}},s,o)}))()},buildConditionBody:function(e,t){var i=511,a=0;"SCENE"==e.sceneType&&e.conditions.length>0?(i=((m=e.conditions[0]).device.areacode<<8)+m.device.addr,a=m.device.channel):(null!=t&&(i=(t.areacode<<8)+t.areaaddr),a=null!=e.code?e.code:0);var o=[];if(o.push(49),o.push(0),o.push(i>>8),o.push(255&i),o.push(a),"TIMER"==e.sceneType){o.push(1),o.push(1);var s=0;if(null!=e.days&&e.days.length>0)for(l=0;l<e.days.length;l++)s+=parseInt(e.days[l]);return e.isRepeat&&(s+=128),o.push(s),null!=e.timer&&2!=e.timer.length&&(null!=e.timer&&e.timer.indexOf(":")>-1&&2==e.timer.split(":").length?(o.push(parseInt(e.timer.split(":")[0])),o.push(parseInt(e.timer.split(":")[1]))):(o.push(0),o.push(0))),o}if("AUTOMATION"==e.sceneType){var n=e.conditions.length;if(e.days.length>0&&(n+=1),o.push(n),e.days.length>0){o.push(2);s=0;if(null!=e.days&&e.days.length>0)for(l=0;l<e.days.length;l++)s+=parseInt(e.days[l]);e.isRepeat&&(s+=128),o.push(s),null!=e.timer&&2==e.timer.length?(null!=e.timer[0]&&e.timer[0].indexOf(":")>-1&&2==e.timer[0].split(":").length?(o.push(parseInt(e.timer[0].split(":")[0])),o.push(parseInt(e.timer[0].split(":")[1]))):(o.push(0),o.push(0)),null!=e.timer[1]&&e.timer[1].indexOf(":")>-1&&2==e.timer[1].split(":").length?(o.push(parseInt(e.timer[1].split(":")[0])),o.push(parseInt(e.timer[1].split(":")[1]))):(o.push(0),o.push(0))):(o.push(0),o.push(0),o.push(23),o.push(59))}for(var l=0;l<e.conditions.length;l++){if(null==(m=e.conditions[l]).type||"device"==m.type){var c=m.device;(h=r.a.DEVICE_ACTION_DEFINE[c.type]).actions[0].key;4==(v=h.conditionCode)?(o.push(v),o.push(c.areacode),o.push(c.addr),o.push(m.status.value?1:0),o.push("scene"==c.type?1:0),o.push(c.channel)):(o.push(v),o.push(c.areacode),o.push(c.addr),o.push(m.status.logic),o.push(m.status.value>>8),o.push(255&m.status.value))}else if(null!=m.type&&"custom"==m.type){if(o.push(0),null!=(p=u.a.hexStringToBytes(m.command))&&p.length>0){o.push(p.length);for(var d=0;d<p.length;d++)o.push(p[d])}}else null!=m.type&&"loop"==m.type&&(o.push(12),o.push(parseInt(m.timeHour)),o.push(parseInt(m.timeMinute)),o.push(parseInt(m.timeSecond)))}return o}if("SCENE"==e.sceneType){o.push(e.conditions.length);for(l=0;l<e.conditions.length;l++){var m;if(null==(m=e.conditions[l]).type||"device"==m.type){c=m.device,(h=r.a.DEVICE_ACTION_DEFINE[c.type]).actions[0].key;var h,v=h.conditionCode;o.push(4),o.push(m.status.value?1:0),o.push("scene"==c.type?1:0),o.push(c.channel)}else if(null!=m.type&&"custom"==m.type){var p;if(o.push(0),null!=(p=u.a.hexStringToBytes(m.command))&&p.length>0){o.push(p.length);for(d=0;d<p.length;d++)o.push(p[d])}}}return o}},buildActionBody:function(e,t,i){var a=511,o=0;if("SCENE"==e.sceneType&&e.conditions.length>0){var s=e.conditions[0];a=(s.device.areacode<<8)+s.device.addr,o=s.device.channel}else null!=i&&(a=(i.areacode<<8)+i.areaaddr),o=null!=e.code?e.code:0;var n=[];n.push(49),n.push(1),n.push(a>>8),n.push(255&a),n.push(o);var l=[];if(null!=e.actions&&e.actions.length>0)for(var c=0;c<e.actions.length;c++){var d=null;null!=(h=e.actions[c]).device&&(d=h.device),null!=h.deviceId&&(d=u.a.getVODeviceById(h.deviceId)),null!=d&&d.addr==t.addr&&d.areacode==t.areacode&&l.push(h)}if(l.length>0){var m=0;for(c=0;c<l.length;c++){d=null;if(null!=(h=l[c]).device&&(d=h.device),null!=h.deviceId&&(d=u.a.getVODeviceById(h.deviceId)),null==h.type||"device"==h.type)"combo"==(v=r.a.DEVICE_ACTION_DEFINE[d.type]).actions[0].type?m+=h.channels.length:m+=1}n.push(m);for(c=0;c<l.length;c++){var h,v;d=null;if(null!=(h=l[c]).device&&(d=h.device),null!=h.deviceId&&(d=u.a.getVODeviceById(h.deviceId)),null==h.type||"device"==h.type)if("ac"!=(v=r.a.DEVICE_ACTION_DEFINE[d.type]).actions[0].type&&"heat"!=v.actions[0].type&&"air"!=v.actions[0].type&&"combo"!=v.actions[0].type){var p=h.status.value;"scene"==d.type?n.push(d.channel+128):n.push(d.channel),n.push(null==h.delay?0:parseInt(h.delay)),"boolean"==v.actions[0].type?n.push(p?100:0):"int"==v.actions[0].type?n.push(p):"enum"==v.actions[0].type&&n.push(p)}else{var g=0;("ac"==d.type||"combo"==d.type&&null!=h.channels&&h.channels.indexOf(1)>-1)&&(n.push(1),n.push(null==h.delay?0:parseInt(h.delay)),h.status.ac.isOn&&(g+=128),"制冷"==h.status.ac.mode?g+=1:"制热"==h.status.ac.mode?g+=2:"送风"==h.status.ac.mode&&(g+=3),g+=h.status.ac.fan<<3,n.push(g),n.push(h.status.ac.value)),("heating"==d.type||"combo"==d.type&&null!=h.channels&&h.channels.indexOf(2)>-1)&&(n.push(2),n.push(null==h.delay?0:parseInt(h.delay)),h.status.heat.isOn&&(g+=128),n.push(g),n.push(h.status.heat.value)),("fan"==d.type||"combo"==d.type&&null!=h.channels&&h.channels.indexOf(3)>-1)&&(n.push(3),n.push(null==h.delay?0:parseInt(h.delay)),h.status.air.isOn&&(g+=128),g+=h.status.air.fan<<3,n.push(g),n.push(0))}}}return n},buildActionCustomBody:function(e,t){var i=511,a=0;if("SCENE"==e.sceneType&&e.conditions.length>0){var o=e.conditions[0];i=(o.device.areacode<<8)+o.device.addr,a=o.device.channel}else null!=t&&(i=(t.areacode<<8)+t.areaaddr),a=null!=e.code?e.code:0;var s=[];s.push(49),s.push(1),s.push(i>>8),s.push(255&i),s.push(a);var n=[];if(null!=e.actions&&e.actions.length>0)for(var l=0;l<e.actions.length;l++){null!=(c=e.actions[l]).type&&"custom"==c.type&&n.push(c)}if(n.length>0){s.push(n.length);for(l=0;l<n.length;l++){var c;if(null!=(c=n[l]).type&&"custom"==c.type){var r=u.a.hexStringToBytes(c.command);if(null!=r&&r.length>0){s.push(r.length),s.push(null==c.delay?0:parseInt(c.delay));for(var d=0;d<r.length;d++)s.push(r[d])}}}}else s.push(0);return s},buildClearActionBody:function(e,t,i){var a=511,o=0;if("SCENE"==e.sceneType&&e.conditions.length>0){var s=e.conditions[0];a=(s.device.areacode<<8)+s.device.addr,o=s.device.channel}else null!=i&&(a=(i.areacode<<8)+i.areaaddr),o=null!=e.code?e.code:0;var n=[];return n.push(49),n.push(1),n.push(a>>8),n.push(255&a),n.push(o),n.push(0),n},buildClearConditionBody:function(e,t){var i=511,a=0;null!=t&&(i=(t.areacode<<8)+t.areaaddr),a=null!=e.code?e.code:0;var o=[];return o.push(49),o.push(3),o.push(i>>8),o.push(255&i),o.push(a),o},sendAutomationEnabled:function(t,i){if(null!=t&&0!=t.length){var a=null;null!=u.a.golbal.myProject.buses&&u.a.golbal.myProject.buses.length>0&&(a=u.a.golbal.myProject.buses[0],console.log(a.areacode+","+a.areaaddr));var o=[],s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,n=null,l=r.a.FUNCTION_CODE.WRITE;s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_AI_GENIC,(n=[]).push(49),n.push(2),n.push(i?1:0),n.push(t.length);for(var c=0;c<t.length;c++){var h=t[c];n.push(a.areacode),n.push(a.areaaddr),n.push(null==h.code?1:h.code)}if(null!=a){o=this.buildCommand(n,a.areacode,a.areaaddr,s,l);var v=Object(m.e)(d.a.receiveData,a.ws_url);Object(m.j)(e.from(o),v,a)}}},sendDeviceProperty:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,o=parseInt(t.areacode),s=parseInt(t.addr),n=[],l=u.a.getVORoomByRoomId(t.roomId);if(null==l)return a;for(var c=0;c<l.devices.length;c++){var h=l.devices[c];parseInt(h.areacode)==o&&parseInt(h.addr)==s&&-1==n.indexOf(h.type)&&n.push(h.type)}a=this.getDeviceTypeByTypes(n);var v=r.a.FUNCTION_CODE.WRITE,p=[];p.push(48);var g=[0,0,0,0,0,0,0,0],f=0;for(c=0;c<t.channelList.length;c++){var b=t.channelList[c];if(null!=b.locals&&b.locals.length>0){var _=r.a.keyValueByChannelDefine(b);if(null!=_&&_.length>0)for(var y=0;y<_.length;y++){var C=b.locals[y],k=_[y];null!=k&&(g[C.lo-1]=k.value,null==b.isSwitch||b.isSwitch||(f+=Math.pow(2,C.lo-1)))}}else f+=Math.pow(2,b.channel-1)}for(c=0;c<g.length;c++)p.push(g[c]);p.push(f);var E=this.buildCommand(p,t.areacode,t.addr,a,v);console.log("==> "+u.a.bytes2hex(E));var T=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(E),T,i)}else u.a.log("bus is null")},sendGWRelay:function(t,i){var a=r.a.FUNCTION_CODE.WRITE,o=[];o.push(11),o.push(parseInt(i));var s=this.buildCommand(o,t.areacode,t.areaaddr,r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_BUS,a),n=Object(m.e)(d.a.receiveData,t.ws_url);Object(m.j)(e.from(s),n,t)},sendGWRFID:function(t,i){console.log("rfid");var a=r.a.FUNCTION_CODE.WRITE,o=[];o.push(6),o.push(parseInt(i));var s=this.buildCommand(o,t.areacode,t.areaaddr,r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_BUS,a),n=Object(m.e)(d.a.receiveData,t.ws_url);Object(m.j)(e.from(s),n,t)},sendRemoteAC:function(t,i){var a=0,o=u.a.getVOBus(t);if(null!=o){var s,n=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,l=[];n=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_REMOTE,s=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL,l.push(0),l.push(0);var c=[];switch(c.push(48),c.push(1),c.push(t.codes[0]),c.push(t.codes[1]),c.push(t.value),c.push(t.fan),c.push(t.dirt_m),c.push(t.dirt_a),c.push(t.isOn?1:0),i){case"power":c.push(1);break;case"mode":c.push(2);break;case"fan":c.push(3);break;case"dirt_m":c.push(4);break;case"dirt_a":c.push(5);break;case"vol_p":c.push(6);break;case"vol_m":c.push(7)}for(c.push(t.mode),c.push(t.codes.length-1),a=2;a<t.codes.length;a++)c.push(t.codes[a]);c.push(255);var h=0;for(a=0;a<c.length;a++)h+=c[a];for(c.push(255&h),a=0;a<c.length;a++)l.push(c[a]);l[1]=c.length;var v=this.buildCommand(l,t.areacode,t.addr,n,s);console.log("==> "+u.a.bytes2hex(v));var p=Object(m.e)(d.a.receiveData,o.ws_url);Object(m.j)(e.from(v),p,o)}},sendRemoteTV:function(t,i){var a=u.a.getVOBus(t);if(null!=a){var o,s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL;s=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_REMOTE,o=r.a.FUNCTION_CODE.WRITE+r.a.FUNCTION_CODE.CONTROL;var n=this.buildCommand([],t.areacode,t.addr,s,o);console.log("==> "+u.a.bytes2hex(n));var l=Object(m.e)(d.a.receiveData,a.ws_url);Object(m.j)(e.from(n),l,a)}},queryDeviceStatus:function(t){var i=u.a.getVOBus(t);if(null!=i){var a=this.getDeviceType(t);console.log(a);var o=[];t.type.startsWith("sensor")&&(o.push(t.channel>>8),o.push(255&t.channel));var s=this.buildCommand(o,t.areacode,t.addr,a,r.a.FUNCTION_CODE.QUERY_STATUS);console.log("==> "+u.a.bytes2hex(s));var n=Object(m.e)(d.a.receiveData,i.ws_url);Object(m.j)(e.from(s),n,i)}},queryDeviceProperty:function(t,i){for(var a=this.buildCommand([48],t,i,r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,r.a.FUNCTION_CODE.READ),o=0;o<u.a.golbal.myProject.buses.length;o++){var s=u.a.golbal.myProject.buses[o];console.log("==> "+u.a.bytes2hex(a));var n=Object(m.e)(d.a.receiveData,s.ws_url);Object(m.j)(e.from(a),n,s)}},getDeviceType:function(e){parseInt(e.areacode),parseInt(e.addr);var t=e.type,i=[];return i.push(t),this.getDeviceTypeByTypes(i)},getDeviceTypeByTypes:function(e){var t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL;if(null==e||0==e.length)return t;if(1==e.length)switch(e[0]){case"light":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT;break;case"dimmer":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER;break;case"process_curtain":case"curtain":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN;break;case"ac":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AC;break;case"scene":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SCENE;break;case"heating":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_HEAT;break;case"fan":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AIR;break;case"combo":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_COMBO;break;case"module_light":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_LIGHT;break;case"module_dimmer":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_DIMMER;break;case"nl_lock":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_NL_LOCK;break;case"sensor_panel":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PANEL;break;case"sensor_pules":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PULES;break;case"sensor_switch":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_SWITCH;break;case"sensor_temperature":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_TEMPERATURE;break;case"sensor_humidity":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_HUMIDITY;break;case"sensor_brightness":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_BRIGHTNESS;break;case"sensor_pm25":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PM25;break;case"sensor_hcho":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_HCHO;break;case"sensor_co2":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_CO2;break;case"sensor_ch4":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_CH4}else 2==e.length?e.indexOf("scene")>-1&&e.indexOf("light")>-1?t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_SCENE:e.indexOf("scene")>-1&&e.indexOf("dimmer")>-1?t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_SCENE:e.indexOf("scene")>-1&&e.indexOf("curtain")>-1&&(t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN_SCENE):e.length>=3&&(t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE);if(t==r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL)switch(e[0]){case"light":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT;break;case"dimmer":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER;break;case"curtain":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN;break;case"ac":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AC;break;case"scene":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SCENE;break;case"heating":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_HEAT;break;case"fan":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AIR;break;case"combo":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_COMBO;break;case"module_light":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_LIGHT;break;case"module_dimmer":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_DIMMER;break;case"sensor_panel":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PANEL;break;case"sensor_pules":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PULES;break;case"sensor_switch":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_SWITCH;break;case"sensor_temperature":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_TEMPERATURE;break;case"sensor_humidity":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_HUMIDITY;break;case"sensor_brightness":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_BRIGHTNESS;break;case"sensor_pm25":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PM25;break;case"sensor_hcho":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_HCHO;break;case"sensor_co2":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_CO2;break;case"sensor_ch4":t=r.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_CH4}return t},getBusByDecice:function(e){if(null==e.busId||""==e.busId)return null;if(null==u.a.golbal.myProject.buses&&0==u.a.golbal.myProject.buses.length)return null;for(var t=0;t<u.a.golbal.myProject.buses.length;t++){var i=u.a.golbal.myProject.buses[t];if(i.addr==e.busId)return i}return null},tryToReadOne:function(){return new o.a(function(e){var t=0,i=setInterval(function(){if(t+=1,null!=u.a.BusReturn){clearInterval(i);var a=u.a.BusReturn;u.a.BusReturn=null,e(a)}t>10&&(clearInterval(i),e([]))},50)})},sleep:function(e){return new o.a(function(t){setTimeout(function(){t("")},e)})}}}).call(t,i("EuP9").Buffer)},"2w0j":function(e,t){},"8yrj":function(e,t){},"DE+Y":function(e,t){},EaHM:function(e,t){},FKjo:function(e,t){},HYWi:function(e,t){},HlPL:function(e,t){},L17K:function(e,t){},MJmh:function(e,t){},MXUu:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("7+uW"),o=i("zL8q"),s=i.n(o),n=i("mvHQ"),l=i.n(n),c=i("Xxa5"),r=i.n(c),u=i("exGp"),d=i.n(u),m=i("bOdI"),h=i.n(m),v=i("mtWM"),p=i.n(v),g=i("1nuA"),f=i.n(g),b=i("gQoh"),_=i("XF4N"),y={components:{},data:function(){return{visibleFloor:!1,visibleBlock:!1,drawerShare:!1,heightDrawerShare:window.innerHeight-159,windowWidth:window.innerWidth,projectEditVisible:!1,qrcode:"http://app.lk-control.com/txt2qrcode?txt="+escape(this.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+this.golbal.projectId)}},props:["golbal"],methods:{projectClick:function(e){console.log("project click"),b.a.resumeProjectLocal(e,this)},createNewProject:function(){this.golbal.editing.project=null,this.$router.push({name:"projectEdit",params:{project:null}})},onShowProjectChange:function(e){this.projectEditVisible="false"!==e},blockClick:function(e){for(var t=0;t<this.golbal.myProject.blocks.length;t++){this.golbal.myProject.blocks[t].active=!1}e.active=!0,this.golbal.blockCur=e,this.golbal.floorCur=this.golbal.blockCur.floors[0];for(t=0;t<this.golbal.blockCur.floors.length;t++){this.golbal.blockCur.floors[t].active=0==t}this.golbal.roomCur=this.golbal.floorCur.rooms[0];for(t=0;t<this.golbal.floorCur.rooms.length;t++){this.golbal.floorCur.rooms[t].active=0==t}b.a.getTypeStatus(),this.visibleBlock=!1},floorClick:function(e){for(var t=0;t<this.golbal.blockCur.floors.length;t++){this.golbal.blockCur.floors[t].active=!1}e.active=!0,this.golbal.floorCur=e,this.visibleFloor=!1,this.golbal.roomCur=this.golbal.floorCur.rooms[0];for(t=0;t<this.golbal.floorCur.rooms.length;t++){this.golbal.floorCur.rooms[t].active=0==t}b.a.getTypeStatus()},messageClick:function(){"/message"!=this.$route.path&&this.$router.push({path:"/message"})},gotoRoom:function(){"/room"!=this.$route.path&&this.$router.push({path:"/room"})},chooseDevice:function(){this.$router.back(-1)},backClick:function(){this.golbal.editing.selectedDevice=null,this.$router.back(-1)},drawerShareClick:function(){this.qrcode="http://app.lk-control.com/txt2qrcode?txt="+escape(this.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+this.golbal.projectId),this.drawerShare=!0},clearLogicDesign:function(){var e=this;this.$confirm("确认要清除当前记录的逻辑设计并重新设计？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.golbal.arrDesignLogic=[],console.log("clean")}).catch(function(){console.log("cancel")})},logicBackClick:function(){console.log(this.golbal.editing.security),null!=this.golbal.editing.security?this.$router.push({path:"/secure"}):this.$router.push({name:"user",params:{}})}}},C={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"header"},[e.golbal.isPad||"/favorite"==e.$route.path||"/user"==e.$route.path?e._e():i("el-row",{staticClass:"divHeaderMain"},["/user"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v("我的管理")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center",height:"37px"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.drawerShareClick()}}},[i("i",{staticClass:"icon-share2",staticStyle:{"font-size":"4.5vw"}})])])])]:"/device"==e.$route.path||"/selectDevice"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v("设备列表")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},["FLOOR"==e.golbal.showCaseTopRight?i("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"click","popper-class":"popoverFloor"},model:{value:e.visibleFloor,callback:function(t){e.visibleFloor=t},expression:"visibleFloor"}},[i("div",[i("span",{staticClass:"spanTitle"},[e._v("请选择楼层")]),e._v(" "),i("ul",e._l(e.golbal.blockCur.floors,function(t){return i("li",{key:t.id,class:t.active?"liBlue":t.isOn?"liOrange":"",on:{click:function(i){return e.floorClick(t)}}},[i("i",{staticClass:"icon-office"}),i("span",[e._v(e._s(t.name))])])}),0)]),e._v(" "),i("el-button",{staticClass:"btnHeaderFloor",staticStyle:{"padding-right":"5px"},attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",[e._v(e._s(e.golbal.floorCur.name))]),e._v(" "),i("i",{staticClass:"icon-caret-down"})])],1):e._e()],1)]:"/addDevice"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v("添加设备")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}})]:"/logic"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:e.logicBackClick}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[e.golbal.isCustomTitle?i("span",{staticClass:"spanHeaderTitle"},[e._v("编辑"+e._s(e.golbal.customTitle))]):i("span",{staticClass:"spanHeaderTitle"},[e._v("逻辑设计")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.$router.push({name:"user",params:{}})}}},[i("i",{staticClass:"el-icon-close"})])])])]:"/sceneEdit"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.$router.push({name:"logic",params:{project:e.golbal.myProject,mode:"EDIT"}})}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[e.golbal.isCustomTitle?i("span",{staticClass:"spanHeaderTitle"},[e._v("编辑"+e._s(e.golbal.customTitle))]):i("span",{staticClass:"spanHeaderTitle"},[e._v("逻辑设计")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.$router.push({name:"logic",params:{project:e.golbal.myProject,mode:"EDIT"}})}}},[i("i",{staticClass:"el-icon-close"})])])])]:"/secure"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.$router.push({name:"user",params:{}})}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v("安防设置")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.$router.push({name:"user",params:{}})}}},[i("i",{staticClass:"el-icon-close"})])])])]:"/sharedList"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center",height:"113px","line-height":"113px"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft",staticStyle:{height:"113px","line-height":"113px"}},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center",height:"113px","line-height":"113px"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v("分享管理")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center",height:"113px","line-height":"113px"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight",staticStyle:{height:"113px","line-height":"113px"}},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.$router.push({path:"/projectShared"})}}},[i("i",{staticClass:"el-icon-share"})])])])]:"/busEdit"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v("编辑网关")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}})]:"/project"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center",height:"113px","line-height":"113px"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft",staticStyle:{height:"113px","line-height":"113px"}},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center",height:"113px","line-height":"113px"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v("项目管理")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center",height:"113px","line-height":"113px"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight",staticStyle:{height:"113px","line-height":"113px"}},["ADD_PROJECT"!=e.golbal.showCaseTopRight||e.golbal.isPad?e._e():i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.createNewProject()}}},[i("i",{staticClass:"el-icon-plus"})])])])]:"/projectEdit"==e.$route.path||"/floorEdit"==e.$route.path||"/roomEdit"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[e.golbal.isCustomTitle?i("span",{staticClass:"spanHeaderTitle"},[e._v("编辑"+e._s(e.golbal.customTitle))]):i("span",{staticClass:"spanHeaderTitle"},[e._v("项目管理")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-close"})])])])]:"/editValue"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[e.golbal.isCustomTitle?i("span",{staticClass:"spanHeaderTitle"},[e._v(e._s(e.golbal.customTitle))]):i("span",{staticClass:"spanHeaderTitle"},[e._v("编辑值")])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}})]:"/projectShared"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[i("span",{staticClass:"spanHeaderTitle"},[e._v(e._s(e.golbal.myProject.name))])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-close"})])])])]:"/login"==e.$route.path?void 0:"/camera"==e.$route.path?[i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderLeft"},[i("div",{staticClass:"btnHeaderBack",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-arrow-left"})])])]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[e.golbal.isCustomTitle?i("span",{staticClass:"spanHeaderTitle"},[e._v(e._s(e.golbal.customTitle))]):e._e()]),e._v(" "),i("el-col",{staticStyle:{"text-align":"center"},attrs:{span:6}},[i("div",{staticClass:"divHeaderRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.backClick()}}},[i("i",{staticClass:"el-icon-close"})])])])]:[i("el-col",{attrs:{span:18}},[e.golbal.isCustomTitle?[i("span",[e._v("编辑"+e._s(e.golbal.customTitle))])]:[i("el-popover",{attrs:{placement:"bottom",width:e.windowWidth-34,trigger:"click","popper-class":"popoverFloor"},model:{value:e.visibleBlock,callback:function(t){e.visibleBlock=t},expression:"visibleBlock"}},[i("div",{staticStyle:{"max-height":"calc(100vh - 140px)",overflow:"scroll"}},[i("span",{staticClass:"spanTitle"},[e._v("请选择项目")]),e._v(" "),i("ul",[e._l(e.golbal.projectList,function(t){return["b0b502b7-c000-4000-a000-0547116af000"!=t.id?i("li",{key:t.projectId,on:{click:function(i){return e.projectClick(t)}}},[i("i",{staticClass:"icon-office"}),i("span",[e._v(e._s(t.projectName))]),e._v(" "),t.isDefault?i("div",{staticClass:"checked"},[i("i",{staticClass:"icon-yuanxingxuanzhongfill"})]):e._e()]):e._e()]})],2)]),e._v(" "),i("el-button",{staticClass:"btnHeaderMain",attrs:{slot:"reference"},slot:"reference"},[i("span",[e._v(e._s(e.golbal.myProject.name))]),i("i",{staticClass:"el-icon-sort",staticStyle:{transform:"rotate(90deg) scale(0.8,1.5)","margin-left":"10px"}})])],1)]],2),e._v(" "),i("el-col",{attrs:{span:6}},["FLOOR"!=e.golbal.showCaseTopRight&&e.golbal.isPad?e._e():i("div",{staticClass:"divHeaderRight"},["FLOOR"==e.golbal.showCaseTopRight?i("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"click","popper-class":"popoverFloor"},model:{value:e.visibleFloor,callback:function(t){e.visibleFloor=t},expression:"visibleFloor"}},[i("div",[i("span",{staticClass:"spanTitle"},[e._v("请选择楼层")]),e._v(" "),i("ul",e._l(e.golbal.blockCur.floors,function(t){return i("li",{key:t.id,class:t.active?"liBlue":t.isOn?"liOrange":"",on:{click:function(i){return e.floorClick(t)}}},[i("i",{staticClass:"icon-office"}),i("span",[e._v(e._s(t.name))])])}),0)]),e._v(" "),i("el-button",{staticClass:"btnHeaderFloor",staticStyle:{"padding-right":"5px"},attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",[e._v(e._s(e.golbal.floorCur.name))]),e._v(" "),i("i",{staticClass:"icon-caret-down"})])],1):e._e(),e._v(" "),"SHARE"!=e.golbal.showCaseTopRight||1!=e.golbal.isMaster||e.golbal.isPad?e._e():i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.drawerShareClick()}}},[i("i",{staticClass:"icon-share2"})]),e._v(" "),"ADD_PROJECT"!=e.golbal.showCaseTopRight||e.golbal.isPad?e._e():i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.createNewProject()}}},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),"CHOOSE"!=e.golbal.showCaseTopRight||e.golbal.isPad?e._e():i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.chooseDevice()}}},[i("i",{staticClass:"el-icon-check"})]),e._v(" "),"ROOM"!=e.golbal.showCaseTopRight||e.golbal.isPad?e._e():i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.gotoRoom()}}},[i("i",{staticClass:"el-icon-arrow-right"})])],1)])]],2),e._v(" "),"SHARE"==e.golbal.showCaseTopRight&&1==e.golbal.isMaster&&e.golbal.isPad?i("div",{staticClass:"divHeaderTopRight"},[i("div",{staticClass:"btnHeaderShare",on:{click:function(t){return e.drawerShareClick()}}},[i("i",{staticClass:"icon-share2"})])]):e._e(),e._v(" "),e.golbal.isPad?i("div",{staticStyle:{height:"10vh","line-height":"10vh"}},[i("el-popover",{attrs:{placement:"bottom",width:e.windowWidth-34,trigger:"click","popper-class":"popoverFloor"},model:{value:e.visibleBlock,callback:function(t){e.visibleBlock=t},expression:"visibleBlock"}},[i("div",{staticStyle:{"max-height":"calc(100vh - 140px)",overflow:"scroll"}},[i("span",{staticClass:"spanTitle"},[e._v("请选择项目")]),e._v(" "),i("ul",[e._l(e.golbal.projectList,function(t){return["b0b502b7-c000-4000-a000-0547116af000"!=t.id?i("li",{key:t.projectId,on:{click:function(i){return e.projectClick(t)}}},[i("i",{staticClass:"icon-office"}),i("span",[e._v(e._s(t.projectName))]),e._v(" "),t.isDefault?i("div",{staticClass:"checked"},[i("i",{staticClass:"icon-yuanxingxuanzhongfill"})]):e._e()]):e._e()]})],2)]),e._v(" "),i("el-button",{staticClass:"btnHeaderMain",attrs:{slot:"reference"},slot:"reference"},[i("span",[e._v(e._s(e.golbal.myProject.name))]),i("i",{staticClass:"el-icon-sort",staticStyle:{transform:"rotate(90deg) scale(0.8,1.5)","margin-left":"10px","font-size":"4vh"}})])],1)],1):e._e(),e._v(" "),"FLOOR"==e.golbal.showCaseTopRight&&e.golbal.isPad?i("div",{staticClass:"divHeaderRight"},["FLOOR"==e.golbal.showCaseTopRight?i("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"click","popper-class":"popoverFloor"},model:{value:e.visibleFloor,callback:function(t){e.visibleFloor=t},expression:"visibleFloor"}},[i("div",[i("span",{staticClass:"spanTitle"},[e._v("请选择楼层")]),e._v(" "),i("ul",e._l(e.golbal.blockCur.floors,function(t){return i("li",{key:t.id,class:t.active?"liBlue":t.isOn?"liOrange":"",on:{click:function(i){return e.floorClick(t)}}},[i("i",{staticClass:"icon-office"}),i("span",[e._v(e._s(t.name))])])}),0)]),e._v(" "),i("el-button",{staticClass:"btnHeaderFloor",staticStyle:{"padding-right":"5px"},attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",[e._v(e._s(e.golbal.floorCur.name))]),e._v(" "),i("i",{staticClass:"icon-caret-down"})])],1):e._e()],1):e._e()],1)},staticRenderFns:[]},k=i("VU/8")(y,C,!1,null,null,null).exports,E={data:function(){return{isFavorite:!1,isRoom:!0,isUser:!1}},props:["golbal"],methods:{toFavorite:function(){this.isFavorite=!0,this.isRoom=!1,this.isUser=!1,this.$router.push({name:"favorite",params:{project:null}})},toRoom:function(){this.golbal.showSwitchPanel=!1,this.isFavorite=!1,this.isRoom=!0,this.isUser=!1,this.$router.push({name:"room",params:{project:null}}),b.a.sendQueryDeviceStatus()},toUser:function(){this.isFavorite=!1,this.isRoom=!1,this.isUser=!0,this.$router.push({name:"user",params:{project:null}})}}},T={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"footer"},[i("ul",[i("li",[i("div",{class:"/favorite"==e.$route.path?"routerC":"",on:{click:e.toFavorite}},[i("i",{staticClass:"icon-ls_favorite"})])]),e._v(" "),i("li",[i("div",{class:"/room"==e.$route.path?"routerC":"",on:{click:e.toRoom}},[i("i",{staticClass:"icon-ls_home"})])]),e._v(" "),i("li",[i("div",{class:"/favorite"!=e.$route.path&&"/room"!=e.$route.path&&"/"!=e.$route.path?"routerC":"",on:{click:e.toUser}},[i("i",{staticClass:"icon-ls_27_office"})])])])])},staticRenderFns:[]},D=i("VU/8")(E,T,!1,null,null,null).exports,S=i("uxah"),w=i("22e4");i("lulH");var I={name:"App",components:{FrameHeader:k,FrameFooter:D},data:function(){var e,t=this;return{version:"v1.3.139",upgrading:!1,upgrading_process:0,ip_boardcast:[],needRequestAll:!1,golbal:(e={VERSION_CODE:10439,VERSION_CODE_SERVER:10439,VERSION_URL:"",HOST:"https://app.lk-control.com",GET_DATA:"https://app.lk-control.com/do?",GET_VERSION:"https://app.lk-control.com/app/version.html",WX_SDK_READY:!1,username:"",nickname:"",isMaster:0,isAdmin:0,isWeixin:!1,accessToken:"",refreshToken:"",menuCur:"",showDebug:!1,showFooter:!0,isGallery:!0,isOnline:!1,type:[{id:1,name:"all",icon:"icon-all",isOn:!1},{id:2,name:"light",icon:"icon-ls_1_light",isOn:!1},{id:3,name:"curtain",icon:"icon-ls_23_curtain",isOn:!1},{id:4,name:"ac",icon:"icon-ls_7_ac",isOn:!1},{id:5,name:"scene",icon:"icon-ls_26_go_off_work",isOn:!1},{id:6,name:"remote",icon:"icon-mobilefill",isOn:!1},{id:7,name:"lock",icon:"el-icon-lock",isOn:!1}],typeCur:"all",blockCur:{},floorCur:{},roomCur:{},myProject:{id:"b0b502b7-c000-4000-a000-0547116af000",name:"演示项目",active:!0,blocks:[{id:"b0b502b7-c001-4000-a000-0547116af000",name:"1座",floors:[{id:"b0b502b7-c001-4001-a000-0547116af000",name:"楼层一",active:!0,isOn:!1,rooms:[{id:"b0b502b7-c001-4001-a001-0547116af000",name:"主卧",busId:"7e0378ca-c813-4056-a001-485e2970c001",active:!0,isOn:!1,devices:[{id:"b0b502b7-c001-4001-a001-0547116af001",type:"light",areacode:1,addr:1,channel:1,name:"吊灯",summary:"关闭",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!1},{id:"b0b502b7-c001-4001-a001-0547116af002",type:"light",areacode:1,addr:1,channel:2,name:"壁灯",summary:"开启",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!0},{id:"b0b502b7-c001-4001-a001-0547116af003",type:"curtain",areacode:1,addr:1,channel:3,name:"窗帘",summary:"50%",icon:"icon-ls_23_curtain",isFavorite:!1,hits:0,value:10},{id:"b0b502b7-c001-4001-a001-0547116af004",type:"dimmer",areacode:1,addr:1,channel:2,name:"床头灯",summary:"40%",icon:"icon-ls_4_dimmer",isFavorite:!1,hits:0,value:40}]},{id:"b0b502b7-c001-4001-a001-0547116af001",name:"客厅",busId:"7e0378ca-c813-4056-a001-485e2970c001",active:!0,isOn:!1,devices:[{id:"b0b502b7-c001-4001-a001-0547116af001",type:"light",areacode:1,addr:1,channel:1,name:"吊灯",summary:"关闭",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!1},{id:"b0b502b7-c001-4001-a001-0547116af002",type:"light",areacode:1,addr:1,channel:2,name:"壁灯",summary:"开启",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!0},{id:"b0b502b7-c001-4001-a001-0547116af003",type:"curtain",areacode:1,addr:1,channel:3,name:"窗帘",summary:"50%",icon:"icon-ls_23_curtain",isFavorite:!1,hits:0,value:10},{id:"b0b502b7-c001-4001-a001-0547116af004",type:"dimmer",areacode:1,addr:1,channel:2,name:"床头灯",summary:"40%",icon:"icon-ls_4_dimmer",isFavorite:!1,hits:0,value:40},{id:"b0b502b7-c001-4001-a001-0547116af005",type:"ac",name:"空调",summary:"制冷 26℃",icon:"icon-ls_7_ac",isFavorite:!0,hits:0,isOn:!1,value:26,mode:"制冷",fan:3,lock:0},{id:"b0b502b7-c001-4001-a001-0547116af006",type:"scene",areacode:1,addr:1,channel:1,name:"场景",summary:"关闭",icon:"icon-ls_26_go_off_work",isFavorite:!1,hits:0,isOn:!1},{id:"b0b502b7-c001-4001-a001-0547116af007",type:"heating",name:"地暖",summary:"26℃",icon:"icon-ls_19_heater",isFavorite:!0,hits:0,isOn:!1,value:26,mode:"",fan:0,lock:0},{id:"b0b502b7-c001-4001-a001-0547116af008",type:"fan",name:"新风",summary:"26℃",icon:"icon-ls_22_new_trend",isFavorite:!0,hits:0,isOn:!1,value:26,mode:"",fan:3,lock:0}]}]}]}],buses:[{name:"测试总线1",id:"7e0378ca-c813-4056-a001-485e2970c001",ip:"192.168.0.119",port:"8000",ws_url:"ws://192.168.0.119:6432",mac:"11 22 33 44 55 66",isOnline:!1}]},myProjectDemo:{id:"b0b502b7-c000-4000-a000-0547116af000",name:"演示项目",active:!0,blocks:[{id:"b0b502b7-c001-4000-a000-0547116af000",name:"1座",floors:[{id:"b0b502b7-c001-4001-a000-0547116af000",name:"楼层一",active:!0,isOn:!1,rooms:[{id:"b0b502b7-c001-4001-a001-0547116af000",name:"主卧",busId:"7e0378ca-c813-4056-a001-485e2970c001",active:!0,isOn:!1,devices:[{id:"b0b502b7-c001-4001-a001-0547116af001",type:"light",areacode:1,addr:1,channel:1,name:"吊灯",summary:"关闭",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!1},{id:"b0b502b7-c001-4001-a001-0547116af002",type:"light",areacode:1,addr:1,channel:2,name:"壁灯",summary:"开启",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!0},{id:"b0b502b7-c001-4001-a001-0547116af003",type:"curtain",areacode:1,addr:1,channel:3,name:"窗帘",summary:"50%",icon:"icon-ls_23_curtain",isFavorite:!1,hits:0,value:10},{id:"b0b502b7-c001-4001-a001-0547116af004",type:"dimmer",areacode:1,addr:1,channel:2,name:"床头灯",summary:"40%",icon:"icon-ls_4_dimmer",isFavorite:!1,hits:0,value:40}]},{id:"b0b502b7-c001-4001-a001-0547116af001",name:"客厅",busId:"7e0378ca-c813-4056-a001-485e2970c001",active:!0,isOn:!1,devices:[{id:"b0b502b7-c001-4001-a001-0547116af001",type:"light",areacode:1,addr:1,channel:1,name:"吊灯",summary:"关闭",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!1},{id:"b0b502b7-c001-4001-a001-0547116af002",type:"light",areacode:1,addr:1,channel:2,name:"壁灯",summary:"开启",icon:"icon-ls_1_light",isFavorite:!1,hits:0,isOn:!0},{id:"b0b502b7-c001-4001-a001-0547116af003",type:"curtain",areacode:1,addr:1,channel:3,name:"窗帘",summary:"50%",icon:"icon-ls_23_curtain",isFavorite:!1,hits:0,value:10},{id:"b0b502b7-c001-4001-a001-0547116af004",type:"dimmer",areacode:1,addr:1,channel:2,name:"床头灯",summary:"40%",icon:"icon-ls_4_dimmer",isFavorite:!1,hits:0,value:40},{id:"b0b502b7-c001-4001-a001-0547116af005",type:"ac",name:"空调",summary:"制冷 26℃",icon:"icon-ls_7_ac",isFavorite:!0,hits:0,isOn:!1,value:26,mode:"制冷",fan:3,lock:0},{id:"b0b502b7-c001-4001-a001-0547116af006",type:"scene",areacode:1,addr:1,channel:1,name:"场景",summary:"关闭",icon:"icon-ls_26_go_off_work",isFavorite:!1,hits:0,isOn:!1},{id:"b0b502b7-c001-4001-a001-0547116af007",type:"heating",name:"地暖",summary:"26℃",icon:"icon-ls_19_heater",isFavorite:!0,hits:0,isOn:!1,value:26,mode:"",fan:0,lock:0},{id:"b0b502b7-c001-4001-a001-0547116af008",type:"fan",name:"新风",summary:"26℃",icon:"icon-ls_22_new_trend",isFavorite:!0,hits:0,isOn:!1,value:26,mode:"",fan:3,lock:0}]}]}]}],buses:[{name:"测试总线1",id:"7e0378ca-c813-4056-a001-485e2970c001",ip:"192.168.0.119",port:"8000",ws_url:"ws://192.168.0.119:6432",mac:"11 22 33 44 55 66",isOnline:!1}]},myUuid:"",projectId:"",projectShare:[],projectList:[],projectListCloud:[],testServer:"ws://192.168.0.119:6432",messages:[{id:1,title:"系统通知",date:"2020-07-01 07:22:14",content:"停服维护已经结束，停服期间给您带来的不便，我们深表歉意。",showDelete:!1},{id:2,title:"版本更新公告",date:"2020-06-25 17:43:53",content:"我们预计于北京时间：2020-06-26 02:00 - 04:00进行为期两个小时的停服更新维护。",showDelete:!1},{id:3,title:"升级提醒",date:"2020-06-01 15:14:32",content:"为了使用户获得更好的体验，我们刚刚完成了一次热更，请重新启动程序以使更新生效。",showDelete:!1},{id:4,title:"系统通知",date:"2020-05-28 12:53:43",content:"停服维护已经结束，停服期间给您带来的不便，我们深表歉意。",showDelete:!1}],themeCur:1,drawerAbout:!1,drawerGateway:!1,drawerTest:!1,drawerBlock:!1,drawerTheme:!1},h()(e,"drawerTest",!1),h()(e,"drawerShareList",!1),h()(e,"drawerScan",!1),h()(e,"drawerCamera",!0),h()(e,"fullscreenLoading",!1),h()(e,"camera",{divOpacity:0,heightCameraRC:.58*window.innerWidth,heightCameraRCButton:.58*window.innerWidth*.25,playerOptions:{playbackRates:[.5,1,1.5,2],autoplay:!1,muted:!1,loop:!1,preload:"auto",language:"zh-CN",aspectRatio:"4:3",fluid:!0,sources:[{type:"application/x-mpegURL",src:""}],poster:"",notSupportedMessage:"此视频暂无法播放，请稍后再试",controlBar:{timeDivider:!0,durationDisplay:!0,remainingTimeDisplay:!1,fullscreenToggle:!0}},PTZ_DIRT:{UP:0,DOWN:1,LEFT:2,RIGHT:3},_cur_dirt:-1,player:null,device:null,ys_token:"",ys_appkey:""}),h()(e,"editing",{project:null,floor:null,room:null,bus:null,selectedDevice:null,scanBusResult:[],udp_client:null,scanningBus:!1}),h()(e,"cameraList",[]),h()(e,"showCaseTopLeft","MESSAGE"),h()(e,"showCaseTopRight","FLOOR"),h()(e,"isDesignLogic",!1),h()(e,"arrDesignLogic",[]),h()(e,"scanDevice",{isGet:!1,addr:0,areacode:0,channelList:[]}),h()(e,"timerUl",null),h()(e,"isCustomTitle",!1),h()(e,"customTitle",""),h()(e,"isPad",!1),h()(e,"timeCount",0),h()(e,"weather","暂未获取到环境信息&nbsp;>"),h()(e,"isTypeOn",{scene:!0,light:!1,curtain:!1,ac:!1,module:!1}),h()(e,"pageCase","ALL_TYPE"),h()(e,"showSwitchPanel",!1),h()(e,"waitingBusReturn",!1),e),logList:{logs:[]},heightSendMessage:window.innerHeight-180,heightCameraRC:.58*window.innerWidth,heightCameraRCButton:.58*window.innerWidth*.25,widthDrawerTest:window.innerWidth,windowHeight:window.innerHeight+"px",aboutLogoClickCount:0,udp_client:null,transitionName:"slide-left",showSharedQRCode:!1,qrcode:function(){return"http://app.lk-control.com/txt2qrcode?txt="+escape(t.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+t.golbal.myProject.id)}}},watch:{$route:function(e,t){console.log(e.path);var i=this;"/"==e.path&&setTimeout(function(){i.$router.push({path:"/room"})},1e3),"/device"==e.path||"/addDevice"==e.path||"/"==e.path?(this.golbal.showCaseTopLeft="BACK",this.golbal.showCaseTopRight="",this.golbal.showFooter=!1):(this.golbal.showCaseTopLeft="MESSAGE",this.golbal.showCaseTopRight="",this.golbal.showFooter=!0),e.meta.index>t.meta.index?this.transitionName="slide-left":this.transitionName="slide-right",null!=this.golbal.timerUl&&(clearInterval(this.golbal.timerUl),this.golbal.timerUl=null),null==e.meta.isCustomTitle?this.golbal.isCustomTitle=!1:this.golbal.isCustomTitle=e.meta.isCustomTitle,"/camera"==t.path&&(console.log("stop play"),"undefined"!=typeof cordova&&window.VideoPlayerVLC.stop(function(e){},function(e){}))}},methods:{readConfig:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:b.a.golbal=e.golbal,b.a.Router=e.$router,i=window.localStorage,e.golbal.username=null==i.getItem("username")?"":i.getItem("username"),e.golbal.nickname=null==i.getItem("nickname")?"":i.getItem("nickname"),e.golbal.accessToken=null==i.getItem("accessToken")?"":i.getItem("accessToken"),e.golbal.userId=null==i.getItem("userId")?"":i.getItem("userId"),null==b.a.myProject&&(a=null,a=i.getItem("myProject"),o="",location.href.indexOf("?")>0?(s=f.a.parse(location.href.substring(location.href.indexOf("?")).replace("?","")),console.log(s),null!=s.openid?(o=s.openid,e.golbal.isWeixin=!0,e.golbal.myUuid=o,e.readConfit_step2(a,i)):null!=s.code&&e.wxlogin(s.code)):(e.golbal.myUuid=i.getItem("myUuid"),e.readConfit_step2(a,i)));case 8:case"end":return t.stop()}},t,e)}))()},readConfit_step2:function(e,t){if(console.log("to read config_step2"),null!=this.golbal.myUuid&&""!=this.golbal.myUuid||(this.golbal.myUuid=b.a.uuid(),t.setItem("myUuid",this.golbal.myUuid)),null!=e&&(this.golbal.myProject=JSON.parse(t.getItem("myProject")),this.golbal.isGallery=null==t.getItem("isGallery")||1==parseInt(t.getItem("isGallery"))),null!=this.golbal.myProject&&null!=this.golbal.myProject.blocks){null==this.golbal.myProject.projectName&&(this.golbal.myProject.projectName=this.golbal.myProject.name),null==this.golbal.myProject.projectSummary&&(this.golbal.myProject.projectSummary=this.golbal.myProject.summary),0==this.golbal.projectList.length&&this.golbal.projectList.push(this.golbal.myProject);for(var i=0;i<this.golbal.myProject.blocks.length;i++){var a=this.golbal.myProject.blocks[i];a.active=!1;for(var o=0;o<a.floors.length;o++){var s=a.floors[o];s.active=!1;for(var n=0;n<s.rooms.length;n++){s.rooms[n].active=!1}}}if(null!=this.golbal.myProject.buses&&this.golbal.myProject.buses.length>0)for(i=0;i<this.golbal.myProject.buses.length;i++){var l=this.golbal.myProject.buses[i];l.isOnline=!1,l.isOnlineLocal=!1}if(b.a.MyProject=this.golbal.myProject,this.golbal.blockCur=this.golbal.myProject.blocks[0],null==this.golbal.blockCur)return;if(this.golbal.blockCur.active=!0,this.golbal.floorCur=this.golbal.blockCur.floors[0],null==this.golbal.floorCur)return;if(this.golbal.floorCur.active=!0,this.golbal.roomCur=this.golbal.floorCur.rooms[0],null==this.golbal.roomCur)return;this.golbal.roomCur.active=!0;var c=[];if(null!=this.golbal.myProject.blocks&&this.golbal.myProject.blocks.length>0&&null!=this.golbal.myProject.blocks[0].floors&&this.golbal.myProject.blocks[0].floors.length>0)for(i=0;i<this.golbal.myProject.blocks.length;i++)for(o=0;o<this.golbal.myProject.blocks[i].floors.length;o++)if(null!=this.golbal.myProject.blocks[i].floors[o].rooms&&this.golbal.myProject.blocks[i].floors[o].rooms.length>0)for(n=0;n<this.golbal.myProject.blocks[i].floors[o].rooms.length;n++)if(this.golbal.myProject.blocks[i].floors[o].isOn=!1,null!=this.golbal.myProject.blocks[i].floors[o].rooms[n].devices&&this.golbal.myProject.blocks[i].floors[o].rooms[n].devices.length>0){this.golbal.myProject.blocks[i].floors[o].rooms[n].isOn=!1;for(var r=0;r<this.golbal.myProject.blocks[i].floors[o].rooms[n].devices.length;r++){var u={};u.device=this.golbal.myProject.blocks[i].floors[o].rooms[n].devices[r],u.device.roomId=this.golbal.myProject.blocks[i].floors[o].rooms[n].id,u.busId=this.golbal.myProject.blocks[i].floors[o].rooms[n].busId,null==u.device.type?u.device.type=u.device.deviceType:null==u.device.deviceType&&(u.device.deviceType=u.device.type),u.device.isOn=!1,null!=u.device.value&&(u.device.value=0),c.push(u)}}}b.a.devicesAll=c;var d=b.a.getFavourite();if(null!=d)for(i=0;i<c.length;i++)c[i].device.isFavorite=!1,d.indexOf(c[i].device.id)>-1&&(c[i].device.isFavorite=!0);""==this.golbal.accessToken||null==this.golbal.accessToken?(console.log("to login"),this.$router.push({path:"/login"})):(console.log("to room"),this.$router.push({path:"/room"})),b.a.getTypeStatus(),b.a.sendQueryDeviceStatus()},login:function(){var e=this,t={action:"APP_CHECK_USER_UUID"};t.uuid=this.golbal.myUuid,p.a.post(this.golbal.GET_DATA,{data:t,header:{"Content-Type":"application/jsonp"}}).then(function(t){if("SUCCESS"==t.data.status){if(null!=t.data.weather&&"1"==t.data.weather.status){var i=t.data.weather.lives[0],a="";i.weather.indexOf("雨")>-1?a+='<i  class="el-icon-heavy-rain"></i>':i.weather.indexOf("雪")>-1?a+='<i class="el-icon-light-rain"></i>':i.weather.indexOf("雷")>-1?a+='<i class="el-icon-lightning"></i>':i.weather.indexOf("阴")>-1||i.weather.indexOf("云")>-1?a+='<i class="el-icon-cloudy"></i>':a+='<i  class="el-icon-sunny"></i>',a=(a='<div style="float:left">'+a+"</div>")+"&nbsp;&nbsp;"+i.temperature+"℃&nbsp;Temp&nbsp;&nbsp;|&nbsp;&nbsp;"+i.humidity+"%&nbsp;RH&nbsp;",a+='<i class="el-icon-arrow-right"></i>',e.golbal.weather=a}e.golbal.username=t.data.username,e.golbal.nickname=t.data.nickname,e.golbal.userId=null==t.data.userId?0:t.data.userId,e.golbal.projectListCloud=t.data.projectList,null!=t.data.projectListLocal&&t.data.projectListLocal.length>0&&(e.golbal.projectList=t.data.projectListLocal),e.golbal.showFooter=!0;var o=window.localStorage;if(o.setItem("username",e.golbal.username),o.setItem("nickname",e.golbal.nickname),o.setItem("accessToken",t.data.accessToken),o.setItem("refreshToken",t.data.refreshToken),o.setItem("userId",e.golbal.userId),""==e.golbal.username&&(e.golbal.username=o.getItem("username")),""==e.golbal.nickname&&(e.golbal.nickname=o.getItem("nickname")),e.golbal.accessToken=o.getItem("accessToken"),""==e.golbal.userId&&(e.golbal.userId=o.getItem("userId")),console.log("accessToken:"+e.golbal.accessToken),b.a.cleanProject(),""==e.golbal.accessToken||null==e.golbal.accessToken)e.$router.push({path:"/login"});else{if(e.golbal.isWeixin&&e.golbal.projectListCloud.length>0){var s={action:"APP_RESUME_PROJECT"};s.id=e.golbal.projectListCloud[0].projectId,s.accessToken=e.golbal.accessToken,p.a.post(e.golbal.GET_DATA,s,{header:{"Content-Type":"application/jsonp"}}).then(function(t){if("SUCCESS"==t.data.status){console.log(t.data.project);var i=t.data.project;null==i.projectName&&(i.projectName=i.name),null==i.projectSummary&&(i.projectSummary=i.summary),i.localUserId=e.golbal.userId;for(var a=0;a<e.golbal.projectListCloud.length;a++)e.golbal.projectListCloud[a].projectId==i.id&&(i.isMaster=e.golbal.projectListCloud[a].isMaster,i.isAdmin=e.golbal.projectListCloud[a].isAdmin);var o=!1;for(a=0;a<e.golbal.projectList.length;a++)e.golbal.projectList[a].id==i.id&&(o=!0,e.golbal.projectList[a]=i);o||e.golbal.projectList.push(i),b.a.getData(i,function(){setTimeout(function(){b.a.sendQueryDeviceStatus(),b.a.getTypeStatus()},1e3),e.golbal.qrcode="http://app.lk-control.com/txt2qrcode?txt="+escape(e.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+e.golbal.projectId)})}})}e.refreshEZAccessToken(),e.$router.push({path:"/room"})}}})},wxlogin:function(e){var t=this,i=this.golbal.HOST+"/wxapi?action=WX_LOGIN&code="+e;p.a.get(i,{}).then(function(e){if("SUCCESS"==e.data.status){var i=window.localStorage,a=i.getItem("myProject");console.log(e.data);var o=e.data.openid;t.golbal.isWeixin=!0,t.golbal.myUuid=o,t.readConfit_step2(a,i),s=t.golbal.HOST,n=function(){t.login()},p.a.get(s+"/wxapi?action=INIT_WX_SDK&myurl="+escape(window.location)).then(function(e){wx.config({beta:!0,debug:!1,appId:e.data.appId,timestamp:e.data.timeStamp,nonceStr:e.data.nonceStr,signature:e.data.signature,jsApiList:["chooseImage","scanQRCode","getLocation"]})}).catch(function(e){console.log(e)}),null!=wx&&(wx.ready(function(){!0,b.a.golbal.WX_SDK_READY=!0,null!=n&&n()}),wx.error(function(e){b.a.golbal.WX_SDK_READY=!1,console.log(e)}))}var s,n})},aboutLogoClick:function(){0==this.aboutLogoClickCount&&setTimeout(function(){this.aboutLogoClickCount=0}),this.aboutLogoClickCount+=1,10==this.aboutLogoClickCount&&(this.golbal.showDebug=!0)},blockClick:function(e){for(var t=0;t<this.golbal.myProject.blocks.length;t++){this.golbal.myProject.blocks[t].active=!1}e.active=!0,this.golbal.blockCur=e,this.golbal.floorCur=this.golbal.blockCur.floors[0];for(t=0;t<this.golbal.blockCur.floors.length;t++){this.golbal.blockCur.floors[t].active=0==t}this.golbal.roomCur=this.golbal.floorCur.rooms[0];for(t=0;t<this.golbal.floorCur.rooms.length;t++){this.golbal.floorCur.rooms[t].active=0==t}b.a.getTypeStatus(),this.drawerBlock=!1},themeClick:function(e){this.golbal.themeCur!=e&&(document.getElementById("style").attributes[2].value="static/css/style"+e+".css"),this.golbal.themeCur=e,b.a.saveSetting()},clearLog:function(){this.logList.logs=[]},timeTick1000:function(){this.golbal.timeCount++,this.golbal.timeCount>1e3&&(this.golbal.timeCount=0)},init:function(){var e=this;return d()(r.a.mark(function t(){var i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Object(_.d)(),t.next=3,e.readConfig();case 3:try{i=e,null!=networkinterface&&networkinterface.getWiFiIPAddress(function(e){console.log("IP: "+e.ip+" subnet:"+e.subnet);var t=e.ip.split(".");4==t.length&&(i.ip_boardcast=t,i.sendUDPBoardCast(t))},function(e){console.log(e)})}catch(e){console.log(e)}"undefined"!=typeof WeixinJSBridge?i=e:e.login(),console.log("finish init");case 6:case"end":return t.stop()}},t,e)}))()},sendUDPBoardCast:function(e){var t=this;setTimeout(function(){if(1!=t.checkConnected()){var i=e[0]+"."+e[1]+"."+e[2]+".255";t.udp_client=new UDP.Client(i,1901,t.onUDPMessage),t.golbal.editing.udp_client=t.udp_client,setTimeout(function(){var e=[];e.push(255),e.push(1),e.push(1),e.push(2),t.udp_client.send(e,function(){console.log("sended")},function(){console.log("send fail")})},500)}},5e3)},sendWSBoardCast:function(e){b.a.log("通过WS轮询");for(var t=this,i=100;i<=254;i++){var a=e[0]+"."+e[1]+"."+e[2]+"."+i;setTimeout(function(e){b.a.connectWSByUDPBoardCast(e,function(i){console.log(e),t.handlerWSReceive12Addr(i,e)})},100*(i-100),a)}for(i=2;i<100;i++){a=e[0]+"."+e[1]+"."+e[2]+"."+i;setTimeout(function(e){b.a.connectWSByUDPBoardCast(e,function(i){console.log(e),t.handlerWSReceive12Addr(i,e)})},100*(i+154),a)}},onUDPMessage:function(e){var t=this,i=new Uint8Array(e.data);if(b.a.log("<== 广播回复 "+b.a.bytes2hex(i)),255==i[0]&&i[1]==i.length&&!(i.length<36)){this.needRequestAll=!1;for(var a=[],o=5;o<=8;o++)a.push(i[o]);var s=a[0]+"."+a[1]+"."+a[2]+"."+a[3];b.a.log("ip:"+s),null!=this.golbal.myProject.buses&&(b.a.log("关注网关数:"+this.golbal.myProject.buses.length),b.a.connectWSByUDPBoardCast(s,function(e){t.handlerWSReceive12Addr(e,s)}))}},handlerWSReceive12Addr:function(e,t){console.log(e);for(var i=0;i<this.golbal.myProject.buses.length;i++){var a=this.golbal.myProject.buses[i];b.a.log("bus mac:"+a.addr+",bus ip:"+e.ip+",比较后:"+(a.addr.trim()==e.addr.trim())),a.addr.trim()==e.addr.trim()&&(a.ip=e.ip,a.source_url=a.ws_url,a.ws_url="ws://"+e.ip+":6432/",b.a.log("更新网关"+a.addr+"的ip:"+e.ip))}for(i=0;i<this.golbal.myProject.buses.length;i++){a=this.golbal.myProject.buses[i];setTimeout(_.e,2e3*i,S.a.receiveData,a.ws_url)}b.a.saveProject(this.golbal.myProject)},projectCancelClick:function(){var e=this;this.$confirm("此操作将解除绑定, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"divUserConfirm"}).then(function(){e.projectCancel()}).catch(function(){})},projectCancel:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).action="APP_PROJECT_CANCEL",i.uuid=e.golbal.myUuid,t.next=5,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 5:"SUCCESS"==(a=t.sent).data.status&&(e.golbal.projectId="",b.a.getData(a.data.project),e.golbal.drawerShareList=!1);case 7:case"end":return t.stop()}},t,e)}))()},onChangeProject:function(){this.onAppResume()},onSavedProject:function(){this.login()},getEZAppKey:function(){var e={};e.uuid=this.golbal.myUuid,e.action="APP_GET_EZ_APPKEY",p()({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(e)),header:{"Content-Type":"application/jsonp"}}).then(function(e){}).catch(function(e){console.log(e)})},refreshEZAccessToken:function(){var e=this,t={};t.uuid=this.golbal.myUuid,t.action="APP_GET_YS_ACCESS_TOKEN",p()({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(t)),header:{"Content-Type":"application/jsonp"}}).then(function(t){e.golbal.camera.ys_token=t.data.accessToken,e.golbal.camera.ys_appkey=t.data.appkey}).catch(function(e){console.log(e)})},onGetQRData:function(e){b.a.onGetQRData(e)},onAppResume:function(){var e=this;b.a.log("resume"),Object(_.i)(),Object(_.d)(),setTimeout(function(){if("/room"==e.$route.path)b.a.sendQueryDeviceStatus();else if("/favorite"==e.$route.path)for(var t=[],i=0;i<b.a.devicesAll.length;i++){var a=!0,o=b.a.devicesAll[i].device;if(o.isFavorite){for(var s=0;s<t.length;s++)o.type.startsWith("sensor")||parseInt(o.areacode)==t[s].areacode&&parseInt(o.addr)==t[s].addr&&(a=!1);a&&(b.a.sendQueryDeviceStatusOne(o),t.push({areacode:parseInt(o.areacode),addr:parseInt(o.addr)}))}}},1e3);for(var t=0;t<this.golbal.myProject.buses.length;t++){var i=this.golbal.myProject.buses[t];Object(_.c)(i.ws_url)}for(t=0;t<this.golbal.myProject.buses.length;t++){i=this.golbal.myProject.buses[t];setTimeout(_.e,2e3*(t+1),S.a.receiveData,i.ws_url)}},checkConnected:function(){if(0==Object(_.g)()){var e=0;if(console.log("检查本地连接情况"),null==this.golbal.myProject.buses)return;if(this.golbal.myProject.buses.length>0)for(var t=0;t<this.golbal.myProject.buses.length;t++){var i=this.golbal.myProject.buses[t];Object(_.h)("ws://"+i.ip+":6432")?(i.isOnlineLocal=!0,e++,b.a.log("已连接"+i.ip)):(i.isOnlineLocal=!1,b.a.log("未连接"+i.ip))}return 0==e?0:e==this.golbal.myProject.buses.length?1:2}return 1},askBusIsBind:function(e,t,i){e.isBind=!1,null!=t&&t(e)},onFrameLoad:function(){console.log("onFrameLoad")},getServerVersionCode:function(){var e=this,t={action:"APP_GET_UPGRADE_INFO"};p.a.post(this.golbal.GET_DATA,{data:t,header:{"Content-Type":"application/jsonp"}}).then(function(t){e.golbal.VERSION_CODE_SERVER=parseInt(t.data.version),e.golbal.VERSION_URL=t.data.install_url})},downloadNewVersion:function(){this.upgrading=!0,this.download()},onProgress:function(e){},download:function(){var e=this,t=new FileTransfer,i=encodeURI(e.golbal.VERSION_URL);t.onprogress=function(t){e.upgrading_process=Math.floor(t.loaded/t.total*100)},t.download(i,"cdvfile://localhost/persistent/path/to/downloads/download.apk",function(e){console.log("download complete: "+e.toURL()),cordova.plugins.fileOpener2.open(e.toURL(),"application/vnd.android.package-archive")},function(e){console.log("download error source "+e.source),console.log("download error target "+e.target),console.log("download error code"+e.code)},!1,{})}},mounted:function(){b.a.root=this,window.document.addEventListener("resume",this.onAppResume),setTimeout(this.init,500),setTimeout(this.checkConnected,5e3),setInterval(this.checkConnected,3e4),setInterval(this.timeTick1000,100),console.log(window.innerWidth+","+window.innerHeight),window.innerWidth>window.innerHeight&&(document.getElementById("style_main").attributes[2].value="static/css/style_pad.css",document.getElementById("style_element").attributes[2].value="static/css/element-ui_pad.css",document.getElementById("style").attributes[2].value="static/css/style1_pad.css",this.windowHeight="calc(100vh - 6vw)"),this.getServerVersionCode()}},j={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.golbal.fullscreenLoading,expression:"golbal.fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],style:"height:"+e.windowHeight,attrs:{id:"page","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e._m(0),e._v(" "),"/"!=e.$route.path?i("FrameHeader",{attrs:{golbal:e.golbal},on:{onChangeProject:function(t){return e.onChangeProject()}}}):e._e(),e._v(" "),i("transition",{attrs:{name:e.transitionName}},[i("router-view",{ref:"routerView",attrs:{golbal:e.golbal,logList:e.logList},on:{onGetQRData:function(t){return e.onGetQRData()},onSavedProject:function(t){return e.onSavedProject()}}})],1),e._v(" "),e.golbal.showFooter&&"/"!=e.$route.path?i("FrameFooter",{attrs:{golbal:e.golbal}}):e._e(),e._v(" "),i("el-dialog",{attrs:{title:"关于",visible:e.golbal.drawerAbout,"custom-class":"drawerAbout",top:"0vh"},on:{"update:visible":function(t){return e.$set(e.golbal,"drawerAbout",t)}}},[i("div",{staticClass:"divAboutLogo",on:{touchend:function(t){return e.aboutLogoClick()}}},[i("img",{attrs:{src:"static/images/about_logo.png"}})]),e._v(" "),i("div",{staticClass:"divAboutAppname"},[i("span",{staticStyle:{color:"#bdbdbd"}},[e._v("LinkABC")])]),e._v(" "),i("hr",{staticClass:"hrAbout"}),e._v(" "),i("div",{staticClass:"divAboutVersion"},[i("span",{staticStyle:{color:"#bdbdbd"}},[e._v(e._s(e.version))])]),e._v(" "),i("div",{staticClass:"divAboutVersionInfo"},[e.golbal.VERSION_CODE_SERVER==e.golbal.VERSION_CODE?i("span",{staticStyle:{color:"#bdbdbd"}},[e._v("当前已经是最新版本")]):e._e(),e._v(" "),e.golbal.VERSION_CODE_SERVER>e.golbal.VERSION_CODE&&!e.upgrading?i("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.downloadNewVersion()}}},[e._v("下载并更新")]):e._e(),e._v(" "),e.upgrading?i("el-progress",{attrs:{percentage:e.upgrading_process,status:"warning","stroke-width":40,"text-inside":!0}}):e._e()],1)]),e._v(" "),i("el-dialog",{staticStyle:{"margin-top":"-15vh"},attrs:{title:"网关列表",visible:e.golbal.drawerGateway,"custom-class":"drawerGateway"},on:{"update:visible":function(t){return e.$set(e.golbal,"drawerGateway",t)}}},[i("ul",[i("li",[i("div",{staticClass:"divGateway1"},[e._v("名称")]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v("MAC")]),e._v(" "),i("div",{staticClass:"divGateway3"},[e._v("在线")])]),e._v(" "),e._l(e.golbal.myProject.buses,function(t){return i("li",{key:t.id},[i("div",{staticClass:"divGateway1"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v(e._s(t.mac))]),e._v(" "),i("div",{staticClass:"divGateway3"},[i("i",{class:t.isOnline?"icon-checkmark":""})])])})],2)]),e._v(" "),i("el-dialog",{staticStyle:{"margin-top":"-15vh"},attrs:{title:"请选择楼栋",visible:e.golbal.drawerBlock,"custom-class":"drawerBlock"},on:{"update:visible":function(t){return e.$set(e.golbal,"drawerBlock",t)}}},[i("ul",e._l(e.golbal.myProject.blocks,function(t){return i("li",{key:t.id,on:{click:function(i){return e.blockClick(t)}}},[i("i",{staticClass:"icon-office"}),i("span",[e._v(e._s(t.name))]),e._v(" "),t.active?i("div",{staticClass:"checked"},[i("i",{staticClass:"icon-yuanxingxuanzhongfill"})]):e._e()])}),0)]),e._v(" "),i("el-dialog",{staticStyle:{"margin-top":"-15vh"},attrs:{title:"请选择主题样式",visible:e.golbal.drawerTheme,"custom-class":"drawerTheme"},on:{"update:visible":function(t){return e.$set(e.golbal,"drawerTheme",t)}}},[i("div",{staticClass:"divUserTheme"},[i("div",{class:"divUserThemeItem"+(1==e.golbal.themeCur?"":" divUserThemeItemC"),on:{click:function(t){return e.themeClick(1)}}},[i("div",{staticClass:"divUserThemeIcon"},[i("i",{staticClass:"icon-checkmark"})]),e._v(" "),i("div",{staticClass:"divUserThemeBoard"}),e._v(" "),i("img",{attrs:{src:"static/images/theme1.jpg"}})]),e._v(" "),i("div",{class:"divUserThemeItem"+(2==e.golbal.themeCur?"":" divUserThemeItemC"),on:{click:function(t){return e.themeClick(2)}}},[i("div",{staticClass:"divUserThemeIcon"},[i("i",{staticClass:"icon-checkmark"})]),e._v(" "),i("div",{staticClass:"divUserThemeBoard"}),e._v(" "),i("img",{attrs:{src:"static/images/theme2.jpg"}})])])]),e._v(" "),i("el-dialog",{staticStyle:{"margin-top":"-15vh"},attrs:{title:"日志",visible:e.golbal.drawerTest,"custom-class":"drawerTest"},on:{"update:visible":function(t){return e.$set(e.golbal,"drawerTest",t)}}},[i("el-button",{on:{click:e.clearLog}},[e._v("清空")]),e._v(" "),i("div",{staticClass:"divSendMessage",style:"width:100%;height:"+e.heightSendMessage+"px;overflow-y:auto"},[i("ul",{staticClass:"ulLog"},e._l(e.logList.logs,function(t){return i("li",{key:t},[e._v(e._s(t))])}),0)])],1),e._v(" "),i("el-dialog",{attrs:{title:"项目绑定管理",visible:e.golbal.drawerShareList,"custom-class":"drawerShareList"},on:{"update:visible":function(t){return e.$set(e.golbal,"drawerShareList",t)}}}),e._v(" "),i("el-drawer",{attrs:{visible:e.golbal.drawerScan,direction:"btt","with-header":!1},on:{"update:visible":function(t){return e.$set(e.golbal,"drawerScan",t)}}},[i("ul",{staticClass:"ulScan"},[i("li",[i("el-button",{staticStyle:{width:"100%"}},[e._v("手机摄像头")])],1),e._v(" "),i("li",[i("el-button",{staticStyle:{width:"100%"}},[e._v("从相册选择")])],1)])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("audio",{attrs:{id:"alarm"}},[t("source",{attrs:{src:"static/images/d.mp3"}})])}]},O=i("VU/8")(I,j,!1,null,null,null).exports,P=i("/ocq"),R=i("I0MY"),x=i.n(R),A=i("NVJ6"),L={data:function(){var e=this;return{loop:null,dialogVisible:!1,typeCode:function(){var t=e.device.deviceType;switch(null==t&&(t=e.device.type),t){case"light":return"L";case"dimmer":return"D";case"module_light":return"L";case"module_dimmer":return"D";case"curtain":case"process_curtain":return"C";case"scene":return"S";default:return""}}}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},isCondition:{type:!0,default:!1},actionStatus:{type:Object,default:function(){return{value:!1}}}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){"CONTROL"==this.mode?null==e.isSwitch||e.isSwitch?(document.getElementById("alarm").play(),e.isOn=!e.isOn,b.a.getTypeStatus(),w.a.sendAction(e)):(document.getElementById("alarm").play(),e.isOn=!0,w.a.sendAction(e),setTimeout(function(){e.isOn=!1},250)):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))}}},N={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:(e.isSelected?"divDeviceSelect":e.isCondition?"divDeviceCondition":"")+" divDevice",on:{click:function(t){return e.switchClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopLight"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:"line-height:24px;"+(""!=e.device.icon?"":"margin-right:62px;"),on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:((e.isSelected?e.actionStatus.value:e.device.isOn)?"iconC ":"")+"divIcon",on:{click:function(t){return t.stopPropagation(),e.switchClick(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameOther"+((e.isSelected?e.actionStatus.value:e.device.isOn)?" iconC":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{class:"spanDeviceSummary"},[e._v(e._s((e.isSelected?e.actionStatus.value:e.device.isOn)?"ON":"OFF"))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr+"-"+e.typeCode()+e.device.channel)+"\n    ")]):e._e()])},staticRenderFns:[]};var V=i("VU/8")(L,N,!1,function(e){i("NyJZ")},"data-v-7a04637c",null).exports,M={data:function(){var e=this;return{loop:null,dialogVisible:!1,typeCode:function(){var t=e.device.deviceType;switch(null==t&&(t=e.device.type),t){case"light":return"L";case"dimmer":return"D";case"module_light":return"L";case"module_dimmer":return"D";case"curtain":case"process_curtain":return"C";case"scene":return"S";default:return""}}}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},isCondition:{type:!0,default:!1}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},curtainClick:function(e,t){"CONTROL"==this.mode?(document.getElementById("alarm").play(),null==t?100==this.device.value?this.device.value=0:this.device.value=100:e.value=t,b.a.getTypeStatus(),w.a.sendAction(this.device),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,e.value)):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){console.log("long tap"),this.$refs.DesignLoginContent.show()}}},B={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice divDeviceLight",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":e.isCondition?"background-color:rgba(57,129,214,0.4);":"",on:{click:function(t){return e.curtainClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:""!=e.device.icon?"":"margin-left:15px;"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{staticClass:"divIcon",on:{touchstart:function(t){return e.start(e.device)},touchend:function(t){return e.end(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName"+(e.device.isOn?" iconC":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(0==e.device.value?"CLOSE":100==e.device.value?"OPEN":"STOP"))])]),e._v(" "),i("div",{staticClass:"divControl"},[i("div",{class:"btnCurtain btnCurtain1"+(100==e.device.value?" iconC":""),on:{click:function(t){return t.stopPropagation(),e.curtainClick(e.device,100)}}},[i("i",{staticClass:"icon-arrow-left"}),i("i",{staticClass:"icon-arrow-right"})]),e._v(" "),i("div",{class:"btnCurtain btnCurtain2"+(101==e.device.value?" iconC":""),on:{click:function(t){return t.stopPropagation(),e.curtainClick(e.device,101)}}},[i("i",{staticClass:"icon-pause2"})]),e._v(" "),i("div",{class:"btnCurtain btnCurtain3"+(0==e.device.value?" iconC":""),on:{click:function(t){return t.stopPropagation(),e.curtainClick(e.device,0)}}},[i("i",{staticClass:"icon-arrow-right"}),i("i",{staticClass:"icon-arrow-left"})])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr+"-"+e.typeCode()+e.device.channel)+"\n    ")]):e._e()])},staticRenderFns:[]},U=i("VU/8")(M,B,!1,null,null,null).exports,$={data:function(){var e=this;return{loop:null,dialogVisible:!1,typeCode:function(){var t=e.device.deviceType;switch(null==t&&(t=e.device.type),t){case"light":return"L";case"dimmer":return"D";case"module_light":return"L";case"module_dimmer":return"D";case"curtain":case"process_curtain":return"C";case"scene":return"S";default:return""}}}},props:{device:{type:Object,default:null},touchAction:{type:Object,default:{isDown:!1}},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},isCondition:{type:!0,default:!1},actionStatus:{type:Object,default:{value:0}}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},dimmerChange:function(){this.touchAction.isDown=!0,b.a.getTypeStatus();w.a.sendAction(this.device),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,this.device.value)},switchClick:function(e){"CONTROL"==this.mode?(document.getElementById("alarm").play(),e.value>0?e.value=0:e.value=100,b.a.getTypeStatus(),w.a.sendAction(e),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,this.device.value)):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))}},mounted:function(){this.dimmerValue=this.device.value}},Y={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice divDeviceLight",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":e.isCondition?"background-color:rgba(57,129,214,0.4);":"",on:{click:function(t){return e.switchClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:""!=e.device.icon?"":"margin-left:15px;"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:((e.isSelected?e.actionStatus.value:e.device.value)>0?"iconC ":"")+"divIcon"},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameOther"+((e.isSelected?e.actionStatus.value:e.device.value)>0?" iconC":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{class:"spanDeviceSummary"},[e._v(e._s(e.isSelected?e.actionStatus.value:e.device.value)+"%")])]),e._v(" "),i("div",{staticClass:"divControl"},[i("div",{staticClass:"divDimmer1"},["CONTROL"==e.mode||"FAVORITE"==e.mode?i("el-slider",{attrs:{"show-tooltip":!1,disabled:"SELECT"==e.mode},on:{change:e.dimmerChange},model:{value:e.device.value,callback:function(t){e.$set(e.device,"value",t)},expression:"device.value"}}):i("el-slider",{attrs:{value:e.isSelected?e.actionStatus.value:e.device.value,"show-tooltip":!1,disabled:"SELECT"==e.mode},on:{change:e.dimmerChange}})],1)]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n            "+e._s(e.device.areacode+"-"+e.device.addr+"-"+e.typeCode()+e.device.channel)+"\n        ")]):e._e()])},staticRenderFns:[]},F=i("VU/8")($,Y,!1,null,null,null).exports,H={data:function(){return{loop:null,tableData:[],visiable:!1,room:"",floor:""}},props:["device"],methods:{fillData:function(){this.tableData=b.a.golbal.arrDesignLogic,this.room=b.a.golbal.roomCur.name,this.floor=b.a.golbal.floorCur.name},handleDeleteClick:function(e){this.tableData.splice(this.tableData.indexOf(e),1)},dialogDesignLogicOpened:function(){console.log("opened"),this.fillData()},show:function(){b.a.golbal.isDesignLogic&&(this.visiable=!0)},clearList:function(){var e=this;this.$confirm("确定要清空当前列表并重新编辑？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){b.a.golbal.arrDesignLogic=[],e.tableData=b.a.golbal.arrDesignLogic,e.visiable=!1}).catch(function(){})},sendDeleteLogic:function(){var e=this;this.$confirm("确定要删除当前的逻辑设置？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"scene"==e.device.type?w.a.sendDeleteScene(e.device):w.a.sendDeleteRelative(e.device),e.visiable=!1}).catch(function(){})},sendSaveLogic:function(){var e=this;this.$confirm("确定要发送当前的逻辑设置？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){"scene"==e.device.type?w.a.sendDesignScene(e.device):w.a.sendDesignRelative(e.device),b.a.golbal.arrDesignLogic=[],e.tableData=b.a.golbal.arrDesignLogic,e.visiable=!1}).catch(function(){})}}},G={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"设备列表",visible:e.visiable,width:"90%",top:"62px",modal:!1,height:"calc(100vh - 166px)"},on:{"update:visible":function(t){e.visiable=t},opened:e.dialogDesignLogicOpened}},[i("div",{},[i("ul",{staticClass:"ulLogicList",staticStyle:{padding:"0px","overflow-y":"auto",height:"calc(100vh - 317px)"}},e._l(e.tableData,function(t){return i("li",{key:t.name+t.addr+t.channel,staticClass:"divLogicItem"},[i("div",[i("div",{staticClass:"divLogicName"},[i("span",{staticClass:"loginColumnName",staticStyle:{display:"inline"}},[e._v("名称：")]),e._v(e._s(t.floor)+" - "+e._s(t.room)+" - "+e._s(t.name))]),e._v(" "),i("div",{staticClass:"divLogicAddr"},[i("span",{staticClass:"loginColumnName",staticStyle:{display:"inline"}},[e._v("地址：")]),e._v(e._s(t.addr))]),e._v(" "),i("div",{staticClass:"divLogicChannel"},[i("span",{staticClass:"loginColumnName",staticStyle:{display:"inline"}},[e._v("通道：")]),e._v(e._s(t.channel))]),e._v(" "),i("div",{staticClass:"divLogicStatus"},[i("span",{staticClass:"loginColumnName",staticStyle:{display:"inline"}},[e._v(e._s(t.status.label)+":")]),e._v(e._s(t.status.display))]),e._v(" "),i("el-button",{staticClass:"divLogicButton",attrs:{size:"mini"},on:{click:function(i){return e.handleDeleteClick(t)}}},[e._v("删除")])],1)])}),0)]),e._v(" "),i("span",{staticClass:"dialog-footer",staticStyle:{height:"90px"},attrs:{slot:"footer"},slot:"footer"},[i("div",{staticStyle:{width:"33.33%","text-align":"left",float:"left","margin-left":"-10px"}},[i("el-button",{attrs:{size:"mini"},on:{click:e.clearList}},[e._v("清空列表")])],1),e._v(" "),i("div",{staticStyle:{width:"33.33%","text-align":"center",float:"left","margin-left":"10px"}},[i("el-button",{attrs:{size:"mini"},on:{click:e.sendDeleteLogic}},[e._v("删除逻辑")])],1),e._v(" "),i("div",{staticStyle:{width:"33.34%","text-align":"right",float:"right","margin-right":"-10px"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.sendSaveLogic}},[e._v("确认设置")])],1)])])},staticRenderFns:[]};var W=i("VU/8")(H,G,!1,function(e){i("uorx")},"data-v-7360e57c",null).exports,K={data:function(){return{tabName:"ac",visibleFan:!1,visibleLock:!1,lockObj:{},acObj:{},airObj:{},heatObj:{}}},props:{device:{type:Object,default:null},selObj:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}}},methods:{favoriteClick:function(e){console.log("fav"),document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){document.getElementById("alarm").play(),e.isOn=!e.isOn;var t=null;if(null!=this.device?(t=this.device,b.a.getTypeStatus()):null!=this.selObj&&(t=this.selObj.device),null!=t)if("combo"==t.type){var i=this.createComboActionTag(1,e.isOn?1:0);w.a.sendComboAction(t,i)}else w.a.sendACAction(t,1)},addClick:function(e){if(e.value<30&&e.isOn){document.getElementById("alarm").play(),e.value=e.value+1,e.summary=e.mode+" "+e.value+"℃";var t=null;if(null!=this.device?(t=this.device,b.a.getTypeStatus()):null!=this.selObj&&(t=this.selObj.device),null!=t)if("combo"==t.type){var i=this.createComboActionTag(2,e.value);w.a.sendComboAction(t,i)}else w.a.sendACAction(t,2)}},minusClick:function(e){if(e.value>16&&e.isOn){document.getElementById("alarm").play(),e.value=e.value-1,e.summary=e.mode+" "+e.value+"℃";var t=null;if(null!=this.device?(t=this.device,b.a.getTypeStatus()):null!=this.selObj&&(t=this.selObj.device),null!=t)if("combo"==t.type){var i=this.createComboActionTag(2,e.value);w.a.sendComboAction(t,i)}else w.a.sendACAction(t,2)}},modeClick:function(e,t){if(e.isOn){document.getElementById("alarm").play(),e.mode=t,e.summary=e.mode+" "+e.value+"℃";var i=null;if(null!=this.device?(i=this.device,b.a.getTypeStatus()):null!=this.selObj&&(i=this.selObj.device),null!=i)if("combo"==i.type){var a=this.createComboActionTag(3,e.mode);w.a.sendComboAction(i,a)}else w.a.sendACAction(i,3)}},fanClick:function(e,t){if(e.isOn){document.getElementById("alarm").play(),e.fan=t,this.visibleFan=!1;var i=null;if(null!=this.device?(i=this.device,b.a.getTypeStatus()):null!=this.selObj&&(i=this.selObj.device),null!=i)if("combo"==i.type){var a=this.createComboActionTag(4,e.fan);w.a.sendComboAction(i,a)}else w.a.sendACAction(i,4)}},lockClick:function(e,t){if(document.getElementById("alarm").play(),e.lock=t,this.visibleLock=!1,"combo"==this.device.type){var i=this.createComboActionTag(5,e.lock);w.a.sendComboAction(this.device,i)}else w.a.sendACAction(this.device,5);b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},createComboActionTag:function(e,t){var i=t,a=0;"ac"==this.tabName?a=1:"heating"==this.tabName?a=2:"fan"==this.tabName&&(a=3),3==e&&("制冷"==t?i=1:"制热"==t?i=2:"送风"==t&&(i=3)),4==e&&(i=parseInt(t)),5==e&&(a=0,i=parseInt(t));var o={channel:a,paramindex:e,val:i};return null!=this.selObj&&(null==this.selObj.channels&&(this.selObj.channels=[]),-1==this.selObj.channels.indexOf(a)&&this.selObj.channels.push(a)),o},closeClick:function(){this.$emit("closeClick")},onSelectDevice:function(){this.$emit("onSelectedDevice",this.device)},init:function(){null!=this.selObj?(console.log("selObj"),this.selObj.device.type,this.lockObj=this.selObj.status.air,this.acObj=this.selObj.status.ac,this.airObj=this.selObj.status.air,this.heatObj=this.selObj.status.heat,"combo"==this.selObj.device.type||"ac"==this.selObj.device.type?this.tabName="ac":this.tabName=this.selObj.device.type):null!=this.device&&("combo"==this.device.type?(this.lockObj=this.device.air,this.acObj=this.device.ac,this.airObj=this.device.air,this.heatObj=this.device.heat):(this.lockObj=this.device,this.acObj=this.device,this.airObj=this.device,this.heatObj=this.device),"combo"==this.device.type||"ac"==this.device.type?this.tabName="ac":this.tabName=this.device.type),null!=this.airObj.fan&&0!=this.airObj||(this.airObj.fan=3)},setSelObj:function(e){console.log(this.device.type)}},mounted:function(){this.init()},watch:{device:function(e,t){this.init()}}},z={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),null!=e.device?i("div",{staticClass:"divDrawerACModeC",staticStyle:{position:"absolute",top:"57px",right:"20px"},on:{click:function(t){return e.closeClick()}}},[e._m(0)]):e._e(),e._v(" "),null!=e.device?i("div",{staticClass:"divDrawerACModeC",staticStyle:{position:"absolute",top:"57px",left:"20px"}},["/device"==e.$route.path?i("div",{staticClass:"btnDeviceAcFan",staticStyle:{"text-align":"right"},on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):i("el-popover",{attrs:{placement:"top",width:"50",trigger:"click","popper-class":"popoverAC"},model:{value:e.visibleLock,callback:function(t){e.visibleLock=t},expression:"visibleLock"}},[i("div",[i("span",{staticClass:"spanTitle"},[e._v("请选择")]),e._v(" "),i("ul",[i("li",{on:{click:function(t){return t.stopPropagation(),e.lockClick(e.lockObj,"0")}}},[i("i",{staticClass:"icon-unlock"}),i("span",[e._v("解锁")])]),e._v(" "),i("li",{on:{click:function(t){return t.stopPropagation(),e.lockClick(e.lockObj,"1")}}},[i("i",{staticClass:"icon-lock1"}),i("span",[e._v("锁定按键")])]),e._v(" "),i("li",{on:{click:function(t){return t.stopPropagation(),e.lockClick(e.lockObj,"2")}}},[i("i",{staticClass:"icon-data"}),i("span",[e._v("锁定数据")])])])]),e._v(" "),i("div",{staticClass:"btnDeviceAcFan",staticStyle:{"text-align":"right"},attrs:{slot:"reference"},slot:"reference"},[i("i",{class:0==e.lockObj.lock?"icon-unlock":1==e.lockObj.lock?"icon-lock1":"icon-data"})])])],1):e._e(),e._v(" "),"ac"==e.tabName?[null!=e.device?i("div",{staticClass:"divDrawerACTitle",on:{click:function(t){return e.onSelectDevice()}}},[i("span",{staticClass:"spanDrawerAC1"},[e._v(e._s(e.device.name))])]):e._e(),e._v(" "),i("div",{staticClass:"divDrawerAC",style:null!=e.selObj?"position:initial":""},[i("div",{staticClass:"divDrawerACScreen",style:null!=e.selObj?"margin-top:20px;margin-bottom:20px":""},[null==e.selObj?i("span",{staticClass:"spanDrawerAC2"},[e._v("当前温度"+e._s(null==e.device.actValue?e.device.value:e.device.actValue)+"℃")]):null!=e.selObj.device?i("span",{staticClass:"spanDrawerAC2"},[e._v("当前温度"+e._s(null==e.selObj.device.actValue?e.selObj.device.value:e.selObj.device.actValue)+"℃")]):e._e(),e._v(" "),null!=e.device?i("span",{staticClass:"spanDrawerAC3"},[e._v(e._s(e.acObj.mode))]):e._e(),e._v(" "),i("div",{staticClass:"divDrawerACTemperature"},[i("div",{staticClass:"divDrawerACTemperature1",on:{click:function(t){return t.stopPropagation(),e.minusClick(e.acObj)}}},[i("i",{staticClass:"icon-move1"})]),e._v(" "),i("div",{staticClass:"divDrawerACTemperature2"},[e._v(e._s(e.acObj.value)+e._s(null==e.device?"℃":""))]),e._v(" "),i("div",{staticClass:"divDrawerACTemperature3",on:{click:function(t){return t.stopPropagation(),e.addClick(e.acObj)}}},[i("i",{staticClass:"icon-add1"})])]),e._v(" "),null!=e.device?i("span",{staticClass:"spanDrawerAC4"},[e._v("℃")]):e._e()]),e._v(" "),i("div",{staticClass:"divDrawerACMode",style:null!=e.selObj?"margin-bottom:20px":""},[i("div",{staticClass:"divDrawerACModeC",staticStyle:{width:"25%"}},[i("el-popover",{attrs:{placement:"top",width:"50",trigger:"click","popper-class":"popoverAC",disabled:!e.acObj.isOn},model:{value:e.visibleFan,callback:function(t){e.visibleFan=t},expression:"visibleFan"}},[i("div",[i("span",{staticClass:"spanTitle"},[e._v("请选择风速")]),e._v(" "),i("ul",[i("li",{on:{click:function(t){return t.stopPropagation(),e.fanClick(e.acObj,"3")}}},[i("i",{staticClass:"icon-screw2"}),i("span",[e._v("高速")])]),e._v(" "),i("li",{on:{click:function(t){return t.stopPropagation(),e.fanClick(e.acObj,"2")}}},[i("i",{staticClass:"icon-screw"}),i("span",[e._v("中速")])]),e._v(" "),i("li",{on:{click:function(t){return t.stopPropagation(),e.fanClick(e.acObj,"1")}}},[i("i",{staticClass:"icon-propeller"}),i("span",[e._v("低速")])])])]),e._v(" "),i("el-button",{staticClass:"btnDeviceAcFan",attrs:{slot:"reference"},slot:"reference"},[i("i",{class:0==e.acObj.fan?"icon-abc":1==e.acObj.fan?"icon-propeller":2==e.acObj.fan?"icon-screw":"icon-screw2"})])],1)],1),e._v(" "),i("div",{staticStyle:{width:"25%"},on:{click:function(t){return t.stopPropagation(),e.modeClick(e.acObj,"制热")}}},[i("i",{staticClass:"icon-sun",class:{iconC:"制热"==e.acObj.mode&&e.acObj.isOn}})]),e._v(" "),i("div",{staticStyle:{width:"25%"},on:{click:function(t){return t.stopPropagation(),e.modeClick(e.acObj,"制冷")}}},[i("i",{staticClass:"icon-kongdiao",class:{iconC:"制冷"==e.acObj.mode&&e.acObj.isOn}})]),e._v(" "),i("div",{staticStyle:{width:"25%"},on:{click:function(t){return t.stopPropagation(),e.modeClick(e.acObj,"送风")}}},[i("i",{staticClass:"icon-fan",class:{iconC:"送风"==e.acObj.mode&&e.acObj.isOn}})])]),e._v(" "),i("div",{staticClass:"btnDrawerACSwitch",on:{click:function(t){return t.stopPropagation(),e.switchClick(e.acObj)}}},[i("i",{staticClass:"icon-ls_9_on",class:{iconC:e.acObj.isOn}})])])]:e._e(),e._v(" "),"heating"==e.tabName?[null!=e.device?i("div",{staticClass:"divDrawerACTitle",on:{click:function(t){return e.onSelectDevice()}}},[i("span",{staticClass:"spanDrawerAC1"},[e._v(e._s(e.device.name))]),e._v(" "),null!=e.selObj?i("span",{staticClass:"spanDrawerAC1"},[e._v(e._s(e.selObj.id))]):e._e()]):e._e(),e._v(" "),i("div",{staticClass:"divDrawerAC",style:null!=e.selObj?"position:initial":""},[i("div",{staticClass:"divDrawerACScreen",style:null!=e.selObj?"margin-top:20px;margin-bottom:20px":""},[null==e.selObj?i("span",{staticClass:"spanDrawerAC2"},[e._v("当前温度"+e._s(null==e.device.actValue?e.device.value:e.device.actValue)+"℃")]):null!=e.selObj.device?i("span",{staticClass:"spanDrawerAC2"},[e._v("当前温度"+e._s(null==e.selObj.device.actValue?e.selObj.device.value:e.selObj.device.actValue)+"℃")]):e._e(),e._v(" "),i("span",{staticClass:"spanDrawerAC3"},[e._v(" ")]),e._v(" "),i("div",{staticClass:"divDrawerACTemperature"},[i("div",{staticClass:"divDrawerACTemperature1",on:{click:function(t){return t.stopPropagation(),e.minusClick(e.heatObj)}}},[i("i",{staticClass:"icon-move1"})]),e._v(" "),i("div",{staticClass:"divDrawerACTemperature2"},[e._v(e._s(e.heatObj.value)+e._s(null==e.device?"℃":""))]),e._v(" "),i("div",{staticClass:"divDrawerACTemperature3",on:{click:function(t){return t.stopPropagation(),e.addClick(e.heatObj)}}},[i("i",{staticClass:"icon-add1"})])]),e._v(" "),null!=e.device?i("span",{staticClass:"spanDrawerAC4"},[e._v("℃")]):e._e()]),e._v(" "),i("div",{staticClass:"divDrawerACMode",style:null!=e.selObj?"margin-bottom:20px":""},[i("div",{staticClass:"divDrawerACModeC",staticStyle:{width:"25%"}},[e._v(" ")]),e._v(" "),i("div",{staticStyle:{width:"25%"}},[e._v(" ")]),e._v(" "),i("div",{staticStyle:{width:"25%"}},[e._v(" ")]),e._v(" "),i("div",{staticStyle:{width:"25%"}},[e._v(" ")])]),e._v(" "),i("div",{staticClass:"btnDrawerACSwitch",on:{click:function(t){return t.stopPropagation(),e.switchClick(e.heatObj)}}},[i("i",{staticClass:"icon-ls_9_on",class:{iconC:e.heatObj.isOn}})])])]:e._e(),e._v(" "),"fan"==e.tabName?[null!=e.device?i("div",{staticClass:"divDrawerACTitle",on:{click:function(t){return e.onSelectDevice()}}},[i("span",{staticClass:"spanDrawerAC1"},[e._v(e._s(e.device.name))])]):e._e(),e._v(" "),i("div",{staticClass:"divDrawerAC",style:null!=e.selObj?"position:initial":""},[i("div",{staticClass:"divDrawerACScreen",style:null!=e.selObj?"margin-top:20px;margin-bottom:20px":""},[i("span",{staticClass:"spanDrawerAC2"}),e._v(" "),i("span",{staticClass:"spanDrawerAC3"}),e._v(" "),i("div",{staticClass:"divDrawerACTemperature"}),e._v(" "),i("span",{staticClass:"spanDrawerAC4"})]),e._v(" "),i("div",{staticClass:"divDrawerACMode"},[i("div",{staticStyle:{width:"33%"},on:{click:function(t){return t.stopPropagation(),e.fanClick(e.airObj,3)}}},[i("i",{staticClass:"icon-screw2",class:{iconC:3==e.airObj.fan&&e.airObj.isOn}})]),e._v(" "),i("div",{staticStyle:{width:"33%"},on:{click:function(t){return t.stopPropagation(),e.fanClick(e.airObj,2)}}},[i("i",{staticClass:"icon-screw",class:{iconC:2==e.airObj.fan&&e.airObj.isOn}})]),e._v(" "),i("div",{staticStyle:{width:"33%"},on:{click:function(t){return t.stopPropagation(),e.fanClick(e.airObj,1)}}},[i("i",{staticClass:"icon-propeller",class:{iconC:1==e.airObj.fan&&e.airObj.isOn}})])]),e._v(" "),i("div",{staticClass:"btnDrawerACSwitch",on:{click:function(t){return t.stopPropagation(),e.switchClick(e.airObj)}}},[i("i",{staticClass:"icon-ls_9_on",class:{iconC:e.airObj.isOn}})])])]:e._e(),e._v(" "),null!=e.device&&"combo"==e.device.type||null!=e.selObj&&null!=e.selObj.device&&"combo"==e.selObj.device.type?i("div",{staticClass:"divDrawerRadio",style:null!=e.selObj?"position:initial;margin-top:30px":""},[i("el-radio-group",{model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[i("el-radio-button",{attrs:{label:"heating"}},[e._v("地暖")]),e._v(" "),i("el-radio-button",{attrs:{label:"ac"}},[e._v("空调")]),e._v(" "),i("el-radio-button",{attrs:{label:"fan"}},[e._v("新风")])],1)],1):e._e()],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btnDeviceAcFan"},[t("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"20px","line-height":"28px",color:"#ffffff"}})])}]},q=i("VU/8")(K,z,!1,null,null,null).exports,J={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-64,visibleFan:!1,visibleLock:!1,loop:null,dialogVisible:!1}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},actionStatus:{type:Object,default:{ac:{fan:0,isOn:!1,mode:"制冷",value:26},air:{fan:0,isOn:!1},heat:{isOn:!1,value:26}}}},components:{DesignLoginContent:W,ACPanel:q},methods:{getClassIconC:function(){return this.isSelected?this.actionStatus.ac.isOn?"iconC ":"":this.device.isOn?"iconC ":""},getValue:function(){return this.isSelected?this.actionStatus.ac.value:this.device.value},favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){document.getElementById("alarm").play(),e.isOn=!e.isOn,b.a.getTypeStatus(),w.a.sendACAction(this.device,1),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},addClick:function(e){e.value<30&&e.isOn&&(document.getElementById("alarm").play(),e.value=e.value+1,e.summary=e.mode+" "+e.value+"℃",w.a.sendACAction(this.device,2),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1))},minusClick:function(e){e.value>16&&e.isOn&&(document.getElementById("alarm").play(),e.value=e.value-1,e.summary=e.mode+" "+e.value+"℃",w.a.sendACAction(this.device,2),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1))},drawerClick:function(){"CONTROL"==this.mode?this.drawer=!0:"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},modeClick:function(e,t){e.isOn&&(document.getElementById("alarm").play(),e.mode=t,e.summary=e.mode+" "+e.value+"℃",w.a.sendACAction(this.device,3),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1))},fanClick:function(e,t){document.getElementById("alarm").play(),e.fan=t,this.visibleFan=!1,w.a.sendACAction(this.device,4),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},lockClick:function(e,t){document.getElementById("alarm").play(),e.lock=t,this.visibleLock=!1,w.a.sendACAction(this.device,5),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){console.log("long tap"),this.$refs.DesignLoginContent.show()},closeClick:function(){this.drawer=!1},closeDrawer:function(){this.$emit("onClosed","")}},mounted:function(){this.device.summary=this.device.mode+" "+this.device.value+"℃"}},Q={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":"",on:{click:function(t){return e.drawerClick()}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:""!=e.device.icon?"":"margin-left:15px;"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:"divIcon "+e.getClassIconC(),on:{touchstart:function(t){return e.start(e.device)},touchend:function(t){return e.end(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameOther"+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(e.getValue())+"℃")])]),e._v(" "),i("div",{staticClass:"divControl"},[i("div",{staticClass:"btnAC",staticStyle:{width:"24%"},on:{click:function(t){return t.stopPropagation(),e.minusClick(e.device)}}},[i("i",{staticClass:"el-icon-minus",staticStyle:{"font-weight":"bolder","font-size":"0.9em"}})]),e._v(" "),i("div",{class:"btnAC "+e.getClassIconC(),staticStyle:{width:"52%"},on:{click:function(t){return t.stopPropagation(),e.switchClick(e.device)}}},[i("i",{staticClass:"icon-ls_9_on"})]),e._v(" "),i("div",{staticClass:"btnAC",staticStyle:{width:"24%"},on:{click:function(t){return t.stopPropagation(),e.addClick(e.device)}}},[i("i",{staticClass:"icon-add",staticStyle:{"font-weight":"bolder","font-size":"1em"}})])]),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px",withHeader:!1,modal:!1},on:{"update:visible":function(t){e.drawer=t},close:function(t){return e.closeDrawer()}}},[i("ACPanel",{ref:"acpanel",attrs:{golbal:e.golbal,device:e.device,mode:e.mode},on:{closeClick:e.closeClick}})],1),e._v(" "),i("DesignLoginContent",{ref:"DesignLoginContent",attrs:{visiable:e.dialogVisible,device:e.device}})],1)},staticRenderFns:[]},Z=i("VU/8")(J,Q,!1,null,null,null).exports,X={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-64,visibleFan:!1,visibleLock:!1,tabName:"ac",loop:null,dialogVisible:!1,acObj:{},airObj:{},heatObj:{},dev:{}}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},actionStatus:{type:Object,default:{ac:{fan:0,isOn:!1,mode:"制冷",value:26},air:{fan:0,isOn:!1},heat:{isOn:!1,value:26}}}},components:{DesignLoginContent:W,ACPanel:q},methods:{getClassIconC:function(){return this.isSelected?this.actionStatus.ac.isOn||this.actionStatus.air.isOn||this.actionStatus.heat.isOn?"iconC ":"":this.dev.isOn?"iconC ":""},getValue:function(){return this.isSelected?this.actionStatus.ac.value:this.dev.value},favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){if("CONTROL"==this.mode){document.getElementById("alarm").play(),e.isOn=!e.isOn,b.a.getTypeStatus();var t=this.createComboActionTag(1,e.isOn?1:0);w.a.sendComboAction(this.device,t),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)}else"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},addClick:function(e){if(e.value<30&&e.isOn){document.getElementById("alarm").play(),e.value=e.value+1,e.summary=e.mode+" "+e.value+"℃";var t=this.createComboActionTag(2,e.value);w.a.sendComboAction(this.device,t),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)}},minusClick:function(e){if(e.value>16&&e.isOn){document.getElementById("alarm").play(),e.value=e.value-1,e.summary=e.mode+" "+e.value+"℃";var t=this.createComboActionTag(2,e.value);w.a.sendComboAction(this.device,t),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)}},drawerClick:function(e){"CONTROL"==this.mode?this.drawer=!0:"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},modeClick:function(e,t){if(e.isOn){document.getElementById("alarm").play(),e.mode=t,e.summary=e.mode+" "+e.value+"℃";var i=this.createComboActionTag(3,e.mode);w.a.sendComboAction(this.device,i),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)}},fanClick:function(e,t){document.getElementById("alarm").play(),e.fan=t,this.visibleFan=!1;var i=this.createComboActionTag(4,e.fan);w.a.sendComboAction(this.device,i),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},lockClick:function(e,t){document.getElementById("alarm").play(),e.lock=t,this.visibleLock=!1;var i=this.createComboActionTag(5,e.lock);w.a.sendComboAction(this.device,i),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},createComboActionTag:function(e,t){var i=t,a=0;return"ac"==this.tabName?a=1:"heat"==this.tabName?a=2:"air"==this.tabName&&(a=3),3==e&&("制冷"==t?i=1:"制热"==t?i=2:"送风"==t&&(i=3)),4==e&&(i=parseInt(t)),5==e&&(a=0,i=parseInt(t)),{channel:a,paramindex:e,val:i}},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){console.log("long tap"),this.$refs.DesignLoginContent.show()},radioChange:function(){console.log(this.tabName),"ac"==this.tabName?this.dev=this.device.ac:"heating"==this.tabName?this.dev=this.device.heat:"fan"==this.tabName&&(this.dev=this.device.air)},closeClick:function(){this.drawer=!1},closeDrawer:function(){this.$emit("onClosed","")}},mounted:function(){null!=this.device&&"combo"==this.device.type&&(this.dev=this.device.ac,this.tabName="ac"),null!=this.actionStatus&&(this.dev=this.actionStatus.ac,this.tabName="ac"),null!=this.airObj.fan&&0!=this.airObj||(this.airObj.fan=3)}},ee={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":"",on:{click:function(t){return e.drawerClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:""!=e.device.icon?"":"margin-left:15px;"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:"divIcon "+e.getClassIconC(),on:{touchstart:function(t){return e.start(e.device)},touchend:function(t){return e.end(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameOther "+e.getClassIconC()+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(e.getValue())+"℃")])]),e._v(" "),i("div",{staticClass:"divControl"},[i("div",{staticClass:"btnAC",staticStyle:{width:"24%"},on:{click:function(t){return t.stopPropagation(),e.minusClick(e.dev)}}},[i("i",{staticClass:"el-icon-minus",staticStyle:{"font-weight":"bolder","font-size":"0.9em"}})]),e._v(" "),i("div",{class:"btnAC "+e.getClassIconC(),staticStyle:{width:"52%"},on:{click:function(t){return t.stopPropagation(),e.switchClick(e.dev)}}},[i("i",{staticClass:"icon-ls_9_on"})]),e._v(" "),i("div",{staticClass:"btnAC",staticStyle:{width:"24%"},on:{click:function(t){return t.stopPropagation(),e.addClick(e.dev)}}},[i("i",{staticClass:"icon-add",staticStyle:{"font-weight":"bolder","font-size":"1em"}})])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\r\n            "+e._s(e.device.areacode+"-"+e.device.addr)+"\r\n        ")]):e._e(),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px",withHeader:!1,modal:!1},on:{"update:visible":function(t){e.drawer=t},close:function(t){return e.closeDrawer()}}},[i("ACPanel",{attrs:{golbal:e.golbal,device:e.device,mode:e.mode},on:{closeClick:e.closeClick}})],1)],1)},staticRenderFns:[]},te=i("VU/8")(X,ee,!1,null,null,null).exports,ie={data:function(){var e=this;return{loop:null,dialogVisible:!1,typeCode:function(){var t=e.device.deviceType;switch(null==t&&(t=e.device.type),t){case"light":return"L";case"dimmer":return"D";case"module_light":return"L";case"module_dimmer":return"D";case"curtain":case"process_curtain":return"C";case"scene":return"S";default:return""}}}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},isCondition:{type:!1,default:!1},actionStatus:{type:Object,default:function(){return{value:!1}}}},methods:{favoriteClick:function(e){console.log("fav"),document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){"CONTROL"==this.mode?null==e.isSwitch||e.isSwitch?(document.getElementById("alarm").play(),e.isOn=!e.isOn,b.a.getTypeStatus(),w.a.sendAction(e)):(document.getElementById("alarm").play(),e.isOn=!0,w.a.sendAction(e),setTimeout(function(){e.isOn=!1},250)):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))}}},ae={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:(e.isSelected?"divDeviceSelect":e.isCondition?"divDeviceCondition":"")+" divDevice",on:{click:function(t){return e.switchClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopScene"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:"line-height:24px;"+(""!=e.device.icon?"":"margin-right:62px;"),on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:(e.device.isOn?"iconC ":"")+"divIcon"},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameScene"+(e.device.isOn?" iconC ":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\r\n        "+e._s(e.device.areacode+"-"+e.device.addr+"-"+e.typeCode()+e.device.channel)+"\r\n    ")]):e._e()])},staticRenderFns:[]};var oe=i("VU/8")(ie,ae,!1,function(e){i("dKju")},"data-v-1b76e523",null).exports,se={data:function(){return{loop:null,dialogVisible:!1}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}}},methods:{favoriteClick:function(e){console.log("fav"),document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(){"CONTROL"==this.mode?this.$emit("onClick",this.device):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device.devices[0]))}}},ne={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice",on:{click:function(t){return e.switchClick()}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{class:"divDevTopScene"},[i("div",{class:(e.device.isOn?"iconC ":"")+"divIcon"},[i("i",{class:"MODULE"==e.device.type?"icon-ls_module":"icon-ls_panel"})]),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameScene"+(e.device.isOn?" iconC ":"")+" spanDeviceNameIcon"},[e._v(e._s(e.device.name))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\r\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\r\n    ")]):e._e()])},staticRenderFns:[]};var le=i("VU/8")(se,ne,!1,function(e){i("oSA3")},"data-v-054c9d3a",null).exports,ce={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-64,visibleLock:!1,loop:null,dialogVisible:!1}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},actionStatus:{type:Object,default:{ac:{fan:0,isOn:!1,mode:"制冷",value:26},air:{fan:0,isOn:!1},heat:{isOn:!1,value:26}}}},components:{DesignLoginContent:W,ACPanel:q},methods:{getClassIconC:function(){return this.isSelected?this.actionStatus.heat.isOn?"iconC ":"":this.device.isOn?"iconC ":""},getValue:function(){return this.isSelected?this.actionStatus.heat.value:this.device.value},favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){document.getElementById("alarm").play(),e.isOn=!e.isOn,b.a.getTypeStatus(),w.a.sendACAction(this.device,1),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device)},addClick:function(e){e.value<36&&e.isOn&&(document.getElementById("alarm").play(),e.value=e.value+1,e.summary=(null==e.mode?"":e.mode+" ")+e.value+"℃",w.a.sendACAction(this.device,2),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device))},minusClick:function(e){e.value>17&&e.isOn&&(document.getElementById("alarm").play(),e.value=e.value-1,e.summary=(null==e.mode?"":e.mode+" ")+e.value+"℃",w.a.sendACAction(this.device,2),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device))},drawerClick:function(e){"CONTROL"==this.mode?(document.getElementById("alarm").play(),this.drawer=!0):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},lockClick:function(e,t){document.getElementById("alarm").play(),e.lock=t,this.visibleLock=!1,w.a.sendAction(this.device),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device)},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){console.log("long tap"),this.$refs.DesignLoginContent.show()},closeClick:function(){this.drawer=!1},closeDrawer:function(){this.$emit("onClosed","")}},mounted:function(){}},re={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":"",on:{click:function(t){return e.drawerClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:""!=e.device.icon?"":"margin-left:15px;"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:"divIcon "+e.getClassIconC(),on:{touchstart:function(t){return e.start(e.device)},touchend:function(t){return e.end(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameOther"+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(e.getValue())+"℃")])]),e._v(" "),i("div",{staticClass:"divControl"},[i("div",{staticClass:"btnAC",staticStyle:{width:"24%"},on:{click:function(t){return t.stopPropagation(),e.minusClick(e.device)}}},[i("i",{staticClass:"el-icon-minus",staticStyle:{"font-weight":"bolder","font-size":"0.9em"}})]),e._v(" "),i("div",{class:"btnAC "+e.getClassIconC(),staticStyle:{width:"52%"},on:{click:function(t){return t.stopPropagation(),e.switchClick(e.device)}}},[i("i",{staticClass:"icon-ls_9_on"})]),e._v(" "),i("div",{staticClass:"btnAC",staticStyle:{width:"24%"},on:{click:function(t){return t.stopPropagation(),e.addClick(e.device)}}},[i("i",{staticClass:"icon-add",staticStyle:{"font-weight":"bolder","font-size":"1em"}})])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\r\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\r\n    ")]):e._e(),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px",withHeader:!1,modal:!1},on:{"update:visible":function(t){e.drawer=t},close:function(t){return e.closeDrawer()}}},[i("ACPanel",{attrs:{golbal:e.golbal,device:e.device},on:{closeClick:e.closeClick}})],1),e._v(" "),i("DesignLoginContent",{ref:"DesignLoginContent",attrs:{visiable:e.dialogVisible,device:e.device}})],1)},staticRenderFns:[]},ue=i("VU/8")(ce,re,!1,null,null,null).exports,de={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-64,visibleFan:!1,visibleLock:!1,loop:null,dialogVisible:!1,timer:null}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},actionStatus:{type:Object,default:{ac:{fan:0,isOn:!1,mode:"制冷",value:26},air:{fan:0,isOn:!1},heat:{isOn:!1,value:26}}}},components:{DesignLoginContent:W,ACPanel:q},methods:{getClassIconC:function(){return this.isSelected?this.actionStatus.air.isOn?"iconC ":"":this.device.isOn?"iconC ":""},favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){document.getElementById("alarm").play(),e.isOn=!e.isOn,b.a.getTypeStatus(),w.a.sendACAction(this.device,1),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},addClick:function(e){e.value<36&&e.isOn&&(document.getElementById("alarm").play(),e.value=e.value+1,e.summary=e.mode+" "+e.value+"℃",w.a.sendACAction(this.device,2),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1))},minusClick:function(e){e.value>17&&e.isOn&&(document.getElementById("alarm").play(),e.value=e.value-1,e.summary=e.mode+" "+e.value+"℃",w.a.sendACAction(this.device,2),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1))},drawerClick:function(e){"CONTROL"==this.mode?(document.getElementById("alarm").play(),this.drawer=!0):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},fanClick:function(e,t){document.getElementById("alarm").play(),e.fan=t,this.visibleFan=!1,w.a.sendAction(this.device),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},lockClick:function(e,t){document.getElementById("alarm").play(),e.lock=t,this.visibleLock=!1,w.a.sendAction(this.device),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){console.log("long tap"),this.$refs.DesignLoginContent.show()},timerTick:function(){this.$refs.ACPanel.$forceUpdate()},drawerOpened:function(){this.timer=setInterval(this.timerTick,1e3)},drawerClosed:function(){null!=this.timer&&clearInterval(this.timer)},closeClick:function(){this.drawer=!1},closeDrawer:function(){this.$emit("onClosed","")}},mounted:function(){}},me={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":"",on:{click:function(t){return e.drawerClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:""!=e.device.icon?"":"margin-left:15px;"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:"divIcon "+e.getClassIconC(),on:{touchstart:function(t){return e.start(e.device)},touchend:function(t){return e.end(e.device)},click:function(t){return e.switchClick(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameOther"+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))])]),e._v(" "),i("div",{staticClass:"divControl"},[i("div",{staticClass:"btnAC",on:{click:function(t){return t.stopPropagation(),e.fanClick(e.device,"3")}}},[i("i",{staticClass:"icon-screw2"})]),e._v(" "),i("div",{class:"btnAC "+e.getClassIconC(),staticStyle:{"font-size":"1.2em"},on:{click:function(t){return t.stopPropagation(),e.switchClick(e.device)}}},[i("i",{staticClass:"icon-switch"})]),e._v(" "),i("div",{staticClass:"btnAC",on:{click:function(t){return t.stopPropagation(),e.fanClick(e.device,"2")}}},[i("i",{staticClass:"icon-screw"})])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\r\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\r\n    ")]):e._e(),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px",withHeader:!1,modal:!1},on:{"update:visible":function(t){e.drawer=t},close:function(t){return e.closeDrawer()}}},[i("ACPanel",{attrs:{golbal:e.golbal,device:e.device,mode:e.mode},on:{closeClick:e.closeClick}})],1)],1)},staticRenderFns:[]},he=i("VU/8")(de,me,!1,null,null,null).exports,ve=(i("Jg0P"),i("g3Gj"),{data:function(){return{isInited:!1,drawer:!1,direction:"btt"}},props:["device","golbal","mode"],components:{},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},drawerClick:function(e){if(document.getElementById("alarm").play(),"CONTROL"==this.mode){"YING_SHI"==e.brand?"undefined"!=typeof YSHelper?YSHelper.openCamera(e.deviceSerial,this.golbal.camera.ys_token,this.golbal.camera.ys_appkey,function(e){console.log(e)},function(e){console.log(e)}):console.log("camera tap"):(console.log(e.brand),this.$router.push({name:"camera",params:{device:e}}))}else"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},drawerOpened:function(e){console.log("opened"),this.isInited||(console.log(this.device),this.isInited=!0)},ptzUp:function(){this._cur_dirt=this.PTZ_DIRT.UP,this.ptzStart(this.PTZ_DIRT.UP),console.log("up")},ptzDown:function(){this._cur_dirt=this.PTZ_DIRT.DOWN,this.ptzStart(this.PTZ_DIRT.DOWN),console.log("down")},ptzLeft:function(){this._cur_dirt=this.PTZ_DIRT.LEFT,this.ptzStart(this.PTZ_DIRT.LEFT),console.log("left")},ptzRight:function(){this._cur_dirt=this.PTZ_DIRT.RIGHT,this.ptzStart(this.PTZ_DIRT.RIGHT),console.log("right")},ptzStop:function(){var e={action:"APP_PTZ_STOP"};e.dirt=this._cur_dirt,e.deviceSerial=this.device.deviceSerial,p()({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(e)),header:{"Content-Type":"application/jsonp"}}).then(function(e){console.log(e.data)}).catch(function(e){console.log(e)}),console.log("stop")},ptzStart:function(e){var t={action:"APP_PTZ_START"};t.dirt=e,t.deviceSerial=this.device.deviceSerial,p()({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(t)),header:{"Content-Type":"application/jsonp"}}).then(function(e){console.log(e.data)}).catch(function(e){console.log(e)})},securitySetup:function(){var e={action:"APP_SECURITY_SETUP"};e.deviceSerial=this.device.deviceSerial,p()({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(e)),header:{"Content-Type":"application/jsonp"}}).then(function(e){console.log(e.data)}).catch(function(e){console.log(e)}),console.log("security setup")},securityRemove:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).action="APP_SECURITY_REMOVE",i.deviceSerial=e.device.deviceSerial,t.next=5,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 5:a=t.sent,console.log(a.data),console.log("security remove");case 8:case"end":return t.stop()}},t,e)}))()},refreshAccessToken:function(){var e=this,t={action:"APP_GET_YS_ACCESS_TOKEN"};p()({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(t)),header:{"Content-Type":"application/jsonp"}}).then(function(t){e.device.accessToken=t.data.accessToken,console.log(t.data),console.log("new accessToken:"+e.device.accessToken)}).catch(function(e){console.log(e)})}},mounted:function(){}}),pe={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice"},[i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopScene",on:{click:function(t){return e.drawerClick(e.device)}}},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{staticClass:"divIcon",attrs:{tag:"div"}},[i("i",{class:e.device.icon})]):e._e(),e._v(" "),i("div",{staticClass:"spanDeviceName spanDeviceNameScene",style:"/device"==e.$route.path?""!=e.device.icon?"width:16vw":"width:25vw":""!=e.device.icon?"":"width:30vw"},[e._v(e._s(null==e.device.panel_name||0==e.device.panel_name.length?"视频监控":e.device.panel_name))])])])},staticRenderFns:[]},ge=i("VU/8")(ve,pe,!1,null,null,null).exports,fe={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-110,tabpage:1,selectedKey:""}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},arr_command:{type:Array,default:function(){return[]}}},methods:{tabClick:function(e){document.getElementById("alarm").play(),this.tabpage=e},keyClick:function(e){if(document.getElementById("alarm").play(),"CONTROL"==this.mode)w.a.sendRemoteAction(this.device,e),this.selectedKey="";else if("SELECT"==this.mode){console.log(e);for(var t=null,i=0;i<this.device.keyMaps.length;i++)this.device.keyMaps[i].val==e&&(t=this.device.keyMaps[i]);if(null==t)return;if(null==t.cmd||0==t.cmd.length)return;var a={name:A.a.OPTIONS_REMOTE_MAP[e],cmd:t.cmd};console.log(a),this.$emit("onSelectedCustom",this.device,a)}},keyDown:function(e){"CONTROL"==this.mode&&(this.selectedKey=e)},isSelected:function(e){for(var t="",i=0;i<this.device.keyMaps.length;i++)this.device.keyMaps[i].val==e&&(t=this.device.keyMaps[i].cmd);if(""==t)return!1;for(i=0;i<this.arr_command.length;i++)if(this.arr_command[i]==t)return!0;return!1}},mounted:function(){}},be={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"divDrawerACTitle",staticStyle:{top:"37px"}},[i("span",{staticClass:"spanDrawerAC1"},[e._v(e._s(e.device.name))])]),e._v(" "),i("div",{staticClass:"divDrawerRemote"},[i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_on"==e.selectedKey||e.isSelected("key_on")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_on")},touchstart:function(t){return e.keyDown("key_on")}}},[i("i",{staticClass:"icon-ls_38_on",staticStyle:{"font-size":"1.3em"}})]),e._v(" "),i("div",{class:"btn center"+("pause"==e.selectedKey||e.isSelected("pause")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("pause")},touchstart:function(t){return e.keyDown("pause")}}},[i("i",{staticClass:"icon-pause2"})]),e._v(" "),i("div",{class:"btn right"+("key_off"==e.selectedKey||e.isSelected("key_off")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_off")},touchstart:function(t){return e.keyDown("key_off")}}},[i("i",{staticClass:"icon-ls_39_off",staticStyle:{"font-size":"1.3em"}})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("channel_up"==e.selectedKey||e.isSelected("channel_up")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("channel_up")},touchstart:function(t){return e.keyDown("channel_up")}}},[i("i",{staticClass:"icon-arrow2_up"})]),e._v(" "),i("div",{class:"btn center"+("play"==e.selectedKey||e.isSelected("play")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("play")},touchstart:function(t){return e.keyDown("play")}}},[i("i",{staticClass:"icon-play3"})]),e._v(" "),i("div",{class:"btn right"+("vol_up"==e.selectedKey||e.isSelected("vol_up")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("vol_up")},touchstart:function(t){return e.keyDown("vol_up")}}},[i("i",{staticClass:"icon-plus"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("channel_down"==e.selectedKey||e.isSelected("channel_down")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("channel_down")},touchstart:function(t){return e.keyDown("channel_down")}}},[i("i",{staticClass:"icon-arrow2_down"})]),e._v(" "),i("div",{class:"btn center"+("silen"==e.selectedKey||e.isSelected("silen")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("silen")},touchstart:function(t){return e.keyDown("silen")}}},[i("i",{staticClass:"icon-volume-mute2"})]),e._v(" "),i("div",{class:"btn right"+("vol_down"==e.selectedKey||e.isSelected("vol_down")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("vol_down")},touchstart:function(t){return e.keyDown("vol_down")}}},[i("i",{staticClass:"icon-minus"})])]),e._v(" "),i("div",{staticClass:"row rowSpace"},[i("table",{attrs:{cellpadding:"0",cellspacing:"0"}},[i("tr",[i("td",{class:1==e.tabpage?"active":"",staticStyle:{width:"50%"},on:{click:function(t){return e.tabClick(1)}}},[e._v("123")]),e._v(" "),i("td",{class:2==e.tabpage?"active":"",staticStyle:{width:"50%"},on:{click:function(t){return e.tabClick(2)}}},[e._v("菜单")])])])]),e._v(" "),1==e.tabpage?i("div",[i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_1"==e.selectedKey||e.isSelected("key_1")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_1")},touchstart:function(t){return e.keyDown("key_1")}}},[e._v("1")]),e._v(" "),i("div",{class:"btn center"+("key_2"==e.selectedKey||e.isSelected("key_2")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_2")},touchstart:function(t){return e.keyDown("key_2")}}},[e._v("2")]),e._v(" "),i("div",{class:"btn right"+("key_3"==e.selectedKey||e.isSelected("key_3")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_3")},touchstart:function(t){return e.keyDown("key_3")}}},[e._v("3")])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_4"==e.selectedKey||e.isSelected("key_4")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_4")},touchstart:function(t){return e.keyDown("key_4")}}},[e._v("4")]),e._v(" "),i("div",{class:"btn center"+("key_5"==e.selectedKey||e.isSelected("key_5")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_5")},touchstart:function(t){return e.keyDown("key_5")}}},[e._v("5")]),e._v(" "),i("div",{class:"btn right"+("key_6"==e.selectedKey||e.isSelected("key_6")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_6")},touchstart:function(t){return e.keyDown("key_6")}}},[e._v("6")])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_7"==e.selectedKey||e.isSelected("key_7")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_7")},touchstart:function(t){return e.keyDown("key_7")}}},[e._v("7")]),e._v(" "),i("div",{class:"btn center"+("key_8"==e.selectedKey||e.isSelected("key_8")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_8")},touchstart:function(t){return e.keyDown("key_8")}}},[e._v("8")]),e._v(" "),i("div",{class:"btn right"+("key_9"==e.selectedKey||e.isSelected("key_9")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_9")},touchstart:function(t){return e.keyDown("key_9")}}},[e._v("9")])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_fav"==e.selectedKey||e.isSelected("key_fav")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_fav")},touchstart:function(t){return e.keyDown("key_fav")}}},[i("i",{staticClass:"icon-heart"})]),e._v(" "),i("div",{class:"btn center"+("key_0"==e.selectedKey||e.isSelected("key_0")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_0")},touchstart:function(t){return e.keyDown("key_0")}}},[e._v("0")]),e._v(" "),i("div",{class:"btn right"+("key_back"==e.selectedKey||e.isSelected("key_back")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_back")},touchstart:function(t){return e.keyDown("key_back")}}},[i("i",{staticClass:"icon-undo2"})])])]):e._e(),e._v(" "),2==e.tabpage?i("div",[i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_menu"==e.selectedKey||e.isSelected("key_menu")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_menu")},touchstart:function(t){return e.keyDown("key_menu")}}},[i("i",{staticClass:"icon-category"})]),e._v(" "),i("div",{class:"btn center"+("key_up"==e.selectedKey||e.isSelected("key_up")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_up")},touchstart:function(t){return e.keyDown("key_up")}}},[i("i",{staticClass:"icon-arrow2_up"})]),e._v(" "),i("div",{class:"btn right"+("key_home"==e.selectedKey||e.isSelected("key_home")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_home")},touchstart:function(t){return e.keyDown("key_home")}}},[i("i",{staticClass:"icon-home1"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_left"==e.selectedKey||e.isSelected("key_left")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_left")},touchstart:function(t){return e.keyDown("key_left")}}},[i("i",{staticClass:"icon-arrow2_left"})]),e._v(" "),i("div",{class:"btn center"+("key_ok"==e.selectedKey||e.isSelected("key_ok")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_ok")},touchstart:function(t){return e.keyDown("key_ok")}}},[e._v("OK")]),e._v(" "),i("div",{class:"btn right"+("key_right"==e.selectedKey||e.isSelected("key_right")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_right")},touchstart:function(t){return e.keyDown("key_right")}}},[i("i",{staticClass:"icon-arrow2_right"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_return"==e.selectedKey||e.isSelected("key_return")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_return")},touchstart:function(t){return e.keyDown("key_return")}}},[i("i",{staticClass:"icon-arrow-left2"})]),e._v(" "),i("div",{class:"btn center"+("key_down"==e.selectedKey||e.isSelected("key_down")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_down")},touchstart:function(t){return e.keyDown("key_down")}}},[i("i",{staticClass:"icon-arrow2_down"})]),e._v(" "),i("div",{class:"btn right"+("key_exit"==e.selectedKey||e.isSelected("key_exit")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_exit")},touchstart:function(t){return e.keyDown("key_exit")}}},[i("i",{staticClass:"icon-exit"})])])]):e._e()])])},staticRenderFns:[]};var _e=i("VU/8")(fe,be,!1,function(e){i("DE+Y")},"data-v-d6c7e698",null).exports,ye={components:{RemoteTVPanel:_e},data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-110,tabpage:1}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},isSelected:{type:Boolean,default:!1},isCondition:{type:Boolean,default:!1}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},drawerClick:function(){document.getElementById("alarm").play(),"CONTROL"==this.mode?this.drawer=!0:"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},tabClick:function(e){document.getElementById("alarm").play(),this.tabpage=e},keyClick:function(e){document.getElementById("alarm").play(),w.a.sendRemoteAction(this.device,e)}},mounted:function(){}},Ce={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:(e.isSelected?"divDeviceSelect":e.isCondition?"divDeviceCondition":"")+" divDevice",on:{click:function(t){return e.drawerClick(e.device)}}},[i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopScene"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:"line-height:24px;"+(""!=e.device.icon?"":"margin-right:62px;"),on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:(e.device.isOn?"iconC ":"")+"divIcon"},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameScene"+(e.device.isOn?" iconC ":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\n    ")]):e._e(),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px"},on:{"update:visible":function(t){e.drawer=t}}},[i("RemoteTVPanel",{attrs:{device:e.device,mode:e.mode}})],1)],1)},staticRenderFns:[]};var ke=i("VU/8")(ye,Ce,!1,function(e){i("MJmh")},"data-v-146aa086",null).exports,Ee={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-110,tabpage:1,selectedKey:""}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},arr_command:{type:Array,default:function(){return[]}}},methods:{tabClick:function(e){document.getElementById("alarm").play(),this.tabpage=e},keyClick:function(e){if(document.getElementById("alarm").play(),"CONTROL"==this.mode)w.a.sendRemoteAction(this.device,e),this.selectedKey="";else if("SELECT"==this.mode){console.log(e);for(var t=null,i=0;i<this.device.keyMaps.length;i++)this.device.keyMaps[i].val==e&&(t=this.device.keyMaps[i]);if(null==t)return;if(null==t.cmd||0==t.cmd.length)return;var a={name:A.a.OPTIONS_REMOTE_MAP[e],cmd:t.cmd};this.$emit("onSelectedCustom",this.device,a)}},keyDown:function(e){"CONTROL"==this.mode&&(this.selectedKey=e)},isSelected:function(e){for(var t="",i=0;i<this.device.keyMaps.length;i++)this.device.keyMaps[i].val==e&&(t=this.device.keyMaps[i].cmd);if(""==t)return!1;for(i=0;i<this.arr_command.length;i++)if(this.arr_command[i]==t)return!0;return!1}},mounted:function(){}},Te={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"divDrawerACTitle",staticStyle:{top:"37px"}},[i("span",{staticClass:"spanDrawerAC1"},[e._v(e._s(e.device.name))])]),e._v(" "),i("div",{staticClass:"divDrawerRemote"},[i("div",{staticClass:"row"},[i("div",{class:"btn left"+("vol_p"==e.selectedKey||e.isSelected("vol_p")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("vol_p")}}},[i("i",{staticClass:"icon-plus"})]),e._v(" "),i("div",{class:"btn center"+("power"==e.selectedKey||e.isSelected("power")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("power")}}},[i("i",{staticClass:"icon-switch"})]),e._v(" "),i("div",{class:"btn right"+("vol_m"==e.selectedKey||e.isSelected("vol_m")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("vol_m")}}},[i("i",{staticClass:"icon-minus"})])]),e._v(" "),i("div",{staticClass:"row",staticStyle:{"margin-top":"50px"}},[i("div",{class:"btn left"+("sun"==e.selectedKey||e.isSelected("sun")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("sun")}}},[i("i",{staticClass:"icon-sun"})]),e._v(" "),i("div",{class:"btn center"+("snow"==e.selectedKey||e.isSelected("snow")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("snow")}}},[i("i",{staticClass:"icon-kongdiao"})]),e._v(" "),i("div",{class:"btn right"+("fan"==e.selectedKey||e.isSelected("fan")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("fan")}}},[i("i",{staticClass:"icon-fan"})])]),e._v(" "),i("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[i("div",{class:"btn left"+("keep"==e.selectedKey||e.isSelected("keep")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("keep")}}},[i("i",{staticClass:"icon-ls_21_thermostat"})]),e._v(" "),i("div",{class:"btn center"+("dry"==e.selectedKey||e.isSelected("dry")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("dry")}}},[i("i",{staticClass:"icon-air-conditioner"})]),e._v(" "),i("div",{class:"btn right"+("scan"==e.selectedKey||e.isSelected("scan")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("scan")}}},[i("i",{staticClass:"icon-arrow-down-left"})])]),e._v(" "),i("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[i("div",{class:"btn left"+("highWind"==e.selectedKey||e.isSelected("highWind")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("highWind")}}},[i("i",{staticClass:"icon-screw2"})]),e._v(" "),i("div",{class:"btn center"+("middleWind"==e.selectedKey||e.isSelected("middleWind")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("middleWind")}}},[i("i",{staticClass:"icon-screw"})]),e._v(" "),i("div",{class:"btn right"+("lowWind"==e.selectedKey||e.isSelected("lowWind")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("lowWind")}}},[i("i",{staticClass:"icon-propeller"})])])])])},staticRenderFns:[]};var De=i("VU/8")(Ee,Te,!1,function(e){i("8yrj")},"data-v-044836b6",null).exports,Se={components:{RemoteACPanel:De},data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-110}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},isCondition:{type:Boolean,default:!1}},methods:{favoriteClick:function(e){e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},drawerClick:function(){"CONTROL"==this.mode?(document.getElementById("alarm").play(),this.drawer=!0):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))}},mounted:function(){}},we={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice",on:{click:function(t){return e.drawerClick(e.device)}}},[i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopScene"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:"line-height:24px;"+(""!=e.device.icon?"":"margin-right:62px;"),on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:(e.device.isOn?"iconC ":"")+"divIcon"},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameScene"+(e.device.isOn?" iconC ":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\n    ")]):e._e(),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px"},on:{"update:visible":function(t){e.drawer=t}}},[i("RemoteACPanel",{attrs:{device:e.device,mode:e.mode}})],1)],1)},staticRenderFns:[]};var Ie=i("VU/8")(Se,we,!1,function(e){i("Vf35")},"data-v-60b89324",null).exports,je={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-110,tabpage:1,selectedKey:""}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},arr_command:{type:Array,default:function(){return[]}}},methods:{tabClick:function(e){document.getElementById("alarm").play(),this.tabpage=e},keyClick:function(e){if(document.getElementById("alarm").play(),"CONTROL"==this.mode)w.a.sendRemoteAction(this.device,e),this.selectedKey="";else if("SELECT"==this.mode){console.log(e);for(var t=null,i=0;i<this.device.keyMaps.length;i++)this.device.keyMaps[i].val==e&&(t=this.device.keyMaps[i]);if(null==t)return;if(null==t.cmd||0==t.cmd.length)return;var a={name:A.a.OPTIONS_REMOTE_MAP[e],cmd:t.cmd};this.$emit("onSelectedCustom",this.device,a)}},keyDown:function(e){"CONTROL"==this.mode&&(this.selectedKey=e)},isSelected:function(e){for(var t="",i=0;i<this.device.keyMaps.length;i++)this.device.keyMaps[i].val==e&&(t=this.device.keyMaps[i].cmd);if(""==t)return!1;for(i=0;i<this.arr_command.length;i++)if(this.arr_command[i]==t)return!0;return!1}},mounted:function(){}},Oe={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"divDrawerACTitle",staticStyle:{top:"37px"}},[i("span",{staticClass:"spanDrawerAC1"},[e._v(e._s(e.device.name))])]),e._v(" "),i("div",{staticClass:"divDrawerRemote"},[i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_on"==e.selectedKey||e.isSelected("key_on")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_on")},touchstart:function(t){return e.keyDown("key_on")}}},[i("i",{staticClass:"icon-ls_38_on",staticStyle:{"font-size":"1.3em"}})]),e._v(" "),i("div",{class:"btn center"+("more"==e.selectedKey||e.isSelected("more")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("more")},touchstart:function(t){return e.keyDown("more")}}},[i("i",{staticClass:"el-icon-more"})]),e._v(" "),i("div",{class:"btn right"+("key_off"==e.selectedKey||e.isSelected("key_off")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_off")},touchstart:function(t){return e.keyDown("key_off")}}},[i("i",{staticClass:"icon-ls_39_off",staticStyle:{"font-size":"1.3em"}})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("hdmi"==e.selectedKey||e.isSelected("hdmi")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("hdmi")},touchstart:function(t){return e.keyDown("hdmi")}}},[e._v("HDMI")]),e._v(" "),i("div",{class:"btn center"+("usb"==e.selectedKey||e.isSelected("usb")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("usb")},touchstart:function(t){return e.keyDown("usb")}}},[e._v("USB")]),e._v(" "),i("div",{class:"btn right"+("bluetooth"==e.selectedKey||e.isSelected("bluetooth")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("bluetooth")},touchstart:function(t){return e.keyDown("bluetooth")}}},[i("i",{staticClass:"icon-ls_47_bluetooth"})])]),e._v(" "),i("div",{staticClass:"row ",staticStyle:{"margin-top":"20px"}},[i("div",{class:"btn left"+("key_menu"==e.selectedKey||e.isSelected("key_menu")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_menu")},touchstart:function(t){return e.keyDown("key_menu")}}},[i("i",{staticClass:"icon-category"})]),e._v(" "),i("div",{class:"btn center"+("key_up"==e.selectedKey||e.isSelected("key_up")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_up")},touchstart:function(t){return e.keyDown("key_up")}}},[i("i",{staticClass:"icon-arrow2_up"})]),e._v(" "),i("div",{class:"btn right"+("key_home"==e.selectedKey||e.isSelected("key_home")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_home")},touchstart:function(t){return e.keyDown("key_home")}}},[i("i",{staticClass:"icon-home1"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_left"==e.selectedKey||e.isSelected("key_left")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_left")},touchstart:function(t){return e.keyDown("key_left")}}},[i("i",{staticClass:"icon-arrow2_left"})]),e._v(" "),i("div",{class:"btn center"+("key_ok"==e.selectedKey||e.isSelected("key_ok")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_ok")},touchstart:function(t){return e.keyDown("key_ok")}}},[e._v("OK")]),e._v(" "),i("div",{class:"btn right"+("key_right"==e.selectedKey||e.isSelected("key_right")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_right")},touchstart:function(t){return e.keyDown("key_right")}}},[i("i",{staticClass:"icon-arrow2_right"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("key_return"==e.selectedKey||e.isSelected("key_return")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_return")},touchstart:function(t){return e.keyDown("key_return")}}},[i("i",{staticClass:"icon-arrow-left2"})]),e._v(" "),i("div",{class:"btn center"+("key_down"==e.selectedKey||e.isSelected("key_down")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("key_down")},touchstart:function(t){return e.keyDown("key_down")}}},[i("i",{staticClass:"icon-arrow2_down"})]),e._v(" "),i("div",{class:"btn right"+("silen"==e.selectedKey||e.isSelected("silen")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("silen")},touchstart:function(t){return e.keyDown("silen")}}},[i("i",{staticClass:"icon-volume-mute2"})])]),e._v(" "),i("div",{staticClass:"row ",staticStyle:{"margin-top":"20px"}},[i("div",{class:"btn left"+("previous"==e.selectedKey||e.isSelected("previous")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("previous")},touchstart:function(t){return e.keyDown("previous")}}},[i("i",{staticClass:"icon-previous2"})]),e._v(" "),i("div",{class:"btn center"+("play"==e.selectedKey||e.isSelected("play")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("play")},touchstart:function(t){return e.keyDown("play")}}},[i("i",{staticClass:"icon-play3"})]),e._v(" "),i("div",{class:"btn right"+("vol_up"==e.selectedKey||e.isSelected("vol_up")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("vol_up")},touchstart:function(t){return e.keyDown("vol_up")}}},[i("i",{staticClass:"icon-volume-increase"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("next"==e.selectedKey||e.isSelected("next")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("next")},touchstart:function(t){return e.keyDown("next")}}},[i("i",{staticClass:"icon-next2"})]),e._v(" "),i("div",{class:"btn center"+("pause"==e.selectedKey||e.isSelected("pause")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("pause")},touchstart:function(t){return e.keyDown("pause")}}},[i("i",{staticClass:"icon-pause2"})]),e._v(" "),i("div",{class:"btn right"+("vol_down"==e.selectedKey||e.isSelected("vol_down")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("vol_down")},touchstart:function(t){return e.keyDown("vol_down")}}},[i("i",{staticClass:"icon-volume-decrease"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{class:"btn left"+("loopone"==e.selectedKey||e.isSelected("loopone")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("loopone")},touchstart:function(t){return e.keyDown("loopone")}}},[i("i",{staticClass:"icon-ls_45_loop_one"})]),e._v(" "),i("div",{class:"btn center"+("loop"==e.selectedKey||e.isSelected("loop")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("loop")},touchstart:function(t){return e.keyDown("loop")}}},[i("i",{staticClass:"icon-ls_46_loop"})]),e._v(" "),i("div",{class:"btn right"+("random"==e.selectedKey||e.isSelected("random")?" btnViewC":" btnView"),on:{touchend:function(t){return e.keyClick("random")},touchstart:function(t){return e.keyDown("random")}}},[i("i",{staticClass:"icon-shuffle"})])])])])},staticRenderFns:[]};var Pe=i("VU/8")(je,Oe,!1,function(e){i("MXUu")},"data-v-09165253",null).exports,Re={components:{RemoteMusicPanel:Pe},data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-110,tabpage:1}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},isSelected:{type:Boolean,default:!1},isCondition:{type:Boolean,default:!1}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},drawerClick:function(){document.getElementById("alarm").play(),"CONTROL"==this.mode?this.drawer=!0:"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))}},mounted:function(){}},xe={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:(e.isSelected?"divDeviceSelect":e.isCondition?"divDeviceCondition":"")+" divDevice",on:{click:function(t){return e.drawerClick(e.device)}}},[i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopScene"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:"line-height:24px;"+(""!=e.device.icon?"":"margin-right:62px;"),on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:(e.device.isOn?"iconC ":"")+"divIcon"},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameScene"+(e.device.isOn?" iconC ":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\n    ")]):e._e(),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px"},on:{"update:visible":function(t){e.drawer=t}}},[i("RemoteMusicPanel",{attrs:{device:e.device,mode:e.mode}})],1)],1)},staticRenderFns:[]};var Ae=i("VU/8")(Re,xe,!1,function(e){i("kDt2")},"data-v-57759fec",null).exports,Le={data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-64,tabpage:1,selectedKey:""}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},arr_command:{type:Array,default:function(){return[]}}},methods:{tabClick:function(e){document.getElementById("alarm").play(),this.tabpage=e},keyClick:function(e){if(document.getElementById("alarm").play(),"CONTROL"==this.mode)w.a.sendRemoteAction(this.device,e),this.selectedKey="";else if("SELECT"==this.mode){console.log(e);for(var t=null,i=0;i<this.device.keyMaps.length;i++)this.device.keyMaps[i].val==e&&(t=this.device.keyMaps[i]);if(null==t)return;if(null==t.cmd||0==t.cmd.length)return;var a={name:t.val,cmd:t.cmd};this.$emit("onSelectedCustom",this.device,a)}},closeClick:function(){this.$emit("closeClick")},keyDown:function(e){"CONTROL"==this.mode&&(this.selectedKey=e)},isSelected:function(e){console.log(this.arr_command),console.log(e);for(var t=0;t<this.arr_command.length;t++)if(this.arr_command[t]==e)return!0;return!1}},mounted:function(){console.log(this.arr_command)}},Ne={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divRoomGallery",style:"border-top: 1px solid #f0851a;margin-top:"+("CONTROL"==e.mode?"133":"86")+"px;height:calc(100vh - 197px);overflow:scroll;padding-bottom: 3px;text-align: left;"},["CONTROL"==e.mode?i("div",{staticClass:"divDrawerACModeC",staticStyle:{position:"absolute",top:"57px",right:"20px"},on:{click:function(t){return e.closeClick()}}},[e._m(0)]):e._e(),e._v(" "),"CONTROL"==e.mode?i("div",{staticClass:"divDrawerACModeC",staticStyle:{position:"absolute",top:"57px",left:"20px"},on:{click:function(t){return e.closeClick()}}},[e._m(1)]):e._e(),e._v(" "),"CONTROL"==e.mode?i("div",{staticClass:"divDrawerACTitle"},[i("span",{staticClass:"spanDrawerAC1",staticStyle:{"font-size":"20px","line-height":"28px",color:"#ffffff"}},[e._v(e._s(e.device.name))])]):e._e(),e._v(" "),i("div",[i("div",{style:"width:100%;margin-top: 1px;margin-bottom:3px;"}),e._v(" "),e._l(e.device.keyMaps,function(t){return i("div",{key:t.val,staticClass:"divDevice",on:{touchend:function(i){return e.keyClick(t.val)},touchstart:function(i){return e.keyDown(t.val)}}},[i("div",{class:"divDevTopWithIcon divDevTopScene"},[i("div",{class:"spanDeviceName spanDeviceNameScene"+(e.selectedKey==t.val||e.isSelected(t.cmd)?" iconC ":"")+" spanDeviceNameNoIcon"},[e._v(e._s(t.val))])])])})],2)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btnDeviceAcFan"},[t("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"20px","line-height":"28px",color:"#ffffff"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btnDeviceAcFan",staticStyle:{"text-align":"right"}},[t("i",{staticClass:"el-icon-arrow-left",staticStyle:{"font-size":"20px","line-height":"28px",color:"#ffffff"}})])}]};var Ve=i("VU/8")(Le,Ne,!1,function(e){i("YVL/")},"data-v-9d851ac4",null).exports,Me={components:{RemoteCustomPanel:Ve},data:function(){return{drawer:!1,direction:"btt",heightDrawer:window.innerHeight-64,tabpage:1,arr_command:[]}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1},isCondition:{type:Boolean,default:!1}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},drawerClick:function(){document.getElementById("alarm").play(),"CONTROL"==this.mode?this.drawer=!0:"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},closeClick:function(){this.drawer=!1}},mounted:function(){}},Be={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:(e.isSelected?"divDeviceSelect":e.isCondition?"divDeviceCondition":"")+" divDevice",on:{click:function(t){return e.drawerClick(e.device)}}},[i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopScene"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:"line-height:24px;"+(""!=e.device.icon?"":"margin-right:62px;"),on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:(e.device.isOn?"iconC ":"")+"divIcon"},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameScene"+(e.device.isOn?" iconC ":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\n    ")]):e._e(),e._v(" "),i("el-drawer",{attrs:{visible:e.drawer,direction:e.direction,"append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px",withHeader:!1,modal:!1},on:{"update:visible":function(t){e.drawer=t}}},[i("RemoteCustomPanel",{attrs:{device:e.device,mode:e.mode,arr_command:e.arr_command},on:{closeClick:e.closeClick}})],1)],1)},staticRenderFns:[]};var Ue=i("VU/8")(Me,Be,!1,function(e){i("HlPL")},"data-v-e27d95d8",null).exports,$e={data:function(){return{loop:null,dialogVisible:!1}},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}}},components:{DesignLoginContent:W},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){"CONTROL"==this.mode?(document.getElementById("alarm").play(),b.a.getTypeStatus(),w.a.sendAction(e),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,1)):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){console.log("long tap"),this.$refs.DesignLoginContent.show()}}},Ye={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"divDevice",on:{click:function(t){return e.switchClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{class:(""!=e.device.icon?"":"divDevTopWithIcon ")+"divDevTopLight"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{staticClass:"divIcon",on:{click:function(t){return e.switchClick(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName spanDeviceNameOther"+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(null==e.device.name||""==e.device.name?e.device.panel_name:e.device.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(e.device.isOn?"开启":"关闭"))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\n    ")]):e._e()])},staticRenderFns:[]},Fe=i("VU/8")($e,Ye,!1,null,null,null).exports,He={data:function(){var e=this;return{loop:null,dialogVisible:!1,typeCode:function(){var t=e.device.deviceType;switch(null==t&&(t=e.device.type),t){case"light":return"L";case"dimmer":return"D";case"module_light":return"L";case"module_dimmer":return"D";case"curtain":case"process_curtain":return"C";case"scene":return"S";default:return""}}}},props:{device:{type:Object,default:null},touchAction:{type:Object,default:{isDown:!1}},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isCondition:{type:!0,default:!1},isSelected:{type:Boolean,default:!1}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},dimmerChange:function(){this.touchAction.isDown=!0;b.a.getTypeStatus(),w.a.sendAction(this.device),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,this.device.value)},switchClick:function(e){"CONTROL"==this.mode?(document.getElementById("alarm").play(),e.value>0?e.value=0:e.value=100,b.a.getTypeStatus(),w.a.sendAction(e),b.a.golbal.isDesignLogic&&b.a.addDesignLogic(this.device,this.device.value)):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){console.log("long tap"),this.$refs.DesignLoginContent.show()}},mounted:function(){this.dimmerValue=this.device.value}},Ge={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divDevice divDeviceLight",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":e.isCondition?"background-color:rgba(57,129,214,0.4);":"",on:{click:function(t){return e.switchClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:""!=e.device.icon?"":"margin-left:15px;"},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:""!=e.device.icon?"":"margin-right:62px;",on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:(e.device.value>0?"iconC":"")+" divIcon",on:{touchstart:function(t){return e.start(e.device)},touchend:function(t){return e.end(e.device)},click:function(t){return e.switchClick(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName"+(e.device.value>0?" iconC ":"")+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(e.device.value)+"%")])]),e._v(" "),i("div",{staticClass:"divControl"},[i("div",{staticClass:"divDimmer1"},[i("el-slider",{attrs:{"show-tooltip":!1,disabled:!e.golbal.isOnline&&"SELECT"==e.mode},on:{change:e.dimmerChange},model:{value:e.device.value,callback:function(t){e.$set(e.device,"value",t)},expression:"device.value"}})],1)]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n\t\t\t"+e._s(e.device.areacode+"-"+e.device.addr+"-"+e.typeCode()+e.device.channel)+"\n\t\t")]):e._e()])},staticRenderFns:[]},We=i("VU/8")(He,Ge,!1,null,null,null).exports,Ke={data:function(){var e=this;return{loop:null,dialogVisible:!1,unit:function(){switch(e.device.type){case"sensor_temperature":return"℃";case"sensor_humidity":return"%";case"sensor_brightness":return"LUX";case"sensor_pm25":return"ug/m³";case"sensor_hcho":case"sensor_co2":return"ppm";case"sensor_ch4":return"%LEL";default:return""}}}},components:{DesignLoginContent:W},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}},isSelected:{type:Boolean,default:!1}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){"CONTROL"==this.mode?console.log("CONTROL"):"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){this.$refs.DesignLoginContent.show(),console.log("long tap")}}},ze={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"divDevice",style:e.isSelected?"background-color:rgba(240,133,26,0.3);":"",on:{click:function(t){return e.switchClick(e.device)}}},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",style:"height:50px;padding-top:22px;margin-top:0px;"+(""!=e.device.icon?"":"margin-left:15px;")},["/device"==e.$route.path?i("div",{staticClass:"divFavorite",style:"line-height:24px;"+(""!=e.device.icon?"":"margin-right:62px;"),on:{click:function(t){return t.stopPropagation(),e.favoriteClick(e.device)}}},[i("i",{staticClass:"icon-favoritesfilling",class:{iconC:e.device.isFavorite}})]):e._e(),e._v(" "),""!=e.device.icon?i("div",{class:(e.device.isOn?"iconC ":"")+"divIcon",on:{click:function(t){return t.stopPropagation(),e.switchClick(e.device)}}},[i("i",{class:[e.device.icon]})]):e._e(),e._v(" "),i("div",{class:"spanDeviceName"+("/device"==e.$route.path?""!=e.device.icon?" spanDeviceNameEditingIcon":" spanDeviceNameEditingNoIcon":""!=e.device.icon?" spanDeviceNameIcon":" spanDeviceNameNoIcon")},[e._v(e._s(e.device.name))]),e._v(" "),"sensor_switch"==e.device.type?i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(null==e.device.isOn?"OFF":e.device.isOn?"ON":"OFF")+" ")]):i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(e.device.value)+e._s(e.unit()))])]),e._v(" "),"CONTROL"!=e.mode?i("div",{staticClass:"spanDeviceArea"},[e._v("\n        "+e._s(e.device.areacode+"-"+e.device.addr)+"\n    ")]):e._e()])},staticRenderFns:[]},qe=i("VU/8")(Ke,ze,!1,null,null,null).exports,Je={data:function(){return{loop:null,dialogVisible:!1}},components:{DesignLoginContent:W},props:{device:{type:Object,default:null},mode:{type:String,default:"CONTROL"},golbal:{type:Object,default:function(){return b.a.golbal}}},methods:{favoriteClick:function(e){document.getElementById("alarm").play(),e.isFavorite=!e.isFavorite,b.a.setFavourite(e.id)},switchClick:function(e){"CONTROL"==this.mode||"SELECT"==this.mode&&(b.a.golbal.editing.selectedDevice=this.device,this.$emit("onSelectDevice",this.device))},start:function(e){clearTimeout(this.loop);var t=this;this.loop=setTimeout(function(){t.deviceLongTap(e)},1e3)},end:function(e){clearTimeout(this.loop)},deviceLongTap:function(e){this.$refs.DesignLoginContent.show(),console.log("long tap")}}},Qe={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:"divDevice divDeviceLight"},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDevTop",on:{click:function(t){return e.switchClick(e.device)}}},[i("div",{staticClass:"divIcon",on:{touchstart:function(t){return e.start(e.device)},touchend:function(t){return e.end(e.device)}}},[i("i",{class:["el-icon-cpu"]})]),e._v(" "),i("div",{class:"spanDeviceName"},[e._v(e._s(e.device.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary",staticStyle:{"padding-top":"18px",width:"50vw"}},[e._v(e._s((null==e.device.isOnlineLocal?"内网离线":e.device.isOnlineLocal?"内网在线":"内网离线")+"/"+(null==e.device.isOnline?"外网离线":e.device.isOnline?"外网在线":"外网离线")))])]),e._v(" "),i("div",{staticClass:"divControl",on:{click:function(t){return e.switchClick(e.device)}}},[e._m(0)]),e._v(" "),i("DesignLoginContent",{ref:"DesignLoginContent",attrs:{visiable:e.dialogVisible,device:e.device}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btnSwitch"},[t("i",{staticClass:"icon-moreandroid"})])}]},Ze=i("VU/8")(Je,Qe,!1,null,null,null).exports,Xe={components:{DeviceLight:V,DeviceCurtain:U,DeviceDimmer:F,DeviceScene:oe,DeviceCamera:ge,DeviceNLLock:Fe,DeviceProcessCurtain:We,DeviceSensor:qe},data:function(){var e=this;return{touchAction:{isDown:!1},getMode:function(){return"FAVORITE"==e.mode?"CONTROL":e.mode},isCondition:function(t){if("CONTROL"==e.mode||"FAVORITE"==e.mode)return!1;if(null==e.golbal.editing.scene)return!1;for(var i=0;i<e.golbal.editing.scene.conditions.length;i++){var a=e.golbal.editing.scene.conditions[i];if(null!=a.device&&b.a.isDevEqual(a.device,t))return!0}return!1},sceneTop:function(e){return e<=2?"margin-top:-4vw":""},devTop:function(e){return e<=1?"margin-top:35px":""},showScenes:function(t){for(var i=[],a=0;a<e.devices.length;a++)"scene"==e.devices[a].type&&i.push(e.devices[a]);return i},showDevices:function(t){for(var i=[],a=0;a<e.devices.length;a++)"scene"!=e.devices[a].type&&i.push(e.devices[a]);return i},isSelected:function(t){if(console.log(t.name),"CONTROL"==e.mode||"FAVORITE"==e.mode)return!1;if("action"==e.selectType){if(null==e.golbal.editing.scene)return!1;for(var i=0;i<e.golbal.editing.scene.actions.length;i++){var a=e.golbal.editing.scene.actions[i];if(null!=a.deviceId){if(a.deviceId==t.id)return!0}else{var o=null;if(null!=a.device&&(o=a.device),null!=a.deviceId&&(o=b.a.getVODeviceById(a.deviceId)),null!=o)if("ac"==o.type||"heating"==o.type||"fan"==o.type){if(o.id.substring(0,35)==t.id.substring(0,35))return!0}else if(o.id==t.id)return!0}}return!1}if("condition"==e.selectType){if(null==e.golbal.editing.scene)return!1;for(i=0;i<e.golbal.editing.scene.conditions.length;i++){var s=e.golbal.editing.scene.conditions[i];if(null!=s.device)if("ac"==s.device.type||"heating"==s.device.type||"fan"==s.device.type){if(s.device.id.substring(0,35)==t.id.substring(0,35))return!0}else if(s.device.id==t.id)return!0}return!1}},actionStatus:function(t){if("CONTROL"==e.mode||"FAVORITE"==e.mode)return null;if(null==e.golbal.editing.scene)return null;for(var i=0;i<e.golbal.editing.scene.actions.length;i++){var a=e.golbal.editing.scene.actions[i],o=null;if(null!=a.device&&(o=a.device),null!=a.deviceId&&(o=b.a.getVODeviceById(a.deviceId)),null!=o&&b.a.isDevEqual(o,t))return a.status}return null}}},props:{devices:{type:Array,default:[]},mode:{type:String,default:"CONTROL"},selectType:{type:String,default:""},golbal:{type:Object,default:function(){return b.a.golbal}},title:{type:String,default:""}},methods:{isShow:function(e,t){if(null==e)return!1;if(t.indexOf(e.type)<0)return!1;if("SELECT"!=this.mode&&!this.golbal.isDesignLogic&&e.isHide)return!1;if("SELECT"==this.mode&&"condition"==this.selectType&&null!=this.golbal.editing.scene){if("SCENE"==this.golbal.editing.scene.sceneType&&"scene"!=e.type&&!e.type.startsWith("sensor_"))return!1;if("RELATIVE"==this.golbal.editing.scene.sceneType&&"light"!=e.type&&"module_light"!=e.type&&"module_dimmer"!=e.type&&"dimmer"!=e.type&&"curtain"!=e.type)return!1}if("SELECT"==this.mode&&"action"==this.selectType&&null!=this.golbal.editing.scene){if("RELATIVE"==this.golbal.editing.scene.sceneType&&"light"!=e.type&&"module_light"!=e.type&&"module_dimmer"!=e.type&&"dimmer"!=e.type&&"curtain"!=e.type)return!1;if(("AUTOMATION"==this.golbal.editing.scene.sceneType||"TIMER"==this.golbal.editing.scene.sceneType)&&"scene"==e.type)return!1}return!0},onSelectDevice:function(e){console.log("OK"),null==e?this.devices.length>0&&(b.a.golbal.editing.selectedDevice=this.devices[0],this.$emit("onSelectedDevice",this.devices[0])):this.$emit("onSelectedDevice",e)},closeClick:function(){this.$emit("closeClick")}},mounted:function(){}},et={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"divRoomGallery",staticStyle:{"border-top":"1px solid #f0851a","margin-top":"133px",height:"calc(100vh - 197px)",overflow:"scroll","padding-bottom":"3px"}},[i("div",{staticClass:"divDrawerACModeC",staticStyle:{position:"absolute",top:"57px",right:"20px"},on:{click:function(t){return e.closeClick()}}},[e._m(0)]),e._v(" "),i("div",{staticClass:"divDrawerACModeC",staticStyle:{position:"absolute",top:"57px",left:"20px"},on:{click:function(t){return e.closeClick()}}},[e._m(1)]),e._v(" "),i("div",{staticClass:"divDrawerACTitle",on:{click:function(t){return e.onSelectDevice()}}},[i("span",{staticClass:"spanDrawerAC1",staticStyle:{"font-size":"20px","line-height":"28px",color:"#ffffff"}},[e._v(e._s(e.title))])]),e._v(" "),i("div",[i("div",{style:"width:100%;margin-top: 1px;margin-bottom:3px;"}),e._v(" "),e._l(e.showScenes(),function(t){return[e.isShow(t,["scene"])?i("DeviceScene",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path},on:{onSelectDevice:e.onSelectDevice}}):e._e()]}),e._v(" "),e._l(e.showDevices(),function(t,a){return[e.isShow(t,["light","module_light"])?i("DeviceLight",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["curtain"])?i("DeviceCurtain",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["process_curtain"])?i("DeviceProcessCurtain",{key:t.id,attrs:{device:t,golbal:e.golbal,mode:e.getMode(),touchAction:e.touchAction,actionStatus:e.actionStatus(t),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["dimmer","module_dimmer"])?i("DeviceDimmer",{key:t.id,attrs:{device:t,golbal:e.golbal,mode:e.getMode(),touchAction:e.touchAction,actionStatus:e.actionStatus(t),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["camera"])?i("DeviceCamera",{key:t.id,attrs:{device:t,golbal:e.golbal,mode:e.getMode()},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["nl_lock"])?i("DeviceNLLock",{key:t.id,attrs:{device:t,mode:e.getMode()},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["sensor_temperature","sensor_humidity","sensor_brightness","sensor_pm25","sensor_hcho","sensor_co2","sensor_ch4","sensor_switch","sensor_pules"])?i("DeviceSensor",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e()]})],2)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btnDeviceAcFan"},[t("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"20px","line-height":"28px",color:"#ffffff"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"btnDeviceAcFan",staticStyle:{"text-align":"right"}},[t("i",{staticClass:"el-icon-arrow-left",staticStyle:{"font-size":"20px","line-height":"28px",color:"#ffffff"}})])}]},tt=i("VU/8")(Xe,et,!1,null,null,null).exports;a.default.use(x.a,{name:"v-touch"});var it={components:{DeviceLight:V,DeviceCurtain:U,DeviceDimmer:F,DeviceAC:Z,DeviceScene:oe,DeviceFolder:le,DeviceHeating:ue,DeviceFan:he,DeviceCamera:ge,DeviceCombo:te,DeviceRemoteTV:ke,DeviceRemoteAC:Ie,DeviceRemoteMusic:Ae,DeviceRemoteCustom:Ue,DeviceNLLock:Fe,DeviceProcessCurtain:We,DeviceSensor:qe,DeviceBus:Ze,SwitchPanel:tt,ACPanel:q},data:function(){var e=this;return{heightRoom:window.outerHeight-166,heightDrawer:window.innerHeight-64,touchAction:{isDown:!1},timer:null,ulChildrenCount:0,ul_width:function(){var t=e.$refs.ul_room,i=500;if(null!=t&&null!=t.children){i=0;for(var a=0;a<t.children.length;a++)i+=t.children[a].clientWidth+2}return e.ulChildrenCount=i,i},getMode:function(){return"FAVORITE"==e.mode?"CONTROL":e.mode},cameraDemo:{id:"b0b502b7-c001-4001-a001-0547116af009",type:"video",name:"正门",summary:"",icon:"el-icon-video-camera",isFavorite:!0,videoURL:"https://hls01open.ys7.com/openlive/6e0b2be040a943489ef0b9bb344b96b8.hd.m3u8"},deviceCount:function(){var t=0;if(null==e.golbal.roomCur)return 0;if(null==e.golbal.roomCur.devices)return 0;if(0==e.golbal.roomCur.devices.length)return 0;for(var i=0;i<e.golbal.roomCur.devices.length;i++){var a=e.golbal.roomCur.devices[i];null!=device.isHide&&!device.isHide||"light"!=a.type&&"module_light"!=a.type||"light"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"curtain"!=a.type||"curtain"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"process_curtain"!=a.type||"curtain"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"dimmer"!=a.type&&"module_dimmer"!=a.type||"light"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"ac"!=a.type||"ac"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"combo"!=a.type||"ac"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"scene"!=a.type||"scene"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"heating"!=a.type||"ac"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"fan"!=a.type||"ac"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"camera"!=a.type||"video"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"remote"!=a.type||"remote"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||"nl_lock"!=a.type||"lock"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++,null!=device.isHide&&!device.isHide||!a.type.startsWith("sensor_")||"sensor"!=e.golbal.typeCur&&"all"!=e.golbal.typeCur||t++}return t},isSelected:function(t){if("CONTROL"==e.mode||"FAVORITE"==e.mode)return!1;if("action"==e.selectType){if(null==e.golbal.editing.scene)return!1;for(var i=0;i<e.golbal.editing.scene.actions.length;i++){var a=e.golbal.editing.scene.actions[i],o=null;if(null!=a.device&&(o=a.device),null!=a.deviceId&&(o=b.a.getVODeviceById(a.deviceId)),null!=o&&b.a.isDevEqual(o,t))return!0}return!1}if("condition"==e.selectType){if(null==e.golbal.editing.scene)return!1;for(i=0;i<e.golbal.editing.scene.conditions.length;i++){var s=e.golbal.editing.scene.conditions[i];if(null!=s.device&&b.a.isDevEqual(s.device,t))return!0}return!1}},isCondition:function(t){if("CONTROL"==e.mode||"FAVORITE"==e.mode)return!1;if(null==e.golbal.editing.scene)return!1;for(var i=0;i<e.golbal.editing.scene.conditions.length;i++){var a=e.golbal.editing.scene.conditions[i];if(null!=a.device&&b.a.isDevEqual(a.device,t))return!0}return!1},actionStatus:function(t){if("CONTROL"==e.mode||"FAVORITE"==e.mode)return null;if(null==e.golbal.editing.scene)return null;for(var i=0;i<e.golbal.editing.scene.actions.length;i++){var a=e.golbal.editing.scene.actions[i],o=null;if(null!=a.device&&(o=a.device),null!=a.deviceId&&(o=b.a.getVODeviceById(a.deviceId)),null!=o&&b.a.isDevEqual(o,t))return a.status}return null},deviceAll:function(){if("FAVORITE"==e.mode){for(var t=[],i=0;i<b.a.devicesAll.length;i++)t.push(b.a.devicesAll[i].device);return t}if(null==e.golbal.roomCur)return[];if(null==e.golbal.roomCur.devices)return[];if(0==e.golbal.roomCur.devices.length)return[];var a=[];for(i=0;i<e.golbal.roomCur.devices.length;i++){var o=e.golbal.roomCur.devices[i];"light"==o.type||"dimmer"==o.type||"curtain"==o.type||"process_curtain"==o.type||"scene"==o.type||"module_light"==o.type||"module_dimmer"==o.type||o.type.startsWith("sensor")?(null==o.isExpend||o.isExpend)&&a.push(o):a.push(o)}return a},buses:function(){var t=[];if(null==e.golbal.roomCur){if(null!=e.golbal.myProject.buses&&e.golbal.myProject.buses.length>0)for(var i=0;i<e.golbal.myProject.buses.length;i++){var a=e.golbal.myProject.buses[i];t.push(a)}}else if(null!=e.golbal.myProject.buses&&e.golbal.myProject.buses.length>0)for(i=0;i<e.golbal.myProject.buses.length;i++){a=e.golbal.myProject.buses[i];for(var o=!1,s=0;s<e.golbal.floorCur.rooms.length;s++)null!=a.roomId&&a.roomId==e.golbal.floorCur.rooms[s].id&&(o=!0);o||t.push(a),a.roomId==e.golbal.roomCur.id&&t.push(a)}return t},panelAll:function(){if(null==e.golbal.roomCur)return[];if(null==e.golbal.roomCur.devices)return[];if(0==e.golbal.roomCur.devices.length)return[];if("FAVORITE"==e.mode)return[];for(var t=[],i="",a="icon-ls_panel",o="#f44a31",s=0;s<e.golbal.roomCur.devices.length;s++){var n=e.golbal.roomCur.devices[s],l=!0,c=!1;if(("light"==n.type||"dimmer"==n.type||"curtain"==n.type||"process_curtain"==n.type||"scene"==n.type||"module_light"==n.type||"module_dimmer"==n.type||n.type.startsWith("sensor"))&&null!=n.isExpend&&0==n.isExpend){for(var r=0;r<t.length;r++)if(null!=n.panelId){if(t[r].id==n.panelId){l=!1,t[r].devices.push(n),n.isFavorite&&(t[r].isFavorite=!0),t[r].isOn||(n.isOn&&(t[r].isOn=!0),"curtain"==n.type?t[r].isOn=100==n.value:null!=n.value&&n.value>0&&(t[r].isOn=!0));break}}else if(t[r].addr==n.addr&&t[r].areacode==n.areacode){l=!1,t[r].devices.push(n),t[r].isOn||("curtain"==n.type?t[r].isOn=100==n.value:null!=n.value&&n.value>0&&(t[r].isOn=!0));break}l&&("light"==n.type||"dimmer"==n.type||"curtain"==n.type||"process_curtain"==n.type||"scene"==n.type?(i="SWITCH",a="icon-ls_panel",o="#f44a31",c=n.isOn,"curtain"==n.type?c=100==n.value:null!=n.value&&n.value>0&&(c=!0)):"module_light"==n.type||"module_dimmer"==n.type?(i="MODULE",a="icon-ls_module",o="#55b144",c=n.isOn,null!=n.value&&n.value>0&&(c=!0)):n.type.startsWith("sensor")&&(i="SENSOR",a="icon-ls_panel",o="#55b144",c=n.isOn),t.push({id:null==n.panelId?"":n.panelId,name:null==n.panel_name?n.name:n.panel_name,addr:n.addr,areacode:n.areacode,type:i,isOn:c,icon:a,iconcolor:o,devices:[n],isFavorite:n.isFavorite}))}}return t},current_secure:"",current_panel:{name:"",devices:[]}}},props:["golbal","mode","selectType"],methods:{roomClick:function(e){if("bus"==e)this.golbal.roomCur.active=!1,this.golbal.roomCur=null;else{this.golbal.pageCase="NORMAL";for(var t=0;t<this.golbal.floorCur.rooms.length;t++){this.golbal.floorCur.rooms[t].active=!1}e.active=!0,this.golbal.roomCur=e,this.golbal.typeCur="all","/room"==this.$route.path&&(b.a.sendQueryDeviceStatus(),b.a.getTypeStatus())}},panelClick:function(e){if("GW"==e.type?this.$emit("onSelectedDevice",e.devices[0]):this.golbal.showSwitchPanel=!0,null==e.id||""==e.id){for(var t=b.a.uuid(),i=0;i<e.devices.length;i++)e.devices[i].panelId=t;b.a.checkIsMaster()&&b.a.saveProject(this.golbal.myProject)}this.current_panel=e,console.log("finish panel click "+e.name)},typeClick:function(e){this.golbal.typeCur=e},hasType:function(e){if("SELECT"==this.mode&&null!=this.golbal.editing.scene){var t=this.golbal.editing.scene.sceneType;if("condition"==this.selectType&&"SCENE"==t)return!1}var i="FAVORITE"==this.mode?this.deviceAll():null==this.golbal.roomCur?[]:null==this.golbal.roomCur.devices?[]:this.golbal.roomCur.devices;if(null!=i&&0!=i.length){if("SELECT"==this.mode&&"action"==this.selectType&&"sensor"==e)return!1;if("SELECT"==this.mode&&"SCENE"==this.selectType&&"scene"!=e)return!1;if("SELECT"==this.mode&&"RELATIVE"==this.selectType&&"light"!=e)return!1;for(var a=0;a<i.length;a++){var o=i[a];if("all"==e){if("FAVORITE"!=this.mode)return!0;if(o.isFavorite)return!0}else if(A.a.JSON_TYPE[e].indexOf(o.type)>-1||A.a.JSON_TYPE[e].indexOf(o.deviceType)>-1){if("FAVORITE"!=this.mode)return!0;if(o.isFavorite)return!0}}return!1}},onSwipe:function(e){var t=this;setTimeout(function(){console.log("on Swipe"+t.touchAction.isDown),t.touchAction.isDown||(1==e?t.onSwipeLeft():2==e&&t.onSwipeRight(),t.setScrollX()),t.touchAction.isDown=!1},200)},onSwipeLeft:function(){for(var e=0,t=0;t<this.golbal.floorCur.rooms.length;t++){if(this.golbal.floorCur.rooms[t]==this.golbal.roomCur){e=t;break}}e<this.golbal.floorCur.rooms.length-1&&(e+=1),this.roomClick(this.golbal.floorCur.rooms[e])},onSwipeRight:function(){for(var e=0,t=0;t<this.golbal.floorCur.rooms.length;t++){if(this.golbal.floorCur.rooms[t]==this.golbal.roomCur){e=t;break}}e>0&&(e-=1),this.roomClick(this.golbal.floorCur.rooms[e])},setScrollX:function(){for(var e=this.golbal.floorCur.rooms.indexOf(this.golbal.roomCur),t=this.$refs.ul_room,i=0,a=0;a<=e;a++)i+=t.children[a].clientWidth+2;(console.log(i+","+window.innerWidth),i>window.innerWidth)?document.querySelector("#DivRoomTop").scrollLeft=i-window.innerWidth:document.querySelector("#DivRoomTop").scrollLeft=0},setView:function(e){this.golbal.isGallery=e,b.a.saveSetting()},resetUlWidth:function(){this.$refs.ul_room},onSelectDevice:function(e){var t=this.golbal.editing.selectedDevice.type;"MODULE"==t||"SWITCH"==t||"SENSOR"==t?this.panelClick(this.golbal.editing.selectedDevice):this.$emit("onSelectedDevice",e)},getDeviceCount:function(){var e=0;if("FAVORITE"==this.mode){for(var t=this.deviceAll(),i=0;i<t.length;i++){(a=t[i]).isFavorite&&e++}return e}if(null==this.golbal.roomCur)return 0;for(i=0;i<this.golbal.roomCur.devices.length;i++){var a;"light"!=(a=this.golbal.roomCur.devices[i]).type&&"module_light"!=a.type||!this.isShow(a,["light","module_light"])||e++,"curtain"==a.type&&this.isShow(a,["curtain"])&&e++,"process_curtain"==a.type&&this.isShow(a,["process_curtain"])&&e++,"dimmer"!=a.type&&"module_dimmer"!=a.type||!this.isShow(a,["dimmer","module_dimmer"])||e++,"ac"==a.type&&this.isShow(a,["ac"])&&e++,"combo"==a.type&&this.isShow(a,["combo"])&&e++,"scene"==a.type&&this.isShow(a,["scene"])&&e++,"heating"==a.type&&this.isShow(a,["heating"])&&e++,"fan"==a.type&&this.isShow(a,["fan"])&&e++,"camera"==a.type&&this.isShow(a,["camera"])&&e++,"remote"==a.type&&"tv"==a.remoteType&&this.isShow(a,["remote","tv"])&&e++,"remote"==a.type&&"ac"==a.remoteType&&this.isShow(a,["remote","ac"])&&e++,"nl_lock"!=a.type||"lock"!=this.golbal.typeCur&&"all"!=this.golbal.typeCur||e++,a.type.startsWith("sensor_")&&this.isShow(a,["sensor_temperature","sensor_humidity","sensor_brightness","sensor_pm25","sensor_hcho","sensor_co2","sensor_ch4","sensor_switch","sensor_pules"])&&e++}return this.isShow(null,["bus"])&&e++,e},isShow:function(e,t){if(null==e&&t.indexOf("bus")>-1){if(null==this.golbal.roomCur)return!0;var i=this.buses();return"SELECT"==this.mode&&"edit"==this.selectType&&("bus"==this.golbal.typeCur||"all"==this.golbal.typeCur)&&null!=i&&i.length>0}if(null==e)return!1;if(!e.isFavorite&&"FAVORITE"==this.mode)return!1;if(t.indexOf("folder")>-1){if(!e.isFavorite&&"FAVORITE"==this.mode)return!1;if("MODULE"==e.type||"SWITCH"==e.type||"SENSOR"==e.type)return!0}if(t.indexOf(e.type)<0)return!1;if("SELECT"!=this.mode&&!this.golbal.isDesignLogic&&e.isHide)return!1;if("SELECT"==this.mode&&"condition"==this.selectType&&null!=this.golbal.editing.scene){if("SCENE"==this.golbal.editing.scene.sceneType&&"scene"!=e.type&&!e.type.startsWith("sensor_"))return!1;if("RELATIVE"==this.golbal.editing.scene.sceneType&&"light"!=e.type&&"module_light"!=e.type&&"module_dimmer"!=e.type&&"dimmer"!=e.type&&"curtain"!=e.type)return!1}if("SELECT"==this.mode&&"action"==this.selectType&&null!=this.golbal.editing.scene){if("RELATIVE"==this.golbal.editing.scene.sceneType&&"light"!=e.type&&"module_light"!=e.type&&"module_dimmer"!=e.type&&"dimmer"!=e.type&&"curtain"!=e.type)return!1;if(("AUTOMATION"==this.golbal.editing.scene.sceneType||"TIMER"==this.golbal.editing.scene.sceneType)&&"scene"==e.type)return!1}return"all"==this.golbal.typeCur||(("light"==e.type||"module_light"==e.type)&&"light"==this.golbal.typeCur||(("dimmer"==e.type||"module_dimmer"==e.type)&&"light"==this.golbal.typeCur||(("process_curtain"==e.type||"curtain"==e.type)&&"curtain"==this.golbal.typeCur||("ac"==e.type&&"ac"==this.golbal.typeCur||("combo"==e.type&&"ac"==this.golbal.typeCur||("heating"==e.type&&"ac"==this.golbal.typeCur||("fan"==e.type&&"ac"==this.golbal.typeCur||("scene"==e.type&&"scene"==this.golbal.typeCur||("camera"==e.type&&"video"==this.golbal.typeCur||("nl_lock"==e.type&&"lock"==this.golbal.typeCur||(!(!e.type.startsWith("sensor_")||"sensor"!=this.golbal.typeCur)||("remote"==e.type&&"ac"==e.remoteType&&"remote"==this.golbal.typeCur&&t.indexOf("ac")>=0||"remote"==e.type&&"tv"==e.remoteType&&"remote"==this.golbal.typeCur&&t.indexOf("tv")>=0))))))))))))},clickSecureScene:function(e){this.current_secure=e;var t=[],i=[];if(1==e)t=this.golbal.myProject.secureIn,i=this.golbal.myProject.secureOut;else if(2==e)t=this.golbal.myProject.secureOut,i=this.golbal.myProject.secureIn;else if(0==e){for(var a=0;a<this.golbal.myProject.secureIn.length;a++)i.push(this.golbal.myProject.secureIn[a]);for(a=0;a<this.golbal.myProject.secureOut.length;a++)i.push(this.golbal.myProject.secureOut[a])}if(i.length>0){var o=[];for(a=0;a<i.length;a++)for(var s=0;s<this.golbal.myProject.scenes.length;s++){(n=this.golbal.myProject.scenes[s]).id==i[a].id&&(n.enabled=!1,o.push(n))}o.length>0&&w.a.sendAutomationEnabled(o,!1)}if(t.length>0){for(o=[],a=0;a<t.length;a++)for(s=0;s<this.golbal.myProject.scenes.length;s++){var n;(n=this.golbal.myProject.scenes[s]).id==t[a].id&&(n.enabled=!0,o.push(n))}o.length>0&&w.a.sendAutomationEnabled(o,!0)}this.golbal.myProject.secureIndex=e,b.a.saveProject(this.golbal.myProject)},closeClick:function(){this.golbal.showSwitchPanel=!1}},mounted:function(){this.mode,this.golbal.pageCase="NORMAL","SELECT"==this.mode&&"SCENE"==this.selectType&&this.typeClick("scene"),"SELECT"==this.mode&&"RELATIVE"==this.selectType&&this.typeClick("light"),null!=this.golbal.myProject.secureIndex&&(this.current_secure=this.golbal.myProject.secureIndex);var e=this;this.golbal.timerUl=setInterval(function(){var t=e.$refs.ul_room;if(null!=t&&null!=t.children){for(var i=0,a=0;a<t.children.length;a++)i+=t.children[a].clientWidth+2;if(i!=e.ulChildrenCount)console.log("update"),e.$forceUpdate(),document.querySelector("#DivRoomTop").scrollLeft=10}},1e3),this.golbal.showSwitchPanel=!1}},at={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-touch",{staticStyle:{"touch-action":"pan-y!important"},attrs:{tag:"div"},on:{swipeleft:function(t){return e.onSwipe(1)},swiperight:function(t){return e.onSwipe(2)}}},["FAVORITE"==e.mode||e.golbal.isPad?e._e():i("div",{staticClass:"divWeather"},[i("div",{domProps:{innerHTML:e._s(e.golbal.weather)}})]),e._v(" "),"FAVORITE"!=e.mode?i("div",{staticClass:"divRoomTop",attrs:{id:"DivRoomTop"}},[i("ul",{ref:"ul_room",style:e.golbal.isPad?"":"width:"+e.ul_width()+"px;"},e._l(e.golbal.floorCur.rooms,function(t){return i("li",{key:t.id,class:t.active?"liRoomTopC":t.isOn?"liRoomTopBlue":"",on:{click:function(i){return e.roomClick(t)}}},[e._v(e._s(t.name))])}),0)]):e._e(),e._v(" "),"FAVORITE"==e.mode?i("div",{staticClass:"divSecureTop"},[i("ul",[i("li",{class:"divSecureSwitchLeft"+(1==e.current_secure?" select":""),on:{click:function(t){return e.clickSecureScene(1)}}},[i("div",[i("i",{staticClass:"el-icon-lock"}),e._v("ALArea")])]),e._v(" "),i("li",{class:"divSecureSwitchCenter"+(2==e.current_secure?" select":""),on:{click:function(t){return e.clickSecureScene(2)}}},[i("div",[i("i",{staticClass:"el-icon-lock"}),e._v("ALAll")])]),e._v(" "),i("li",{class:"divSecureSwitchRight"+(0==e.current_secure?" select":""),on:{click:function(t){return e.clickSecureScene(0)}}},[i("div",[i("i",{staticClass:"el-icon-unlock"}),e._v("ALOff")])])])]):e._e(),e._v(" "),i("div",{staticClass:"divRoom",style:"/favorite"!=e.$route.path&&"/user"!=e.$route.path||e.golbal.isPad?"":"height:calc(100% - 133px);top:133px"},[i("div",{staticClass:"divRoomContent divRoomGallery"},[[i("div",[i("div",{staticClass:"divRoomTop2"},[i("ul",[e.hasType("all")?i("li",{class:{liRoomTopC:"all"==e.golbal.typeCur},on:{click:function(t){return e.typeClick("all")}}},[i("i",{staticClass:"icon-all"})]):e._e(),e._v(" "),e.hasType("scene")?i("li",{class:"scene"==e.golbal.typeCur?"liRoomTopC":e.golbal.type[4].isOn?"liRoomTopBlue":"",on:{click:function(t){return e.typeClick("scene")}}},[i("i",{staticClass:"icon-ls_26_go_off_work"})]):e._e(),e._v(" "),e.hasType("light")?i("li",{class:"light"==e.golbal.typeCur?"liRoomTopC":e.golbal.type[1].isOn?"liRoomTopBlue":"",on:{click:function(t){return e.typeClick("light")}}},[i("i",{staticClass:"icon-ls_1_light"})]):e._e(),e._v(" "),e.hasType("curtain")?i("li",{class:"curtain"==e.golbal.typeCur?"liRoomTopC":e.golbal.type[2].isOn?"liRoomTopBlue":"",on:{click:function(t){return e.typeClick("curtain")}}},[i("i",{staticClass:"icon-ls_23_curtain"})]):e._e(),e._v(" "),e.hasType("ac")?i("li",{class:"ac"==e.golbal.typeCur?"liRoomTopC":e.golbal.type[3].isOn?"liRoomTopBlue":"",on:{click:function(t){return e.typeClick("ac")}}},[i("i",{staticClass:"icon-air-conditioner"})]):e._e(),e._v(" "),e.hasType("remote")?i("li",{class:"remote"==e.golbal.typeCur?"liRoomTopC":e.golbal.type[5].isOn?"liRoomTopBlue":"",on:{click:function(t){return e.typeClick("remote")}}},[i("i",{staticClass:"icon-mobilefill"})]):e._e(),e._v(" "),e.hasType("lock")?i("li",{class:"lock"==e.golbal.typeCur?"liRoomTopC":e.golbal.type[5].isOn?"liRoomTopBlue":"",on:{click:function(t){return e.typeClick("lock")}}},[i("i",{staticClass:"el-icon-lock"})]):e._e(),e._v(" "),e.hasType("video")?i("li",{class:"video"==e.golbal.typeCur?"liRoomTopC":"",on:{click:function(t){return e.typeClick("video")}}},[i("i",{staticClass:"el-icon-video-camera"})]):e._e(),e._v(" "),e.hasType("sensor")?i("li",{class:"sensor"==e.golbal.typeCur?"liRoomTopC":"",on:{click:function(t){return e.typeClick("sensor")}}},[i("i",{staticClass:"el-icon-odometer"})]):e._e(),e._v(" "),"SELECT"==e.mode&&"edit"==e.selectType&&e.buses().length>0?i("li",{class:"bus"==e.golbal.typeCur?"liRoomTopC":"",on:{click:function(t){return e.typeClick("bus")}}},[i("i",{staticClass:"el-icon-cpu"})]):e._e()]),e._v(" "),e.golbal.isPad?i("div",{staticClass:"divDevCount"},[e._v(e._s(e.getDeviceCount())+"个设备")]):e._e()]),e._v(" "),null!=e.golbal.roomCur&&"NORMAL"==e.golbal.pageCase?[e._l(e.deviceAll(),function(t){return[e.isShow(t,["scene"])?i("DeviceScene",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path,actionStatus:e.actionStatus(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e()]}),e._v(" "),e._l(e.deviceAll(),function(t){return[e.isShow(t,["light","module_light"])?i("DeviceLight",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path,actionStatus:e.actionStatus(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["curtain"])?i("DeviceCurtain",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["process_curtain"])?i("DeviceProcessCurtain",{key:t.id,attrs:{device:t,golbal:e.golbal,touchAction:e.touchAction,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["dimmer","module_dimmer"])?i("DeviceDimmer",{key:t.id,attrs:{device:t,golbal:e.golbal,touchAction:e.touchAction,mode:e.getMode(),isSelected:e.isSelected(t),isCondition:e.isCondition(t)&&"/device"!=e.$route.path,actionStatus:e.actionStatus(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["ac"])?i("DeviceAC",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),actionStatus:e.actionStatus(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["combo"])?i("DeviceCombo",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),actionStatus:e.actionStatus(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["heating"])?i("DeviceHeating",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),actionStatus:e.actionStatus(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["fan"])?i("DeviceFan",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t),actionStatus:e.actionStatus(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["camera"])?i("DeviceCamera",{key:t.id,attrs:{device:t,golbal:e.golbal,mode:e.getMode()},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["remote","remoteTV"])?i("DeviceRemoteTV",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["remote","remoteMusic"])?i("DeviceRemoteMusic",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["remote","remoteCustom"])?i("DeviceRemoteCustom",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["remote","remoteAC"])?i("DeviceRemoteAC",{key:t.id,attrs:{device:t,mode:e.getMode()},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["nl_lock"])?i("DeviceNLLock",{key:t.id,attrs:{device:t,mode:e.getMode()},on:{onSelectDevice:e.onSelectDevice}}):e._e(),e._v(" "),e.isShow(t,["sensor_temperature","sensor_humidity","sensor_brightness","sensor_pm25","sensor_hcho","sensor_co2","sensor_ch4","sensor_switch","sensor_pules"])?i("DeviceSensor",{key:t.id,attrs:{device:t,mode:e.getMode(),isSelected:e.isSelected(t)},on:{onSelectDevice:e.onSelectDevice}}):e._e()]}),e._v(" "),e._l(e.panelAll(),function(t){return[e.isShow(t,["folder"])?i("DeviceFolder",{key:t.id,attrs:{device:t,mode:e.getMode()},on:{onClick:function(i){return e.panelClick(t)},onSelectDevice:e.onSelectDevice}}):e._e()]}),e._v(" "),e._l(e.buses(),function(t){return[e.isShow(null,["bus"])?i("DeviceBus",{key:t.id,attrs:{device:t,mode:e.getMode()},on:{onSelectDevice:e.onSelectDevice}}):e._e()]})]:e._e()],2)]],2)]),e._v(" "),i("el-drawer",{attrs:{visible:e.golbal.showSwitchPanel,direction:"btt","append-to-body":!0,"custom-class":"drawerAC",size:e.heightDrawer+"px",withHeader:!1,modal:!1},on:{"update:visible":function(t){return e.$set(e.golbal,"showSwitchPanel",t)}}},["THERMOSTAT"!=e.current_panel.type?i("SwitchPanel",{attrs:{golbal:e.golbal,title:e.current_panel.name,devices:e.current_panel.devices,mode:e.mode,selectType:e.selectType},on:{onSelectedDevice:e.onSelectDevice,closeClick:e.closeClick}}):i("ACPanel",{attrs:{golbal:e.golbal,device:e.current_panel.devices[0],mode:e.mode},on:{closeClick:e.closeClick,onSelectedDevice:e.onSelectDevice}})],1)],1)},staticRenderFns:[]};var ot=i("VU/8")(it,at,!1,function(e){i("z08P")},"data-v-12a6dfba",null).exports,st={components:{DeviceMain:ot},data:function(){return{heightRoom:window.innerHeight-166,touchAction:{isDown:!1},ul_width:200}},props:["golbal"],methods:{queryDevicesStatus:function(){var e=[];Object(_.a)();for(var t=0;t<b.a.devicesAll.length;t++){var i=!0,a=b.a.devicesAll[t].device;if(a.isFavorite){for(var o=0;o<e.length;o++)a.type.startsWith("sensor")||parseInt(a.areacode)==e[o].areacode&&parseInt(a.addr)==e[o].addr&&(i=!1);i&&(b.a.sendQueryDeviceStatusOne(a),e.push({areacode:parseInt(a.areacode),addr:parseInt(a.addr)}))}}}},mounted:function(){this.golbal.showButtonFloor=!0,this.golbal.showButtonShare=!1,this.golbal.showCaseTopRight="ROOM",this.golbal.menuCur="room",this.queryDevicesStatus()}},nt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mainUser main"},[t("DeviceMain",{ref:"DeviceMain",attrs:{golbal:this.golbal,mode:"FAVORITE"}})],1)},staticRenderFns:[]},lt=i("VU/8")(st,nt,!1,null,null,null).exports,ct={data:function(){return{windowHeight:window.innerHeight+"px"}},props:["golbal"],methods:{mounted:function(){this.golbal.showFooter=!1,console.log("to default")}}},rt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"main",style:"height:"+this.windowHeight+";top:0px;background:#ffffff;text-align:center"},[t("img",{staticStyle:{width:"100%",height:"100%"},attrs:{src:"static/images/default.png"}})])},staticRenderFns:[]};var ut=i("VU/8")(ct,rt,!1,function(e){i("L17K")},"data-v-599246ef",null).exports,dt={components:{DeviceMain:ot},data:function(){return{}},props:["golbal"],methods:{},mounted:function(){this.golbal.showButtonFloor=!0,this.golbal.showButtonShare=!1,this.golbal.showCaseTopRight="FLOOR",this.golbal.menuCur="room",this.$refs.DeviceMain.resetUlWidth()},updated:function(){this.$refs.DeviceMain.resetUlWidth()}},mt={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"main"},[t("DeviceMain",{ref:"DeviceMain",attrs:{golbal:this.golbal,mode:"CONTROL"}})],1)},staticRenderFns:[]},ht=i("VU/8")(dt,mt,!1,null,null,null).exports,vt=i("pFYg"),pt=i.n(vt),gt={data:function(){return{drawerBlock:!1,openingScan:!1,heightDrawerBlock:window.innerHeight-159,heightDrawerGateway:window.innerHeight-159,drawerTheme:!1,drawerTest:!1,drawerScan:!1,widthDrawerTheme:window.innerWidth,tabsTest:"tab1",showDebug:!1,formTest:{server:""}}},props:["golbal","logList"],methods:{loginClick:function(){this.$router.push({path:"/login"})},logoutClick:function(){var e=this,t=this;this.$confirm("确认退出当前用户并回到登录界面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"divUserConfirm"}).then(d()(r.a.mark(function i(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=window.localStorage).setItem("username",""),a.setItem("nickname",""),a.setItem("accessToken",""),a.setItem("refreshToken",""),a.setItem("userId",""),e.next=8,t.userLogout();case 8:case"end":return e.stop()}},i,e)}))).catch(function(e){console.log(e)})},userLogout:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).action="APP_USER_LOGOUT",i.uuid=e.golbal.myUuid,t.next=5,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 5:"SUCCESS"==(a=t.sent).data.status?(e.golbal.username="",e.golbal.nickname="",e.golbal.accessToken="",e.golbal.refreshToken="",e.golbal.projectId="",e.golbal.isMaster=0,e.golbal.projectList=[],b.a.getData(a.data.project),e.$router.push({path:"/login"})):e.$message({type:"error",message:a.data.errorMessage,duration:1e3});case 8:case"end":return t.stop()}},t,e)}))()},startDesignLogic:function(){1==this.golbal.isMaster?this.golbal.isDesignLogic?(b.a.golbal.arrDesignLogic=[],this.golbal.isDesignLogic=!1):this.golbal.isDesignLogic=!0:this.$alert("没有操作权限","提示",{confirmButtonText:"确定",callback:function(e){}})},drawerBlockClick:function(){this.golbal.drawerBlock=!0},drawerGatewayClick:function(){this.golbal.drawerGateway=!0},drawerShareListClick:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(b.a.checkIsMaster()){for(i=!1,a=0;a<e.golbal.projectListCloud.length;a++)o=e.golbal.projectListCloud[a],e.golbal.myProject.id==o.projectId&&(i=!0);i?(b.a.loadProjectShare(),e.$router.push({path:"/sharedList"})):e.$alert("请先将项目备份到云端再分享","提示",{confirmButtonText:"确定"})}else e.$alert("没有操作权限","提示",{confirmButtonText:"确定"});case 1:case"end":return t.stop()}},t,e)}))()},drawerThemeClick:function(){this.golbal.drawerTheme=!0},drawerAboutClick:function(){this.golbal.drawerAbout=!0},drawerTestClick:function(){this.golbal.drawerTest=!0},deleteUserClick:function(){this.$confirm("确认要注销并删除当前用户管理的项目?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"divUserConfirm"}).then(function(){that.deleteUser()}).catch(function(){})},deleteUser:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).action="APP_USER_DELETE",i.uuid=e.golbal.myUuid,t.next=5,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 5:"SUCCESS"==(a=t.sent).data.status?(e.golbal.username="",e.golbal.nickname="",e.golbal.accessToken="",e.golbal.refreshToken="",e.golbal.projectId="",e.golbal.isMaster=0,e.golbal.projectList=[],b.a.getData(a.data.project),e.$router.push({path:"/login"})):e.$message({type:"error",message:a.data.errorMessage,duration:1e3});case 8:case"end":return t.stop()}},t,e)}))()},scanQRCode:function(){if(null!=this.golbal.userId&&0!=this.golbal.userId){if(!this.openingScan){this.openingScan=!0;var e=this;setTimeout(function(){e.openingScan=!1},2e3);e=this;if(console.log("cordova: "+("undefined"==typeof cordova?"undefined":pt()(cordova))),"undefined"!=typeof cordova)cordova.plugins.barcodeScanner.scan(function(t){if(!t.cancelled)if(t.text.startsWith("LKGW-")){var i="192.168.0.123";if(null!=networkinterface)networkinterface.getWiFiIPAddress(function(e){console.log("IP: "+e.ip+" subnet:"+e.subnet);var t=e.ip.split(".");i=t[0]+"."+t[1]+"."+t[2]+".123"},function(e){console.log(e)});else{console.log("IP: 192.168.1.119 subnet:debug");e.connectWSBoardCast([192,168,1,119],fn)}var a=t.text.replace("LKGW-",""),o={id:1,ip:i,addr:a,addrcode:"01 ff",name:"新建网关",isBind:!1,mac:"",areacode:1,areaaddr:255};e.golbal.editing.bus=o,e.$router.push({name:"busEdit",params:{bus:o}})}else{var s=t.text.replace("linkcontrol","http");console.log(s),s.startsWith("{")&&s.endsWith("}")?b.a.scanQRCodeLocal(JSON.parse(s)):b.a.scanQrcode(s,function(t){e.$emit("onGetQRData",t)})}},function(e){alert(e)});else if("undefined"!=typeof wx&&this.golbal.WX_SDK_READY)wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(e){var t=e.resultStr.replace("linkcontrol","http");console.log(t),t.startsWith("{")&&t.endsWith("}")?b.a.scanQRCodeLocal(JSON.parse(t)):b.a.scanQrcode(t)}});else{var t={id:1,ip:"",addr:"LKGW-003e00311747373033383239".replace("LKGW-",""),addrcode:"01 ff",name:"新建网关",isBind:!1,mac:"",areacode:1,areaaddr:255};e.golbal.editing.bus=t,e.$router.push({name:"busEdit",params:{bus:t}})}}}else this.$alert("没有操作权限","提示",{confirmButtonText:"确定",callback:function(e){}})},submitTest:function(){this.golbal.testServer=this.formTest.server},deviceClick:function(){this.$router.push({path:"/device"})},secureClick:function(){b.a.checkIsMaster()?this.$router.push({path:"/secure"}):this.$alert("没有操作权限","提示",{confirmButtonText:"确定",callback:function(e){}})},projectClick:function(){this.$router.push({path:"/project"})},logicClick:function(){b.a.checkIsMaster()?this.$router.push({name:"logic",params:{project:this.golbal.myProject,mode:"EDIT"}}):this.$alert("没有操作权限","提示",{confirmButtonText:"确定",callback:function(e){}})},download:function(){var e=new FileTransfer,t=encodeURI("https://app.lk-control.com/app/link_app_137.apk");e.download(t,"cdvfile://localhost/persistent/path/to/downloads/download.apk",function(e){console.log("download complete: "+e.toURL()),cordova.plugins.fileOpener2.open(e.toURL(),"application/vnd.android.package-archive")},function(e){console.log("download error source "+e.source),console.log("download error target "+e.target),console.log("download error code"+e.code)},!1,{})},install:function(){cordova.plugins.fileOpener2.open("file:///data/user/0/com.linkscene.app/files/files/path/to/downloads/download.apk","application/vnd.android.package-archive")}},mounted:function(){this.golbal.showCaseTopRight="SHARE",this.golbal.menuCur="user",this.formTest.server=this.golbal.testServer,this.golbal.editing.activeSceneName="",this.golbal.editing.activeSecureName="",Object(_.a)()}},ft={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mainUser main"},[i("div",{staticClass:"divUserTop"},[e._m(0),e._v(" "),i("div",{staticClass:"divUserInfo"},[i("span",{staticClass:"spanUserInfo1"},[e._v(e._s(""==e.golbal.username?"LinkControl":e.golbal.username))]),e._v(" "),i("span",{staticClass:"spanUserInfo2"},[e._v(e._s(""==e.golbal.username?"临时用户":e.golbal.nickname))])]),e._v(" "),i("div",{staticClass:"divUserLogin"},[""==e.golbal.username?i("div",{staticClass:"btnUser",on:{click:function(t){return e.loginClick()}}},[e._v("登录")]):e._e(),e._v(" "),""==e.golbal.username||e.golbal.isPad?e._e():i("div",{staticClass:"btnUser",on:{click:function(t){return e.logoutClick()}}},[e._v("退出登录")]),e._v(" "),""!=e.golbal.username&&e.golbal.isPad?i("div",[i("div",{staticClass:"btnUser",on:{click:function(t){return e.logoutClick()}}},[i("i",{staticClass:"el-icon-switch-button"})])]):e._e()])]),e._v(" "),i("div",{staticClass:"divUserContent"},[i("div",{staticClass:"content"},[i("ul",[i("li",{on:{click:e.scanQRCode}},[i("i",{staticClass:"icon-scanning iconC"}),i("span",[e._v("扫一扫")]),e._m(1)]),e._v(" "),i("li",{on:{click:e.deviceClick}},[i("i",{staticClass:"el-icon-mobile-phone iconC"}),i("span",[e._v("设备列表")]),e._m(2)]),e._v(" "),i("li",{on:{click:function(t){return e.logicClick()}}},[i("i",{staticClass:"icon-wrench iconC"}),i("span",[e._v("逻辑设计")]),e._m(3)]),e._v(" "),i("li",{on:{click:e.secureClick}},[i("i",{staticClass:"el-icon-lock iconC"}),i("span",[e._v("安防设置")]),e._m(4)]),e._v(" "),e.golbal.showDebug?i("li",{on:{click:function(t){return e.drawerTestClick()}}},[i("i",{staticClass:"icon-wrench iconC"}),i("span",[e._v("调试")]),e._m(5)]):e._e(),e._v(" "),i("li",{on:{click:function(t){return e.projectClick()}}},[i("i",{staticClass:"icon-office iconC"}),i("span",[e._v("项目管理")]),e._m(6)]),e._v(" "),i("li",{on:{click:function(t){return e.deleteUserClick()}}},[i("i",{staticClass:"icon-accountfilling iconC"}),i("span",[e._v("注销账户")]),e._m(7)]),e._v(" "),i("li",{on:{click:function(t){return e.drawerAboutClick()}}},[i("i",{staticClass:"icon-home iconC"}),i("span",[e._v("关于")]),i("div",{staticClass:"divIcon"},[i("span",{staticStyle:{color:"#F0851A"}},[e._v(e._s(e.golbal.VERSION_CODE_SERVER>e.golbal.VERSION_CODE?"有新版本":""))]),i("i",{staticClass:"icon-arrow1_right"})])])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divUserFace"},[t("img",{attrs:{src:"static/images/face_man.jpg"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-arrow1_right"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-arrow1_right"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-arrow1_right"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-arrow1_right"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-arrow1_right"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-arrow1_right"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-arrow1_right"})])}]},bt=i("VU/8")(gt,ft,!1,null,null,null).exports,_t={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main",staticStyle:{height:"calc(100% - 113px)"}},[i("div",{staticClass:"divFormList"},[i("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{name:"SECURITY_IN"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"icon-home3"}),e._v(" 在家布防")]),e._v(" "),i("div",{staticClass:"divLogicList"},[i("ul",[e._l(e.formProject.securityIn,function(t){return[e.hasScene(t)?i("li",{key:t.id,class:"groupLi",on:{click:function(t){return e.newSceneClick(e.activeName)}}},[i("span",{staticClass:"spanSceneTitle"},[e._v(e._s(e.getSceneName(t)))]),i("div",{staticClass:"divIcon",staticStyle:{height:"55px","line-height":"55px"}},[i("i",{staticClass:"el-icon-arrow-right"})])]):e._e()]})],2)])]),e._v(" "),i("el-tab-pane",{attrs:{name:"SECURITY_OUT"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-lock"}),e._v(" 离家布防")]),e._v(" "),i("div",{staticClass:"divLogicList"},[i("ul",[e._l(e.formProject.securityOut,function(t){return[e.hasScene(t)?i("li",{key:t.id,class:"groupLi",on:{click:function(t){return e.newSceneClick(e.activeName)}}},[i("span",{staticClass:"spanSceneTitle"},[e._v(e._s(e.getSceneName(t)))]),i("div",{staticClass:"divIcon",staticStyle:{height:"55px","line-height":"55px"}},[i("i",{staticClass:"el-icon-arrow-right"})])]):e._e()]})],2)])])],1),e._v(" "),i("div",{staticClass:"divPlus",staticStyle:{"margin-top":"0px",color:"#f08519",position:"absolute",top:"15px",right:"5.3%"},on:{click:function(t){return e.newSceneClick(e.activeName)}}},[i("i",{staticClass:"el-icon-edit"})])],1)])},staticRenderFns:[]};var yt=i("VU/8")({data:function(){var e=this;return{isEnabled:[!0],showDialog:!1,activeName:"SECURITY_IN",formProject:{id:"",projectSummary:"",projectName:"",floors:[],securityIn:[],securityOut:[]},currentSelectLogic:null,hasScene:function(t){if(null==e.golbal.myProject)return!1;if(null==e.golbal.myProject.scenes)return!1;for(var i=0;i<e.golbal.myProject.scenes.length;i++)if(e.golbal.myProject.scenes[i].id==t.id)return!0;return!1},getSceneName:function(t){if(null==e.golbal.myProject)return"";if(null==e.golbal.myProject.scenes)return"";for(var i=0;i<e.golbal.myProject.scenes.length;i++){var a=e.golbal.myProject.scenes[i];if(a.id==t.id)return a.name}return!1}}},props:["projectEditVisible","golbal","project"],methods:{sceneClick:function(e){"EDIT"==this.mode?(this.golbal.editing.scene=e,this.golbal.editing.activeSceneName=this.activeName,this.$router.push({name:"sceneEdit",params:{scene:e}})):"SELECT"==this.mode&&(this.currentSelectLogic=e,this.golbal.editing.currentSelectLogic=e)},newSceneClick:function(){"SECURITY_IN"==this.activeName?(this.golbal.editing.securityType="SECURITY_IN",this.golbal.editing.security=this.formProject.securityIn):"SECURITY_OUT"==this.activeName&&(this.golbal.editing.securityType="SECURITY_OUT",this.golbal.editing.security=this.formProject.securityOut),this.$router.push({name:"logic",params:{scene:null,mode:"SELECT"}})}},mounted:function(){this.golbal.editing.security=null,this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.golbal.myProject;null!=e?(this.formProject.id=e.id,this.formProject.projectName=e.name,this.formProject.projectSummary=e.summary,this.formProject.scenes=e.scenes):(this.formProject.id="",this.formProject.projectName="",this.formProject.projectSummary="",this.formProject.floors=[],this.formProject.scenes=[]),this.isEnabled=[];for(var t=0;t<this.formProject.scenes.length;t++){this.isEnabled.push(!1);var i=this.formProject.scenes[t];"SECURITY_IN"!=i.sceneType&&"SECURITY_OUT"!=i.sceneType||(null==i.isEnabled&&(i.isEnabled=!1),this.isEnabled[t]=i.isEnabled)}null!=this.$route.params&&null!=this.$route.params.mode&&(this.mode=this.$route.params.mode),null==this.golbal.myProject.secureIn&&(this.golbal.myProject.secureIn=[]),null==this.golbal.myProject.secureOut&&(this.golbal.myProject.secureOut=[]),null!=this.golbal.myProject.secureIn&&(this.formProject.securityIn=this.golbal.myProject.secureIn),null!=this.golbal.myProject.secureOut&&(this.formProject.securityOut=this.golbal.myProject.secureOut),null!=this.golbal.editing.securityType&&""!=this.golbal.editing.securityType&&(this.activeName=this.golbal.editing.securityType),null!=this.golbal.editing.securityType&&""!=this.golbal.editing.securityType&&null!=this.golbal.editing.security&&("SECURITY_IN"==this.golbal.editing.securityType?this.formProject.securityIn=this.golbal.editing.security:"SECURITY_OUT"==this.golbal.editing.securityType&&(this.formProject.securityOut=this.golbal.editing.security),this.golbal.editing.securityType="",this.golbal.editing.security=null)}},_t,!1,function(e){i("FKjo")},"data-v-e2f62d04",null).exports,Ct={data:function(){return{version:"v1.0.51",aboutLogoClickCount:0}},props:["golbal"],methods:{aboutLogoClick:function(){0==this.aboutLogoClickCount&&setTimeout(function(){this.aboutLogoClickCount=0}),this.aboutLogoClickCount+=1,10==this.aboutLogoClickCount&&(this.golbal.showDebug=!0)}}},kt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divAboutLogo",staticStyle:{"margin-top":"100px"},on:{click:function(t){return e.aboutLogoClick()}}},[i("img",{attrs:{src:"static/images/about_logo.png"}})]),e._v(" "),e._m(0),e._v(" "),i("hr",{staticClass:"hrAbout"}),e._v(" "),i("div",{staticClass:"divAboutVersion"},[i("span",{staticStyle:{color:"#bdbdbd"}},[e._v(e._s(e.version))])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divAboutAppname"},[t("span",{staticStyle:{color:"#bdbdbd"}},[this._v("智慧云联")])])}]};var Et=i("VU/8")(Ct,kt,!1,function(e){i("HYWi")},"data-v-4fcc1c7c",null).exports;a.default.use(x.a,{name:"v-touch"});var Tt={data:function(){return{heightMessage:window.innerHeight-102}},props:["golbal"],methods:{messagePress:function(e){for(var t=0;t<this.golbal.messages.length;t++)this.golbal.messages[t].showDelete=!1;e.showDelete=!0},messageClick:function(e){e.showDelete&&(e.showDelete=!1)},deleteClick:function(e){for(var t=[],i=0;i<this.golbal.messages.length;i++)this.golbal.messages[i].id!=e.id&&t.push(this.golbal.messages[i]);this.golbal.messages=t}},mounted:function(){this.golbal.showButtonFloor=!1,this.golbal.showButtonShare=!1}},Dt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divMessage",style:"height:"+e.heightMessage+"px"},e._l(e.golbal.messages,function(t){return i("div",{key:t.id,staticClass:"divMessageItem",on:{click:function(i){return e.messageClick(t)}}},[i("v-touch",{staticStyle:{"touch-action":"pan-y!important"},on:{pressup:function(i){return e.messagePress(t)}}},[i("div",{staticClass:"divTitle"},[i("i",{staticClass:"icon-mail1"}),i("span",[e._v(e._s(t.title))])]),e._v(" "),i("div",{staticClass:"divDate"},[e._v(e._s(t.date))]),e._v(" "),i("div",{staticClass:"divContent"},[e._v(e._s(t.content))]),e._v(" "),t.showDelete?i("div",{staticClass:"btnDelete",on:{click:function(i){return e.deleteClick(t)}}},[i("i",{staticClass:"icon-delete1"})]):e._e()])],1)}),0),e._v(" "),i("el-backtop",{staticStyle:{bottom:"80px",right:"10px"},attrs:{target:".divMessage"}})],1)},staticRenderFns:[]},St=i("VU/8")(Tt,Dt,!1,null,null,null).exports,wt={data:function(){var e=this;return{timer:null,resendCount:0,drawerRegister:!1,drawerForget:!1,heightDrawerRegister:window.innerHeight,isAgree:!1,dialogVisible:!1,dailogHeight:.8*window.innerHeight,formLogin:{username:"",pwd:""},formRegister:{username:"",checkcode:"",pwd:"",pwd2:"",nickname:""},rulesRegister:{username:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:5,max:15,message:"长度在 11 个字符",trigger:"blur"}],checkcode:[{required:!0,message:"请输入验证码",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],pwd2:[{required:!0,message:"请输入确认密码",trigger:"blur"},{validator:function(t,i,a){i!==e.formRegister.pwd?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}]}}},props:["golbal"],methods:{loginClick:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o,s,n,c,u,d,m;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isAgree){t.next=3;break}return e.$message({message:"请勾选同意服务协议与私隐政策",type:"warning"}),t.abrupt("return");case 3:if(0!=(2&Object(_.f)())){t.next=7;break}return e.loginLocal(),t.abrupt("return");case 7:return(i={}).action="APP_CHECK_USER",i.username=e.formLogin.username,i.uuid=e.golbal.myUuid,i.pwd=e.formLogin.pwd,i.isWeixin=e.golbal.isWeixin?1:0,t.next=15,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 15:if("SUCCESS"==(a=t.sent).data.status){for(o=e,e.golbal.fullscreenLoading=!0,setTimeout(function(){o.golbal.fullscreenLoading=!1},2e3),(s=window.localStorage).setItem("username",a.data.username),s.setItem("nickname",a.data.nickname),s.setItem("accessToken",a.data.accessToken),s.setItem("refreshToken",a.data.refreshToken),n=s.getItem("loginList"),c=[],null!=n&&n.length>0&&(c=JSON.parse(n)),u=!0,d=0;d<c.length;d++)c[d].username==e.formLogin.username&&(c[d].username=e.formLogin.username,c[d].pwd=e.formLogin.pwd,u=!1);u&&(m=0,null!=a.data.userId&&(m=a.data.userId),c.push({username:e.formLogin.username,pwd:e.formLogin.pwd,userId:m})),s.setItem("loginList",l()(c)),null!=a.data.userId&&s.setItem("userId",a.data.userId),e.golbal.username=s.getItem("username"),e.golbal.nickname=s.getItem("nickname"),e.golbal.accessToken=s.getItem("accessToken"),e.golbal.userId=s.getItem("userId"),e.$router.push({path:"/room"}),null!=a.data.projectListLocal&&a.data.projectListLocal.length>0&&(e.golbal.projectList=a.data.projectListLocal),null==e.golbal.projectList&&(e.golbal.projectList=[]),e.golbal.projectList,null!=a.data.project&&b.a.getData(a.data.project)}else e.$message({type:"error",message:a.data.errorMessage,duration:1e3});case 18:case"end":return t.stop()}},t,e)}))()},loginLocal:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o,s,n,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("to login local"),(i={}).username=e.formLogin.username,i.pwd=e.formLogin.pwd,a=window.localStorage,o=a.getItem("loginList"),s=[],null!=o&&o.length>0&&(s=JSON.parse(o)),n=0;case 9:if(!(n<s.length)){t.next=27;break}if(i.username!=s[n].username||i.pwd!=s[n].pwd){t.next=24;break}return a.setItem("username",i.username),null!=s[n].userId&&a.setItem("userId",s[n].userId),e.golbal.username=a.getItem("username"),e.golbal.nickname=a.getItem("nickname"),e.golbal.userId=a.getItem("userId"),e.$router.push({path:"/room"}),t.next=19,b.a.readLocalSystem("projectList"+e.golbal.userId);case 19:if(e.golbal.projectList=t.sent,null==e.golbal.projectList&&(e.golbal.projectList=[]),(l=e.golbal.projectList).length>0)for(n=0;n<l.length;n++)l[n].localUserId==e.golbal.userId&&l[n].isDefault&&b.a.getData(l[n]);return t.abrupt("return");case 24:n++,t.next=9;break;case 27:e.$message({type:"error",message:"用户名或者密码错误",duration:1e3});case 28:case"end":return t.stop()}},t,e)}))()},registerClick:function(){this.drawerRegister=!0},forgetClick:function(){this.drawerForget=!0},checkcodeClick:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.resendCount>0)){t.next=2;break}return t.abrupt("return");case 2:if(11==e.formRegister.username.length){t.next=5;break}return e.$message({type:"error",message:"输入的手机号长度不对",duration:1e3}),t.abrupt("return");case 5:return(i={}).action="APP_SEND_SMS_REG",i.mobile=e.formRegister.username,t.next=10,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 10:if("SUCCESS"!=(a=t.sent).data.status){t.next=16;break}e.resendCount=60,e.timer=setInterval(e.timerTick,1e3),t.next=18;break;case 16:return e.$message({type:"error",message:a.data.errorMessage,duration:1e3}),t.abrupt("return");case 18:case"end":return t.stop()}},t,e)}))()},registerSubmit:function(){var e=this;this.$refs.formRegister.validate(function(t){if(!t)return console.log("提交注册数据失败"),!1;e.saveUser()})},toDemo:function(){this.$router.push({path:"/room"})},forgetSubmit:function(){var e=this;this.$refs.formRegister.validate(function(t){if(!t)return console.log("提交注册数据失败"),!1;e.resetPassword()})},saveUser:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).action="APP_SAVE_USER",i.username=e.formRegister.username,i.pwd=e.formRegister.pwd,i.checkcode=e.formRegister.checkcode,i.nickname=e.formRegister.nickname,t.next=8,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 8:"SUCCESS"==(a=t.sent).data.status?(e.$message({type:"success",message:"恭喜您，用户注册成功！",duration:1e3}),e.formLogin.username=e.formRegister.username,e.drawerRegister=!1,e.formRegister.username="",e.formRegister.checkcode="",e.formRegister.pwd="",e.formRegister.pwd2="",e.formRegister.nickname="",e.$refs.formRegister.clearValidate(),e.$refs.inputPwd.focus()):e.$message({type:"error",message:a.data.errorMessage,duration:1e3});case 11:case"end":return t.stop()}},t,e)}))()},resetPassword:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).action="APP_RESET_PASSWORD",i.username=e.formRegister.username,i.pwd=e.formRegister.pwd,i.checkcode=e.formRegister.checkcode,t.next=7,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 7:"SUCCESS"==(a=t.sent).data.status?(e.$message({type:"success",message:"成功修改密码",duration:1e3}),e.drawerForget=!1,e.formRegister.username="",e.formRegister.checkcode="",e.formRegister.pwd="",e.formRegister.pwd2="",e.$refs.formRegister.clearValidate(),e.$refs.inputPwd.focus()):e.$message({type:"error",message:a.data.errorMessage,duration:1e3});case 10:case"end":return t.stop()}},t,e)}))()},timerTick:function(){this.resendCount--,this.resendCount<=0&&(clearInterval(this.timer),this.timer=null),console.log(this.resendCount)}},mounted:function(){this.golbal.showFooter=!1,this.golbal.showCaseTopRight=""}},It={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"divLogin"},[i("div",{staticClass:"divLoginTitle"},[e._v("登录")]),e._v(" "),i("el-form",{ref:"formLogin",attrs:{model:e.formLogin,"label-width":"0px"}},[i("el-form-item",{attrs:{label:""}},[i("el-input",{attrs:{placeholder:"输入用户名",clearable:""},model:{value:e.formLogin.username,callback:function(t){e.$set(e.formLogin,"username",t)},expression:"formLogin.username"}})],1),e._v(" "),i("el-form-item",{attrs:{label:""}},[i("el-input",{ref:"inputPwd",attrs:{placeholder:"密码","show-password":"",clearable:""},model:{value:e.formLogin.pwd,callback:function(t){e.$set(e.formLogin,"pwd",t)},expression:"formLogin.pwd"}})],1),e._v(" "),i("el-form-item",[i("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.loginClick}},[e._v("登 录")])],1),e._v(" "),i("el-form-item",[i("el-checkbox",{staticStyle:{float:"left"},model:{value:e.isAgree,callback:function(t){e.isAgree=t},expression:"isAgree"}}),i("div",{staticClass:"btnRegisterL",staticStyle:{height:"40px","line-height":"40px",border:"none","text-decoration":"underline","margin-left":"5px"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("同意服务协议与私隐政策")])],1),e._v(" "),i("el-form-item",[i("div",{staticClass:"btnRegisterL",on:{click:function(t){return e.forgetClick()}}},[e._v("忘记密码")]),e._v(" "),i("div",{staticClass:"btnRegisterC",on:{click:function(t){return e.toDemo()}}},[e._v("游客体验")]),e._v(" "),i("div",{staticClass:"btnRegisterR",on:{click:function(t){return e.registerClick()}}},[e._v("现在注册")])])],1)],1),e._v(" "),i("div",{staticClass:"divRegister",style:"display:"+(e.drawerRegister?"":"none")},[i("el-form",{ref:"formRegister",attrs:{model:e.formRegister,rules:e.rulesRegister,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"手机号",prop:"username"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formRegister.username,callback:function(t){e.$set(e.formRegister,"username",t)},expression:"formRegister.username"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"验证码",prop:"checkcode"}},[i("el-input",{staticStyle:{width:"45%",float:"left"},attrs:{clearable:""},model:{value:e.formRegister.checkcode,callback:function(t){e.$set(e.formRegister,"checkcode",t)},expression:"formRegister.checkcode"}}),e._v(" "),i("div",{class:(null!=e.timer?"btnCheckcodeDisabled ":"")+"btnCheckcode",on:{click:function(t){return e.checkcodeClick()}}},[e._v("获取验证码"+e._s(null!=e.timer?"("+e.resendCount+")":""))])],1),e._v(" "),i("el-form-item",{attrs:{label:"登录密码",prop:"pwd"}},[i("el-input",{attrs:{"show-password":"",clearable:""},model:{value:e.formRegister.pwd,callback:function(t){e.$set(e.formRegister,"pwd",t)},expression:"formRegister.pwd"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"确认密码",prop:"pwd2"}},[i("el-input",{attrs:{"show-password":"",clearable:""},model:{value:e.formRegister.pwd2,callback:function(t){e.$set(e.formRegister,"pwd2",t)},expression:"formRegister.pwd2"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"昵称"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formRegister.nickname,callback:function(t){e.$set(e.formRegister,"nickname",t)},expression:"formRegister.nickname"}})],1),e._v(" "),i("el-form-item",[i("el-checkbox",{staticStyle:{float:"left"},model:{value:e.isAgree,callback:function(t){e.isAgree=t},expression:"isAgree"}}),i("div",{staticClass:"btnRegisterL",staticStyle:{height:"40px","line-height":"40px",border:"none","text-decoration":"underline","margin-left":"5px"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("同意服务协议与私隐政策")])],1),e._v(" "),i("el-button",{staticStyle:{width:"49%","margin-left":"25%","margin-top":"30px"},attrs:{type:"primary"},on:{click:function(t){return e.registerSubmit()}}},[e._v("确 定")]),e._v(" "),i("el-button",{staticStyle:{width:"49%","margin-left":"25%","margin-top":"30px"},attrs:{type:"primary"},on:{click:function(t){e.drawerRegister=!1}}},[e._v("取消")])],1)],1),e._v(" "),i("div",{staticClass:"divRegister",style:"display:"+(e.drawerForget?"":"none")},[i("el-form",{ref:"formRegister",attrs:{model:e.formRegister,rules:e.rulesRegister,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"手机号",prop:"username"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formRegister.username,callback:function(t){e.$set(e.formRegister,"username",t)},expression:"formRegister.username"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"验证码",prop:"checkcode"}},[i("el-input",{staticStyle:{width:"45%",float:"left"},attrs:{clearable:""},model:{value:e.formRegister.checkcode,callback:function(t){e.$set(e.formRegister,"checkcode",t)},expression:"formRegister.checkcode"}}),e._v(" "),i("div",{class:(null!=e.timer?"btnCheckcodeDisabled ":"")+"btnCheckcode",on:{click:function(t){return e.checkcodeClick()}}},[e._v("获取验证码"+e._s(null!=e.timer?"("+e.resendCount+")":""))])],1),e._v(" "),i("el-form-item",{attrs:{label:"新密码",prop:"pwd"}},[i("el-input",{attrs:{"show-password":"",clearable:""},model:{value:e.formRegister.pwd,callback:function(t){e.$set(e.formRegister,"pwd",t)},expression:"formRegister.pwd"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"确认密码",prop:"pwd2"}},[i("el-input",{attrs:{"show-password":"",clearable:""},model:{value:e.formRegister.pwd2,callback:function(t){e.$set(e.formRegister,"pwd2",t)},expression:"formRegister.pwd2"}})],1),e._v(" "),i("el-button",{staticStyle:{width:"49%","margin-left":"25%","margin-top":"30px"},attrs:{type:"primary"},on:{click:function(t){return e.forgetSubmit()}}},[e._v("确 定")]),e._v(" "),i("el-button",{staticStyle:{width:"49%","margin-left":"25%","margin-top":"30px"},attrs:{type:"primary"},on:{click:function(t){e.drawerForget=!1}}},[e._v("取消")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"服务协议与私隐政策",visible:e.dialogVisible,width:"90%",top:"5vh"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("iframe",{attrs:{src:"http://www.lk-control.com/private.html",height:e.dailogHeight}})])],1)},staticRenderFns:[]},jt=i("VU/8")(wt,It,!1,null,null,null).exports,Ot={data:function(){return{showDialog:!1,formDevice:{id:"",deviceType:"",type:"",icon:"",addr:"",areacode:"",roomId:"",busId:"",panel_name:""},rulesDevice:{panel_name:[{required:!0,message:"请输入面板名称",trigger:"blur"}],areacode:[{required:!0,message:"请输入区域码",trigger:"blur"}],addr:[{required:!0,message:"请输入地址码",trigger:"blur"}],roomId:[{required:!0,message:"请选择楼层房间",trigger:"change"}]},optionsRooms:[],optionsBuses:[],optionsSensorType:[{label:"传感器面板",value:"sensor_panel"},{label:"脉冲量",value:"sensor_pules"},{label:"开关量",value:"sensor_switch"},{label:"温度",value:"sensor_temperature"},{label:"湿度",value:"sensor_humidity"},{label:"亮度",value:"sensor_brightness"},{label:"PM2.5",value:"sensor_pm25"},{label:"甲醛",value:"sensor_hcho"},{label:"二氧化碳",value:"sensor_co2"},{label:"燃气",value:"sensor_ch4"}],optionsIcons:[{label:"无",value:""},{label:"icon-ls_1_light",value:"icon-ls_1_light"},{label:"icon-ls_2_heating",value:"icon-ls_2_heating"},{label:"icon-ls_3_media",value:"icon-ls_3_media"},{label:"icon-ls_4_dimmer",value:"icon-ls_4_dimmer"},{label:"icon-ls_5_home",value:"icon-ls_5_home"},{label:"icon-ls_6_video",value:"icon-ls_6_video"},{label:"icon-ls_7_ac",value:"icon-ls_7_ac"},{label:"icon-ls_8_spotlight",value:"icon-ls_8_spotlight"},{label:"icon-ls_9_on",value:"icon-ls_9_on"},{label:"icon-ls_10_meeting",value:"icon-ls_10_meeting"},{label:"icon-ls_11_tv",value:"icon-ls_11_tv"},{label:"icon-ls_12_blind",value:"icon-ls_12_blind"},{label:"icon-ls_13_roller",value:"icon-ls_13_roller"},{label:"icon-ls_14_window_pusher",value:"icon-ls_14_window_pusher"},{label:"icon-ls_15_window_screening",value:"icon-ls_15_window_screening"},{label:"icon-ls_16_curtain",value:"icon-ls_16_curtain"},{label:"icon-ls_17_lamp",value:"icon-ls_17_lamp"},{label:"icon-ls_18_droplight",value:"icon-ls_18_droplight"},{label:"icon-ls_19_heater",value:"icon-ls_19_heater"},{label:"icon-ls_20_leisure",value:"icon-ls_20_leisure"},{label:"icon-ls_21_thermostat",value:"icon-ls_21_thermostat"},{label:"icon-ls_22_new_trend",value:"icon-ls_22_new_trend"},{label:"icon-ls_23_curtain",value:"icon-ls_23_curtain"},{label:"icon-ls_24_body",value:"icon-ls_24_body"},{label:"icon-ls_25_toplight",value:"icon-ls_25_toplight"},{label:"icon-ls_26_go_off_work",value:"icon-ls_26_go_off_work"},{label:"icon-ls_27_office",value:"icon-ls_27_office"},{label:"icon-ls_32_leave",value:"icon-ls_32_leave"},{label:"icon-ls_33_music",value:"icon-ls_33_music"},{label:"icon-ls_34_downlight",value:"icon-ls_34_downlight"},{label:"icon-ls_35_work",value:"icon-ls_35_work"},{label:"icon-ls_36_cloakroom",value:"icon-ls_36_cloakroom"},{label:"icon-ls_37_stair_lamps",value:"icon-ls_37_stair_lamps"}]}},props:["deviceEditVisible","golbal","device"],methods:{handleClose:function(){this.$emit("changeShow","false")},loadSelectOptionRooms:function(){for(var e=[],t=0;t<this.golbal.blockCur.floors.length;t++)for(var i=0;i<this.golbal.blockCur.floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e},loadSelectOptionBuses:function(){for(var e=[],t=0;t<this.golbal.myProject.buses.length;t++){var i={};i.value=this.golbal.myProject.buses[t].addr,i.label=this.golbal.myProject.buses[t].name,e.push(i)}this.optionsBuses=e},submitFormDevice:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveDevice()})},saveDevice:function(){var e={};e.id=this.formDevice.id,null!=this.formDevice.deviceType?e.deviceType=this.formDevice.deviceType:e.deviceType=this.formDevice.type,e.name=this.formDevice.panel_name,e.panel_name=this.formDevice.panel_name,e.addr=this.formDevice.addr,e.areacode=this.formDevice.areacode,e.channel=this.formDevice.channel,e.icon=this.formDevice.icon,e.roomId=this.formDevice.roomId,e.busId=this.formDevice.busId,e.accessToken=this.golbal.accessToken,e.projectId=this.golbal.projectId,e.isFavorite=this.formDevice.isFavorite;var t=this.golbal.myProject;if(null!=t){if(""!=e.id)for(var i=0;i<t.blocks[0].floors.length;i++)for(var a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(null!=t.blocks[0].floors[i].rooms[a].devices)for(var o=0;o<t.blocks[0].floors[i].rooms[a].devices.length;o++)t.blocks[0].floors[i].rooms[a].devices[o].id==e.id&&t.blocks[0].floors[i].rooms[a].devices.splice(o,1);for(i=0;i<t.blocks[0].floors.length;i++)for(a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(t.blocks[0].floors[i].rooms[a].id==e.roomId){var s={};switch(s.deviceType=e.deviceType,s.type=e.deviceType,""==e.id?s.id=b.a.uuid():s.id=e.id,s.deviceType){case"ac":s.type="ac",s.value=26;break;case"heat":s.type="heating",s.value=26;break;case"air":s.type="fan";break;case"combo":s.type="combo"}s.name=e.name,s.panel_name=e.panel_name,s.addr=e.addr,s.areacode=e.areacode,s.channel=e.channel,s.icon=e.icon,s.roomId=e.roomId,s.selected=!1,s.isFavorite=e.isFavorite,s.busId=e.busId,"combo"==s.deviceType&&(s.ac={isOn:!1,value:26,mode:"制冷",fan:3,lock:0},s.heat={isOn:!1,value:26,mode:"制冷",fan:3,lock:0},s.air={isOn:!1,value:26,mode:"制冷",fan:3,lock:0}),t.blocks[0].floors[i].rooms[a].devices.push(s)}b.a.saveLocalSystem("projectList"+this.golbal.userId+".json",l()(this.golbal.projectList)),this.$message({type:"success",message:"成功保存设备!",duration:1e3}),b.a.getData(t),this.showDialog=!1,this.golbal.showSwitchPanel=!1}else this.$message({type:"error",message:"当前没有选定项目",duration:1e3})},deleteFromDevice:function(){var e=this;this.$confirm("确认要删除当前设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o,s,n,c;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a={}).id=(i=e).formDevice.id,null!=(o=e.golbal.myProject)){t.next=7;break}return e.$message({type:"error",message:"当前没有选定项目",duration:1e3}),t.abrupt("return");case 7:if(""!=a.id)for(s=0;s<o.blocks[0].floors.length;s++)for(n=0;n<o.blocks[0].floors[s].rooms.length;n++)for(c=0;c<o.blocks[0].floors[s].rooms[n].devices.length;c++)o.blocks[0].floors[s].rooms[n].devices[c].id==a.id&&o.blocks[0].floors[s].rooms[n].devices.splice(c,1);b.a.saveLocalSystem("projectList"+e.golbal.userId+".json",l()(e.golbal.projectList)),i.$message({type:"success",message:"删除成功!",duration:1e3}),b.a.getData(o),i.showDialog=!1,i.golbal.showSwitchPanel=!1;case 13:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})}},mounted:function(){this.loadSelectOptionRooms(),this.loadSelectOptionBuses()},watch:{deviceEditVisible:function(e,t){this.showDialog=this.deviceEditVisible,this.showDialog&&(this.formDevice=this.device)}}},Pt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"添加设备",visible:e.showDialog,width:"90%",modal:!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleClose}},[i("div",{staticClass:"divFormAddDevice"},[i("el-form",{ref:"formDevice",attrs:{model:e.formDevice,rules:e.rulesDevice,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"设备名称",prop:"panel_name"}},[i("el-input",{model:{value:e.formDevice.panel_name,callback:function(t){e.$set(e.formDevice,"panel_name",t)},expression:"formDevice.panel_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"楼层房间",prop:"roomId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formDevice.roomId,callback:function(t){e.$set(e.formDevice,"roomId",t)},expression:"formDevice.roomId"}},e._l(e.optionsRooms,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"网关",prop:"busId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formDevice.busId,callback:function(t){e.$set(e.formDevice,"busId",t)},expression:"formDevice.busId"}},e._l(e.optionsBuses,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"区域地址",prop:"areacode"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:255},model:{value:e.formDevice.areacode,callback:function(t){e.$set(e.formDevice,"areacode",t)},expression:"formDevice.areacode"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备地址",prop:"addr"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:255},model:{value:e.formDevice.addr,callback:function(t){e.$set(e.formDevice,"addr",t)},expression:"formDevice.addr"}})],1),e._v(" "),(null==e.formDevice.type?e.formDevice.deviceType:e.formDevice.type).startsWith("sensor")?i("el-form-item",{attrs:{label:"通道地址",prop:"channel"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:255},model:{value:e.formDevice.channel,callback:function(t){e.$set(e.formDevice,"channel",t)},expression:"formDevice.channel"}})],1):e._e(),e._v(" "),(null==e.formDevice.type?e.formDevice.deviceType:e.formDevice.type).startsWith("sensor")?i("el-form-item",{attrs:{label:"传感器类型",prop:"channel"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formDevice.type,callback:function(t){e.$set(e.formDevice,"type",t)},expression:"formDevice.type"}},e._l(e.optionsSensorType,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"通道图标",prop:"icon"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formDevice.icon,callback:function(t){e.$set(e.formDevice,"icon",t)},expression:"formDevice.icon"}},e._l(e.optionsIcons,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[""!=t.value?i("i",{class:t.label,staticStyle:{"font-size":"1.5em"}}):i("i",{staticStyle:{"font-size":"1.5em"}},[e._v("无")])])}),1)],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{height:"20px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteFromDevice()}}},[e._v("删 除")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitFormDevice("formDevice")}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]},Rt=i("VU/8")(Ot,Pt,!1,null,null,null).exports,xt={data:function(){return{showDialog:!1,formYingshi:{id:"",name:"",deviceSerial:"",validateCode:"",roomId:"",brand:"",username:"",password:"",ip:""},optionsRooms:[],cameraBrand:[{label:"海康",value:"HAI_KANG"},{label:"大华",value:"DA_HUA"},{label:"萤石",value:"YING_SHI"}]}},props:["deviceEditVisible","golbal","device"],methods:{changeBrand:function(){console.log(this.formYingshi.brand)},handleClose:function(){this.$emit("changeShow","false")},loadSelectOptionRooms:function(){for(var e=[],t=0;t<this.golbal.blockCur.floors.length;t++)for(var i=0;i<this.golbal.blockCur.floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e},addYingshi:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_ADD_DEVICE_YS",a.deviceName=i.formYingshi.name,a.deviceSerial=i.formYingshi.deviceSerial,a.validateCode=i.formYingshi.validateCode,a.roomId=i.formYingshi.roomId,a.accessToken=i.golbal.accessToken,a.projectId=i.golbal.projectId,t.next=11,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 11:"SUCCESS"==(o=t.sent).data.status?i.saveDevice():e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 14:case"end":return t.stop()}},t,e)}))()},saveDevice:function(){var e={};e.id=this.formYingshi.id,e.deviceType="camera",e.name=this.formYingshi.name,e.panel_name=this.formYingshi.name,e.roomId=this.formYingshi.roomId,e.ip=this.formYingshi.ip,e.username=this.formYingshi.username,e.password=this.formYingshi.password,e.deviceSerial=this.formYingshi.deviceSerial,e.validateCode=this.formYingshi.validateCode,e.brand=this.formYingshi.brand,e.isFavorite=!1;var t=this.golbal.myProject;if(null!=t){if(""!=e.id)for(var i=0;i<t.blocks[0].floors.length;i++)for(var a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(null!=t.blocks[0].floors[i].rooms[a].devices)for(var o=0;o<t.blocks[0].floors[i].rooms[a].devices.length;o++)t.blocks[0].floors[i].rooms[a].devices[o].id==e.id&&t.blocks[0].floors[i].rooms[a].devices.splice(o,1);for(i=0;i<t.blocks[0].floors.length;i++)for(a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(t.blocks[0].floors[i].rooms[a].id==e.roomId){var s={};s.deviceType=e.deviceType,s.type=e.deviceType,""==e.id?s.id=b.a.uuid():s.id=e.id,s.name=e.name,s.panel_name=e.panel_name,s.roomId=e.roomId,s.ip=e.ip,s.username=e.username,s.password=e.password,s.selected=!1,s.brand=e.brand,s.isFavorite=e.isFavorite,s.icon="icon-ls_3_media",t.blocks[0].floors[i].rooms[a].devices.push(s)}b.a.saveLocalSystem("projectList"+this.golbal.userId+".json",l()(this.golbal.projectList)),this.$message({type:"success",message:"成功保存设备!",duration:1e3}),b.a.getData(t),this.showDialog=!1,this.golbal.showSwitchPanel=!1}else this.$message({type:"error",message:"当前没有选定项目",duration:1e3})},deleteFromDevice:function(){var e=this;this.$confirm("确认要删除当前设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o,s,n,c;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a={}).id=(i=e).formYingshi.id,null!=(o=e.golbal.myProject)){t.next=7;break}return e.$message({type:"error",message:"当前没有选定项目",duration:1e3}),t.abrupt("return");case 7:if(""!=a.id)for(s=0;s<o.blocks[0].floors.length;s++)for(n=0;n<o.blocks[0].floors[s].rooms.length;n++)for(c=0;c<o.blocks[0].floors[s].rooms[n].devices.length;c++)o.blocks[0].floors[s].rooms[n].devices[c].id==a.id&&o.blocks[0].floors[s].rooms[n].devices.splice(c,1);b.a.saveLocalSystem("projectList"+e.golbal.userId+".json",l()(e.golbal.projectList)),i.$message({type:"success",message:"删除成功!",duration:1e3}),b.a.getData(o),i.showDialog=!1,i.golbal.showSwitchPanel=!1;case 13:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})}},mounted:function(){this.loadSelectOptionRooms()},watch:{deviceEditVisible:function(e,t){this.showDialog=this.deviceEditVisible,this.showDialog&&(this.formYingshi=this.device)}}},At={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"添加摄像头",visible:e.showDialog,width:"90%",modal:!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleClose}},[i("div",{staticClass:"divFormAddDevice"},[i("el-form",{ref:"formYingshi",attrs:{model:e.formYingshi,"label-width":"100px","label-position":"top","inline-message":!0}},[i("el-form-item",{attrs:{label:"设备名称",prop:"deviceName"}},[i("el-input",{model:{value:e.formYingshi.name,callback:function(t){e.$set(e.formYingshi,"name",t)},expression:"formYingshi.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeBrand},model:{value:e.formYingshi.brand,callback:function(t){e.$set(e.formYingshi,"brand",t)},expression:"formYingshi.brand"}},e._l(e.cameraBrand,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),"YING_SHI"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"设备序列号",prop:"deviceSerial"}},[i("el-input",{model:{value:e.formYingshi.deviceSerial,callback:function(t){e.$set(e.formYingshi,"deviceSerial",t)},expression:"formYingshi.deviceSerial"}})],1):e._e(),e._v(" "),"YING_SHI"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"设备验证码",prop:"validateCode"}},[i("el-input",{model:{value:e.formYingshi.validateCode,callback:function(t){e.$set(e.formYingshi,"validateCode",t)},expression:"formYingshi.validateCode"}})],1):e._e(),e._v(" "),"HAI_KANG"==e.formYingshi.brand||"DA_HUA"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"IP地址",prop:"ip"}},[i("el-input",{model:{value:e.formYingshi.ip,callback:function(t){e.$set(e.formYingshi,"ip",t)},expression:"formYingshi.ip"}})],1):e._e(),e._v(" "),"HAI_KANG"==e.formYingshi.brand||"DA_HUA"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"用户名",prop:"username"}},[i("el-input",{model:{value:e.formYingshi.username,callback:function(t){e.$set(e.formYingshi,"username",t)},expression:"formYingshi.username"}})],1):e._e(),e._v(" "),"HAI_KANG"==e.formYingshi.brand||"DA_HUA"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{model:{value:e.formYingshi.password,callback:function(t){e.$set(e.formYingshi,"password",t)},expression:"formYingshi.password"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"楼层房间",prop:"roomId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formYingshi.roomId,callback:function(t){e.$set(e.formYingshi,"roomId",t)},expression:"formYingshi.roomId"}},e._l(e.optionsRooms,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{height:"20px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteFromDevice()}}},[e._v("删 除")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveDevice()}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]},Lt=i("VU/8")(xt,At,!1,null,null,null).exports,Nt={data:function(){return{showDialog:!1,formBus:{id:"",name:"",ip:"",mac:"",addr:"",addrcode:"01 ff",roomId:"",rfid:"",relay:""},rulesBus:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]},rooms:[{name:"101",id:1},{name:"102",id:2},{name:"103",id:3},{name:"104",id:4}],optionsRooms:[]}},props:["deviceEditVisible","golbal","device"],methods:{handleClose:function(){this.$emit("changeShow","false")},saveBus:function(e,t){if(null!=this.formBus.roomId&&0!=this.formBus.roomId.length){var i=this,a=b.a.hexStringToBytes(i.formBus.addrcode),o={};o.id=i.formBus.id,o.accessToken=i.golbal.accessToken,o.projectId=i.golbal.myProject.id,o.name=i.formBus.name,o.addr=i.formBus.addr,o.roomId=i.formBus.roomId,a.length>0&&(o.areacode=a[0],o.areaaddr=a[1]),o.addrcode=i.formBus.addrcode,o.mac=i.formBus.mac,o.ip=i.formBus.ip,null!=e&&1==e&&(o.rfid=i.formBus.rfid),null!=t&&1==t&&(o.relay=i.formBus.relay),null!=this.golbal.editing.project&&(o.projectId=this.golbal.editing.project.id);var s=this.golbal.myProject;if(null!=s){var n=null,l=!1;if(null!=s.buses)for(var c=0;c<s.buses.length;c++){var r=s.buses[c];r.addr==o.addr&&(n=r,l=!0)}l?(n.ip=o.ip,n.addr=o.addr,n.ws_url="ws://"+o.ip+":6432/",n.mac=o.mac,n.name=o.name,n.areacode=o.areacode,n.areaaddr=o.areaaddr,n.roomId=o.roomId,null!=e&&1==e&&(n.rfid=o.rfid),null!=t&&1==t&&(n.relay=o.relay),b.a.saveProject(s)):((n={id:b.a.uuid(),name:o.name,ip:o.ip,port:"",ws_url:"ws://"+o.ip+":6432/",mac:o.name,addr:o.addr,isOnline:!0,isScan:!1}).areacode=o.areacode,n.areaaddr=o.areaaddr,n.roomId=o.roomId,null!=e&&1==e&&(n.rfid=o.rfid),null!=t&&1==t&&(n.relay=o.relay),null==s.buses&&(s.buses=[]),s.buses.push(n),b.a.saveProject(s)),null==e&&null==t&&this.$message({message:"成功保存网关！",type:"success",duration:1e3}),null!=this.golbal.editing.scanBusResult&&this.golbal.editing.scanBusResult.length>0&&this.golbal.editing.scanBusResult.indexOf(this.$route.params.bus)>-1&&this.golbal.editing.scanBusResult.splice(this.golbal.editing.scanBusResult.indexOf(this.$route.params.bus),1),null!=s&&b.a.getData(s,function(){if(null!=i.golbal.myProject.buses&&i.golbal.myProject.buses.length>0)for(var e=0;e<i.golbal.myProject.buses.length;e++){var t=i.golbal.myProject.buses[e];t.addr==i.formBus.addr&&Object(_.e)(S.a.receiveData,t.ws_url,function(){w.a.sendSaveBusUserid(t,i.golbal.userId)})}}),null==e&&null==t&&(this.showDialog=!1)}else this.$message({type:"error",message:"当前没有选定项目",duration:1e3})}else this.$message({type:"error",message:"请选择房间",duration:1e3})},deleteBus:function(){var e=this;this.$confirm("确认要删除该网关？?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e,i={};i.busId=t.formBus.id,i.addr=t.formBus.addr,null!=e.golbal.editing.project?i.projectId=e.golbal.editing.project.id:null!=e.golbal.myProject&&(i.projectId=e.golbal.myProject.id);var a=e.golbal.myProject;if(null!=a){var o=null;if(null!=a.buses)for(var s=0;s<a.buses.length;s++){var n=a.buses[s];n.addr==i.addr&&(o=n,!0)}a.buses.splice(a.buses.indexOf(o),1),w.a.sendSaveBusUserid(o,0),setTimeout(function(){Object(_.c)("ws://"+t.formBus.ip+":6432/"),t.$message({type:"success",message:"删除成功!",duration:1e3}),b.a.saveProject(a),b.a.getData(a,function(){}),t.showDialog=!1},500)}else e.$message({type:"error",message:"当前没有选定项目",duration:1e3})}).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})},loadSelectOptionRooms:function(){for(var e=[],t=0;t<this.golbal.blockCur.floors.length;t++)for(var i=0;i<this.golbal.blockCur.floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e},loadSelectOptionBuses:function(){for(var e=[],t=0;t<this.golbal.myProject.buses.length;t++){var i={};i.value=this.golbal.myProject.buses[t].addr,i.label=this.golbal.myProject.buses[t].name,e.push(i)}this.optionsBuses=e},sendRFID:function(){if(null!=this.device){w.a.sendGWRFID(this.device,this.formBus.rfid),this.golbal.waitingBusReturn=!0;var e=this;setTimeout(function(){e.golbal.waitingBusReturn?(e.golbal.waitingBusReturn=!1,e.$message({message:"发送失败",type:"error",duration:1e3})):(e.$message({message:"修改成功",type:"success",duration:1e3}),e.saveBus(1,null))},1e3)}},sendRelay:function(){if(null!=this.device){w.a.sendGWRelay(this.device,this.formBus.relay),this.golbal.waitingBusReturn=!0;var e=this;setTimeout(function(){e.golbal.waitingBusReturn?(e.golbal.waitingBusReturn=!1,e.$message({message:"发送失败",type:"error",duration:1e3})):(e.$message({message:"修改成功",type:"success",duration:1e3}),e.saveBus(null,1))},1e3)}}},mounted:function(){this.loadSelectOptionRooms()},watch:{deviceEditVisible:function(e,t){if(this.showDialog=this.deviceEditVisible,this.showDialog){this.formBus=JSON.parse(l()(this.device)),this.formBus.rfid=null==this.device.rfid?"":this.device.rfid,this.formBus.relay=null==this.device.relay?"":this.device.relay;var i=[this.device.areacode,this.device.areaaddr];this.formBus.addrcode=b.a.bytes2hex(i)}}}},Vt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"添加网关",visible:e.showDialog,width:"90%",modal:!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleClose}},[i("div",{staticClass:"divFormAddDevice"},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("el-form",{ref:"formDevice",attrs:{model:e.formBus,rules:e.rulesBus,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"网关名称",prop:"name"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formBus.name,callback:function(t){e.$set(e.formBus,"name",t)},expression:"formBus.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"IP",prop:"ip"}},[i("el-input",{model:{value:e.formBus.ip,callback:function(t){e.$set(e.formBus,"ip",t)},expression:"formBus.ip"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"UID地址",prop:"addr"}},[i("el-input",{attrs:{readonly:""},model:{value:e.formBus.addr,callback:function(t){e.$set(e.formBus,"addr",t)},expression:"formBus.addr"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备地址",prop:"addrcode"}},[i("el-input",{model:{value:e.formBus.addrcode,callback:function(t){e.$set(e.formBus,"addrcode",t)},expression:"formBus.addrcode"}})],1),e._v(" "),e.formBus.id.length>0?i("el-form-item",{attrs:{label:"无线频道"}},[i("el-select",{staticStyle:{width:"calc(100% - 46px)","margin-right":"2px","margin-top":"1px",float:"left"},attrs:{placeholder:"选择无线频道"},model:{value:e.formBus.rfid,callback:function(t){e.$set(e.formBus,"rfid",t)},expression:"formBus.rfid"}},[i("el-option",{attrs:{label:"0",value:"0"}}),e._v(" "),e._l(40,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})],2),e._v(" "),i("el-button",{attrs:{icon:"el-icon-s-promotion"},on:{click:e.sendRFID}})],1):e._e(),e._v(" "),e.formBus.id.length>0?i("el-form-item",{attrs:{label:"中继使能"}},[i("el-select",{staticStyle:{width:"calc(100% - 46px)","margin-right":"2px","margin-top":"1px",float:"left"},attrs:{placeholder:"设置中继使能"},model:{value:e.formBus.relay,callback:function(t){e.$set(e.formBus,"relay",t)},expression:"formBus.relay"}},[i("el-option",{attrs:{label:"关闭",value:"0"}}),e._v(" "),i("el-option",{attrs:{label:"启动",value:"1"}})],1),e._v(" "),i("el-button",{attrs:{icon:"el-icon-s-promotion"},on:{click:e.sendRelay}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"房间",prop:"roomId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formBus.roomId,callback:function(t){e.$set(e.formBus,"roomId",t)},expression:"formBus.roomId"}},e._l(e.optionsRooms,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{height:"20px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteBus()}}},[e._v("删 除")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveBus()}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]},Mt=i("VU/8")(Nt,Vt,!1,null,null,null).exports,Bt={data:function(){var e=this;return{showDialog:!1,formDevice:{id:"",deviceType:"",channel:"1",icon:"",name:"",addr:"",areacode:"",roomId:"",busId:"",panel_name:"",channelList:[],isExpend:!1},formDevice2:{id:"",addr:"1",areacode:"1",channelList:[],roomId:"",busId:"",panel_name:"",isExpend:!1},rulesDevice2:{panel_name:[{required:!0,message:"请输入面板名称",trigger:"blur"}],areacode:[{required:!0,message:"请输入区域码",trigger:"blur"}],addr:[{required:!0,message:"请输入地址码",trigger:"blur"}],roomId:[{required:!0,message:"请选择楼层房间",trigger:"change"}]},optionsRooms:[],optionsBuses:[],optionsIcons:[{label:"无",value:""},{label:"icon-ls_1_light",value:"icon-ls_1_light"},{label:"icon-ls_2_heating",value:"icon-ls_2_heating"},{label:"icon-ls_3_media",value:"icon-ls_3_media"},{label:"icon-ls_4_dimmer",value:"icon-ls_4_dimmer"},{label:"icon-ls_5_home",value:"icon-ls_5_home"},{label:"icon-ls_6_video",value:"icon-ls_6_video"},{label:"icon-ls_7_ac",value:"icon-ls_7_ac"},{label:"icon-ls_8_spotlight",value:"icon-ls_8_spotlight"},{label:"icon-ls_9_on",value:"icon-ls_9_on"},{label:"icon-ls_10_meeting",value:"icon-ls_10_meeting"},{label:"icon-ls_11_tv",value:"icon-ls_11_tv"},{label:"icon-ls_12_blind",value:"icon-ls_12_blind"},{label:"icon-ls_13_roller",value:"icon-ls_13_roller"},{label:"icon-ls_14_window_pusher",value:"icon-ls_14_window_pusher"},{label:"icon-ls_15_window_screening",value:"icon-ls_15_window_screening"},{label:"icon-ls_16_curtain",value:"icon-ls_16_curtain"},{label:"icon-ls_17_lamp",value:"icon-ls_17_lamp"},{label:"icon-ls_18_droplight",value:"icon-ls_18_droplight"},{label:"icon-ls_19_heater",value:"icon-ls_19_heater"},{label:"icon-ls_20_leisure",value:"icon-ls_20_leisure"},{label:"icon-ls_21_thermostat",value:"icon-ls_21_thermostat"},{label:"icon-ls_22_new_trend",value:"icon-ls_22_new_trend"},{label:"icon-ls_23_curtain",value:"icon-ls_23_curtain"},{label:"icon-ls_24_body",value:"icon-ls_24_body"},{label:"icon-ls_25_toplight",value:"icon-ls_25_toplight"},{label:"icon-ls_26_go_off_work",value:"icon-ls_26_go_off_work"},{label:"icon-ls_27_office",value:"icon-ls_27_office"},{label:"icon-ls_32_leave",value:"icon-ls_32_leave"},{label:"icon-ls_33_music",value:"icon-ls_33_music"},{label:"icon-ls_34_downlight",value:"icon-ls_34_downlight"},{label:"icon-ls_35_work",value:"icon-ls_35_work"},{label:"icon-ls_36_cloakroom",value:"icon-ls_36_cloakroom"},{label:"icon-ls_37_stair_lamps",value:"icon-ls_37_stair_lamps"}],optionsDevicetype:[{label:"灯控",value:"light"},{label:"调光",value:"dimmer"},{label:"窗帘",value:"curtain"},{label:"行程窗帘",value:"process_curtain"},{label:"场景",value:"scene"}],localtions:[1,2,3,4,5,6,7,8],localsPreview:[{local:1,keyLabel:"0",label:"",icon:""},{local:2,keyLabel:"0",label:"",icon:""},{local:3,keyLabel:"0",label:"",icon:""},{local:4,keyLabel:"0",label:"",icon:""},{local:5,keyLabel:"0",label:"",icon:""},{local:6,keyLabel:"0",label:"",icon:""},{local:7,keyLabel:"0",label:"",icon:""},{local:8,keyLabel:"0",label:"",icon:""}],SelectedLo:function(e,t){if(null==e.locals)return!1;if(0==e.locals.length)return!1;for(var i=0;i<e.locals.length;i++){if(e.locals[i].lo==t)return!0}return!1},arrShowTip:[!0,!0,!1,!1,!1,!1,!1,!1],visibleObj:{channel1:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1},channel2:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1},channel3:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1},channel4:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1},channel5:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1},channel6:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1},channel7:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1},channel8:{visiable1:!1,visiable2:!1,visiable3:!1,visiable4:!1,visiable5:!1,visiable6:!1,visiable7:!1,visiable8:!1}},isModule:function(){for(var t=0;t<e.formDevice2.channelList.length;t++)if("module_light"==e.formDevice2.channelList[t].deviceType||"module_dimmer"==e.formDevice2.channelList[t].deviceType)return!0;return!1}}},props:["deviceEditVisible","golbal","device"],methods:{handleClose:function(){this.$emit("changeShow","false")},loadSelectOptionRooms:function(){var e=[];if(null!=this.golbal.myProject&&null!=this.golbal.myProject.blocks&&this.golbal.myProject.blocks.length>0)for(var t=0;t<this.golbal.myProject.blocks[0].floors.length;t++)for(var i=0;i<this.golbal.myProject.blocks[0].floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e},loadSelectOptionBuses:function(){for(var e=[],t=0;t<this.golbal.myProject.buses.length;t++){var i={};i.value=this.golbal.myProject.buses[t].addr,i.label=this.golbal.myProject.buses[t].name,e.push(i)}this.optionsBuses=e},addChannel:function(){var e={};e.deviceType=this.formDevice2.channelList[0].deviceType,0==this.formDevice2.channelList.length?e.channel="1":this.formDevice2.channelList.length>0?(e.channel=parseInt(this.formDevice2.channelList[this.formDevice2.channelList.length-1].channel)+1+"",e.deviceType=this.formDevice2.channelList[this.formDevice2.channelList.length-1].deviceType):e.channel=this.formDevice2.channelList.length+1+"",console.log(e.deviceType);var t="";switch(e.deviceType){case"light":t="L";break;case"dimmer":t="D";break;case"module_light":t="L";break;case"module_dimmer":t="D";break;case"curtain":case"process_curtain":t="C";break;case"scene":t="S"}e.icon=this.formDevice2.channelList[0].icon,e.locals=[],e.name=this.formDevice2.areacode+"_"+this.formDevice2.addr+"_"+t+e.channel,e.panelId=this.formDevice.panelId,this.formDevice2.channelList.push(e)},deleteChannel1:function(e,t){var i=this;console.log(e),this.$confirm("确认要删除所选通道?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function a(){var o,s,n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=i,(s={}).action="APP_DELETE_DEVICE2",s.id=e.id,s.accessToken=o.golbal.accessToken,s.projectId=o.golbal.projectId,a.next=8,p()({method:"post",url:o.golbal.GET_DATA,data:"data="+escape(l()(s)),header:{"Content-Type":"application/jsonp"}});case 8:"SUCCESS"==(n=a.sent).data.status?(o.$message({type:"success",message:"删除成功!",duration:1e3}),o.formDevice2.channelList.length>1&&o.formDevice2.channelList.splice(t,1),null!=n.data.project&&b.a.getData(n.data.project,function(){})):i.$message({type:"error",message:n.data.errorMessage,duration:1e3});case 11:case"end":return a.stop()}},a,i)}))).catch(function(){i.$message({type:"info",message:"已取消删除",duration:1e3})})},deleteChannel:function(e,t){var i=this;this.$confirm("确认要删除所选通道?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function a(){var o,s,n,c,u,d;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=i,{}.id=e.id,null!=(s=i.golbal.myProject)){a.next=7;break}return i.$message({type:"error",message:"当前没有选定项目",duration:1e3}),a.abrupt("return");case 7:if(null!=e.id&&e.id.length>0)for(n=0;n<s.blocks[0].floors.length;n++)for(c=0;c<s.blocks[0].floors[n].rooms.length;c++)for(u=s.blocks[0].floors[n].rooms[c].devices.length,d=u-1;d>=0;d--)s.blocks[0].floors[n].rooms[c].devices[d].id==e.id&&s.blocks[0].floors[n].rooms[c].devices.splice(d,1);o.$message({type:"success",message:"删除成功!",duration:1e3}),o.formDevice2.channelList.length>1&&o.formDevice2.channelList.splice(t,1),b.a.saveLocalSystem("projectList"+i.golbal.userId+".json",l()(i.golbal.projectList)),b.a.getData(s);case 12:case"end":return a.stop()}},a,i)}))).catch(function(){i.$message({type:"info",message:"已取消删除",duration:1e3})})},submitFormDevice2:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveDevice()})},saveDevice2:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_SAVE_DEVICE2",a.panel_name=i.formDevice2.panel_name,a.addr=i.formDevice2.addr,a.areacode=i.formDevice2.areacode,a.roomId=i.formDevice2.roomId,a.busId=i.formDevice2.busId,a.channelList=i.formDevice2.channelList,a.accessToken=i.golbal.accessToken,a.projectId=i.golbal.projectId,t.next=13,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 13:"SUCCESS"==(o=t.sent).data.status?(e.$message({type:"success",duration:1e3,message:"成功添加设备!"}),null!=o.data.project&&b.a.getData(o.data.project,function(){}),i.showDialog=!1):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 16:case"end":return t.stop()}},t,e)}))()},saveDevice:function(){var e={action:"APP_SAVE_DEVICE2"};e.panel_name=this.formDevice2.panel_name,e.addr=this.formDevice2.addr,e.areacode=this.formDevice2.areacode,e.roomId=this.formDevice2.roomId,e.busId=this.formDevice2.busId,e.channelList=this.formDevice2.channelList,e.projectId=this.golbal.projectId,e.isExpend=this.formDevice2.isExpend;var t=this.golbal.myProject;if(null!=t){for(var i=[],a=0;a<e.channelList.length;a++){var o=0,s=0,n=0,c=e.channelList[a],r=null,u=null,d=!1;for(o=0;o<t.blocks[0].floors.length;o++)for(s=0;s<t.blocks[0].floors[o].rooms.length;s++)for(null==t.blocks[0].floors[o].rooms[s].devices&&(t.blocks[0].floors[o].rooms[s].devices=[]),n=0;n<t.blocks[0].floors[o].rooms[s].devices.length;n++)if(!d&&t.blocks[0].floors[o].rooms[s].devices[n].id==c.id){r=t.blocks[0].floors[o].rooms[s].devices[n],u=t.blocks[0].floors[o].rooms[s],d=!0;break}for(o=0;o<t.blocks[0].floors.length;o++)for(s=0;s<t.blocks[0].floors[o].rooms.length;s++)if(t.blocks[0].floors[o].rooms[s].id==e.roomId){var m=e.channelList[a],h=null;d?(h=r,null!=u&&u.devices.splice(u.devices.indexOf(r),1),t.blocks[0].floors[o].rooms[s].devices.push(h)):((h={}).id=b.a.uuid(),t.blocks[0].floors[o].rooms[s].devices.push(h)),h.deviceType=m.deviceType,h.type=m.deviceType,h.name=m.name,h.panel_name=e.panel_name,h.addr=e.addr,h.areacode=e.areacode,h.channel=m.channel,h.icon=m.icon,h.keyValue=m.keyValue,h.locals=m.locals,h.roomId=e.roomId,h.isHide=m.isHide,h.panelId=m.panelId,h.isSwitch=null==m.isSwitch||m.isSwitch,h.isFavorite=m.isFavorite,h.isExpend=e.isExpend,h.isNotify=m.isNotify,null!=m.sceneCode&&(h.sceneCode=m.sceneCode),h.selected=!1,h.busId=e.busId,i.push({item:h,floorName:t.blocks[0].floors[o].name,roomName:t.blocks[0].floors[o].rooms[s].name})}}if(null!=t.scenes&&t.scenes.length>0)for(s=0;s<i.length;s++){c=i[s].item;b.a.updateSceneSummary(t,c,i[s].floorName,i[s].roomName)}b.a.saveLocalSystem("projectList"+this.golbal.userId+".json",l()(this.golbal.projectList)),this.$message({type:"success",duration:1e3,message:"成功添加设备!"}),b.a.getData(t),this.showDialog=!1,this.golbal.showSwitchPanel=!1}else this.$message({type:"error",message:"当前没有选定项目",duration:1e3})},deleteDevice2:function(){var e=this;return d()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("确认要删除当前设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_DELETE_DEVICE2",a.panelId=i.formDevice.panelId,a.addr=i.formDevice2.addr,a.areacode=i.formDevice2.areacode,a.roomId=i.formDevice2.roomId,a.accessToken=i.golbal.accessToken,a.projectId=i.golbal.projectId,t.next=11,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 11:"SUCCESS"==(o=t.sent).data.status?(i.$message({type:"success",message:"删除成功!",duration:1e3}),null!=o.data.project&&b.a.getData(o.data.project,function(){}),i.showDialog=!1):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 14:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})});case 1:case"end":return t.stop()}},t,e)}))()},deleteDevice:function(){var e=this;this.$confirm("确认要删除当前设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o,s,n,c,u;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a={}).panelId=(i=e).formDevice.panelId,a.addr=i.formDevice2.addr,a.areacode=i.formDevice2.areacode,a.roomId=i.formDevice2.roomId,a.projectId=i.golbal.projectId,null!=(o=e.golbal.myProject)){t.next=11;break}return e.$message({type:"error",message:"当前没有选定项目",duration:1e3}),t.abrupt("return");case 11:for(s=0;s<o.blocks[0].floors.length;s++)for(n=0;n<o.blocks[0].floors[s].rooms.length;n++)if((c=o.blocks[0].floors[s].rooms[n]).id==a.roomId)for(u=c.devices.length-1;u>=0;u--)c.devices[u].panelId==a.panelId&&c.devices.splice(u,1);b.a.saveLocalSystem("projectList"+e.golbal.userId+".json",l()(e.golbal.projectList)),b.a.getData(o),i.$message({type:"success",message:"删除成功!",duration:1e3}),i.golbal.showSwitchPanel=!1,i.showDialog=!1;case 17:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})},sendFormDevice2:function(){for(var e=this,t=0;t<this.formDevice2.channelList.length;t++){var i=this.formDevice2.channelList[t];if(null==i.locals||0==i.locals.length)return void this.$message({type:"error",message:"未设置按键排序",duration:1e3})}this.$confirm("确认要发送当前设备属性?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){w.a.sendDeviceProperty(e.formDevice2)}).catch(function(){})},fillData:function(){if(this.formDevice2.panel_name=this.formDevice.panel_name,this.formDevice2.addr=this.formDevice.addr,this.formDevice2.areacode=this.formDevice.areacode,this.formDevice2.roomId=this.formDevice.roomId,this.formDevice2.busId=this.formDevice.busId,this.formDevice2.panelId=this.formDevice.panelId,null!=this.formDevice.isExpend?this.formDevice2.isExpend=this.formDevice.isExpend:this.formDevice2.isExpend=!0,console.log("fill"),""==this.formDevice2.roomId&&(this.formDevice2.roomId=this.optionsRooms.length>0?this.optionsRooms[0].value:""),null!=this.formDevice2.busId&&""!=this.formDevice2.busId||(this.formDevice2.busId=this.optionsBuses.length>0?this.optionsBuses[0].value:""),""==this.formDevice.id)if(this.formDevice2.channelList=[],this.formDevice.channelList)for(var e=0;e<this.formDevice.channelList.length;e++){(a={}).deviceType=this.formDevice.channelList[e].deviceType;var t="";switch(a.deviceType){case"light":t="L";break;case"dimmer":t="D";break;case"module_light":t="L";break;case"module_dimmer":t="D";break;case"curtain":case"process_curtain":t="C";break;case"scene":t="S"}a.channel=this.formDevice.channelList[e].channel,a.panelId=null==this.formDevice.channelList[e].panelId?"":this.formDevice.channelList[e].panelId,a.name=this.formDevice2.areacode+"_"+this.formDevice2.addr+"_"+t+a.channel,a.icon="",null==this.formDevice.channelList[e].locals?a.locals=[]:a.locals=this.formDevice.channelList[e].locals,a.locals.length>0&&this.fillLocal(a),this.formDevice2.channelList.push(a)}else{t="";switch(this.formDevice.deviceType){case"light":t="L";break;case"dimmer":t="D";break;case"module_light":t="L";break;case"module_dimmer":t="D";break;case"curtain":case"process_curtain":t="C";break;case"scene":t="S"}(a={}).id=this.formDevice.id,a.icon=this.formDevice.icon,a.deviceType=this.formDevice.deviceType,a.channel="1",a.name=this.formDevice.areacode+"_"+this.formDevice.addr+"_"+t+a.channel,a.keyValue=0,a.locals=[],a.panelId=this.formDevice.panelId,this.formDevice2.channelList.push(a)}else{this.formDevice2.channelList=[];var i="";for(e=0;e<b.a.devicesAll.length;e++){var a,o=b.a.devicesAll[e].device;if("light"==o.type||"dimmer"==o.type||"curtain"==o.type||"process_curtain"==o.type||"scene"==o.type||"module_light"==o.type||"module_dimmer"==o.type)if((null==o.panelId||""==o.panelId)&&(null==this.formDevice2.panelId||""==this.formDevice2.panelId)&&o.addr==this.formDevice.addr&&o.areacode==this.formDevice.areacode&&o.roomId==this.formDevice.roomId||o.panelId==this.formDevice2.panelId&&null!=this.formDevice2.panelId&&""!=this.formDevice2.panelId)null!=this.formDevice.panelId&&""!=this.formDevice.panelId||""!=i||(i=b.a.uuid(),this.formDevice.panelId=i),(a={}).id=o.id,a.icon=o.icon,a.deviceType=o.type,a.channel=o.channel,a.name=o.name,a.panelId=this.formDevice.panelId,a.isFavorite=o.isFavorite,"scene"!=o.type||null!=o.sceneCode&&0!=o.sceneCode||(o.sceneCode=e+1),a.sceneCode=o.sceneCode,null!=o.isHide?a.isHide=o.isHide:a.isHide=!1,null!=o.isNotify?a.isNotify=o.isNotify:a.isNotify=!1,null!=o.isSwitch?a.isSwitch=o.isSwitch:a.isSwitch=!0,null!=o.keyValue?a.keyValue=o.keyValue:a.keyValue=0,null!=o.locals?a.locals=o.locals:a.locals=[],a.locals.length>0&&this.fillLocal(o,a),this.formDevice2.channelList.push(a)}}},fillLocal:function(e){for(var t=0;t<e.locals.length;t++)if(!isNaN(e.locals[t])){"light"==e.deviceType||"module_light"==e.deviceType?e.locals[t]={lo:e.locals[t]+1,type:"L"}:"dimmer"==e.deviceType||"module_dimmer"==e.deviceType?0==e.locals[t]||1==e.locals[t]?e.locals[t]={lo:e.locals[t]+1,type:"U"}:2==e.locals[t]||3==e.locals[t]?e.locals[t]={lo:e.locals[t]+1,type:"P"}:4!=e.locals[t]&&5!=e.locals[t]||(e.locals[t]={lo:e.locals[t]+1,type:"D"}):"curtain"==e.deviceType||"process_curtain"==e.deviceType?0==e.locals[t]||1==e.locals[t]?e.locals[t]={lo:e.locals[t]+1,type:"O"}:2==e.locals[t]||3==e.locals[t]?e.locals[t]={lo:e.locals[t]+1,type:"C"}:4!=e.locals[t]&&5!=e.locals[t]||(e.locals[t]={lo:e.locals[t]+1,type:"S"}):"scene"==e.deviceType&&(e.locals[t]={lo:e.locals[t]+1,type:"S"})}},localChange:function(e,t,i){for(var a=!1,o=0;o<t.locals.length;o++){if(!a)if(t.locals[o].lo==i){t.locals.splice(o,1),a=!0;break}}a||t.locals.push({lo:i,type:e}),this.resetLocalPreview()},resetLocalPreview:function(){for(var e=0;e<8;e++)this.localsPreview[e].keyLabel=0,this.localsPreview[e].label="";for(var t=0;t<this.formDevice2.channelList.length;t++){var i=this.formDevice2.channelList[t];if(null!=i.locals&&i.locals.length>0)for(e=0;e<i.locals.length;e++){var a=i.locals[e],o="",s="",n="";switch(i.deviceType){case"light":o="L",o+=i.channel,s=i.name,n=i.icon;break;case"dimmer":o=i.channel+a.type,s=i.name,n=i.icon;break;case"curtain":case"process_curtain":o=i.channel+a.type,s=i.name,n=i.icon;break;case"scene":o="S",o+=i.channel,s=i.name,n=i.icon}this.localsPreview[a.lo-1].keyLabel=o,this.localsPreview[a.lo-1].label=s,this.localsPreview[a.lo-1].icon=n}}},changeBus:function(){console.log(this.formDevice2.busId)},btnTouchStart:function(e,t){},btnTouchEnd:function(e,t,i){for(var a=!1,o=0;o<t.locals.length;o++)if(!a){var s=t.locals[o];if(s.lo==i){if("Z"==e){t.locals.splice(o,1),a=!0;break}s.type=e,a=!0}}a||"Z"==e||t.locals.push({lo:i,type:e}),this.visibleObj["channel"+t.channel]["visiable"+i]=!1,this.resetLocalPreview()}},mounted:function(){this.loadSelectOptionRooms(),this.loadSelectOptionBuses()},watch:{deviceEditVisible:function(e,t){if(this.showDialog=this.deviceEditVisible,this.showDialog){if(this.$refs.formDevice2){console.log(this.$refs.formDevice2.fields.length),this.$refs.formDevice2.resetFields()}this.formDevice=JSON.parse(l()(this.device)),this.fillData(),this.resetLocalPreview()}}}},Ut={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"添加设备",visible:e.showDialog,width:"90%",modal:!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleClose}},[i("el-form",{ref:"formDevice2",attrs:{model:e.formDevice2,rules:e.rulesDevice2,"label-width":"100px","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"面板名称",prop:"panel_name"}},[i("el-input",{model:{value:e.formDevice2.panel_name,callback:function(t){e.$set(e.formDevice2,"panel_name",t)},expression:"formDevice2.panel_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"楼层房间",prop:"roomId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formDevice2.roomId,callback:function(t){e.$set(e.formDevice2,"roomId",t)},expression:"formDevice2.roomId"}},e._l(e.optionsRooms,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"网关",prop:"busId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.changeBus},model:{value:e.formDevice2.busId,callback:function(t){e.$set(e.formDevice2,"busId",t)},expression:"formDevice2.busId"}},e._l(e.optionsBuses,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"区域地址",prop:"areacode"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:255},model:{value:e.formDevice2.areacode,callback:function(t){e.$set(e.formDevice2,"areacode",t)},expression:"formDevice2.areacode"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备地址",prop:"addr"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:255},model:{value:e.formDevice2.addr,callback:function(t){e.$set(e.formDevice2,"addr",t)},expression:"formDevice2.addr"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"展开显示",prop:"isExpend"}},[i("el-checkbox",{model:{value:e.formDevice2.isExpend,callback:function(t){e.$set(e.formDevice2,"isExpend",t)},expression:"formDevice2.isExpend"}})],1),e._v(" "),e.isModule()?e._e():i("div",{staticClass:"divPreviewGroup"},[i("ul",e._l(e.localsPreview,function(t){return i("li",{key:t.local},[i("div",[i("div",{staticClass:"divPreviewTop"},[e._v("\r\n                "+e._s(t.keyLabel)+"\r\n              ")]),e._v(" "),i("div",{staticClass:"divPreviewContent"},[t.icon.length>0?i("i",{class:[t.icon]}):e._e(),e._v(e._s(t.label)+"\r\n              ")])])])}),0)]),e._v(" "),e._l(e.formDevice2.channelList,function(t,a){return i("div",{key:a,staticClass:"divFormAddDeviceChannel"},[i("el-form-item",{attrs:{label:"控制通道 "+t.channel,prop:"channelList."+a+".channel",rules:{required:!0,message:"控制通道不能为空",trigger:"blur"}}},[i("el-input-number",{staticStyle:{width:"72%",float:"left"},attrs:{min:1,max:255},model:{value:t.channel,callback:function(i){e.$set(t,"channel",i)},expression:"itemChannel.channel"}}),e._v(" "),i("el-button",{staticStyle:{width:"25%",float:"right"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(i){return e.deleteChannel(t,a)}}})],1),e._v(" "),i("el-form-item",{attrs:{label:"名称"+t.channel,prop:"channelList."+a+".name",rules:{required:!0,message:"名称不能为空",trigger:"blur"}}},[i("el-input",{on:{change:e.resetLocalPreview},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"itemChannel.name"}})],1),e._v(" "),"light"==t.deviceType||"dimmer"==t.deviceType||"curtain"==t.deviceType||"scene"==t.deviceType||"process_curtain"==t.deviceType?i("el-form-item",{attrs:{label:"功能类型 "+t.channel,prop:"channelList."+a+".deviceType",rules:{required:!0,message:"请选择功能类型",trigger:"change"}}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.deviceType,callback:function(i){e.$set(t,"deviceType",i)},expression:"itemChannel.deviceType"}},e._l(e.optionsDevicetype,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"通道图标 "+t.channel,prop:"channelList."+a+".icon"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.resetLocalPreview},model:{value:t.icon,callback:function(i){e.$set(t,"icon",i)},expression:"itemChannel.icon"}},e._l(e.optionsIcons,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[""!=t.value?i("i",{class:t.label,staticStyle:{"font-size":"1.5em"}}):i("i",{staticStyle:{"font-size":"1.5em"}},[e._v("无")])])}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"隐藏 "+t.channel,prop:"channelList."+a+".isHide"}},[i("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:t.isHide,callback:function(i){e.$set(t,"isHide",i)},expression:"itemChannel.isHide"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"通知 "+t.channel,prop:"channelList."+a+".isNotify"}},[i("el-switch",{attrs:{"active-text":"是","inactive-text":"否"},model:{value:t.isNotify,callback:function(i){e.$set(t,"isNotify",i)},expression:"itemChannel.isNotify"}})],1),e._v(" "),"light"==t.deviceType||"scene"==t.deviceType?i("el-form-item",{attrs:{label:"按键类型 "+t.channel,prop:"channelList."+a+".isSwitch"}},[i("el-switch",{attrs:{"active-text":"开关","inactive-text":"只开"},model:{value:t.isSwitch,callback:function(i){e.$set(t,"isSwitch",i)},expression:"itemChannel.isSwitch"}})],1):e._e(),e._v(" "),null!=e.visibleObj["channel"+t.channel]?["module_light"!=t.deviceType&&"module_dimmer"!=t.deviceType?i("div",{staticClass:"divCheckBoxGroup"},[i("ul",e._l([1,2,3,4,5,6,7,8],function(a){return i("li",{key:a,class:e.SelectedLo(t,a)?"select":""},["light"==t.deviceType?i("el-button",{staticStyle:{padding:"0px",width:"100%",height:"100%",background:"none",color:"#606266"},attrs:{disabled:"0"!=e.localsPreview[a-1].keyLabel&&!e.SelectedLo(t,a)},on:{click:function(i){return e.localChange("L",t,a)}}},[e._v(e._s(null==e.localsPreview[a-1]?a:e.localsPreview[a-1].keyLabel))]):"dimmer"==t.deviceType?i("el-popover",{attrs:{placement:"top",width:"50",trigger:"click"},model:{value:e.visibleObj["channel"+t.channel]["visiable"+a],callback:function(i){e.$set(e.visibleObj["channel"+t.channel],"visiable"+a,i)},expression:"visibleObj['channel'+itemChannel.channel]['visiable'+i]"}},[i("ul",{staticClass:"ulSelectBtnType"},[i("li",{on:{touchstart:function(t){return e.btnTouchStart("U")},touchend:function(i){return e.btnTouchEnd("U",t,a)}}},[e._v("上调")]),e._v(" "),i("li",{on:{touchstart:function(t){return e.btnTouchStart("S")},touchend:function(i){return e.btnTouchEnd("P",t,a)}}},[e._v("开关")]),e._v(" "),i("li",{on:{touchstart:function(t){return e.btnTouchStart("D")},touchend:function(i){return e.btnTouchEnd("D",t,a)}}},[e._v("下调")]),e._v(" "),i("li",{on:{touchstart:function(t){return e.btnTouchStart("D")},touchend:function(i){return e.btnTouchEnd("Z",t,a)}}},[e._v("取消")])]),e._v(" "),i("el-button",{staticStyle:{padding:"0px",width:"100%",height:"100%",background:"none",color:"#606266"},attrs:{slot:"reference",disabled:"0"!=e.localsPreview[a-1].keyLabel&&!e.SelectedLo(t,a)},slot:"reference"},[e._v(e._s(null==e.localsPreview[a-1]?a:e.localsPreview[a-1].keyLabel))])],1):"curtain"==t.deviceType||"process_curtain"==t.deviceType?i("el-popover",{attrs:{placement:"top",width:"50",trigger:"click"},model:{value:e.visibleObj["channel"+t.channel]["visiable"+a],callback:function(i){e.$set(e.visibleObj["channel"+t.channel],"visiable"+a,i)},expression:"visibleObj['channel'+itemChannel.channel]['visiable'+i]"}},[i("ul",{staticClass:"ulSelectBtnType"},[i("li",{on:{touchstart:function(t){return e.btnTouchStart("U")},touchend:function(i){return e.btnTouchEnd("O",t,a)}}},[e._v("开")]),e._v(" "),i("li",{on:{touchstart:function(t){return e.btnTouchStart("S")},touchend:function(i){return e.btnTouchEnd("C",t,a)}}},[e._v("关")]),e._v(" "),i("li",{on:{touchstart:function(t){return e.btnTouchStart("D")},touchend:function(i){return e.btnTouchEnd("S",t,a)}}},[e._v("停")]),e._v(" "),i("li",{on:{touchstart:function(t){return e.btnTouchStart("D")},touchend:function(i){return e.btnTouchEnd("Z",t,a)}}},[e._v("取消")])]),e._v(" "),i("el-button",{staticStyle:{padding:"0px",width:"100%",height:"100%",background:"none",color:"#606266"},attrs:{slot:"reference",disabled:"0"!=e.localsPreview[a-1].keyLabel&&!e.SelectedLo(t,a)},slot:"reference"},[e._v(e._s(null==e.localsPreview[a-1]?a:e.localsPreview[a-1].keyLabel))])],1):"scene"==t.deviceType?i("el-button",{staticStyle:{padding:"0px",width:"100%",height:"100%",background:"none",color:"#606266"},attrs:{disabled:"0"!=e.localsPreview[a-1].keyLabel&&!e.SelectedLo(t,a)},on:{click:function(i){return e.localChange("S",t,a)}}},[e._v(e._s(null==e.localsPreview[a-1]?a:e.localsPreview[a-1].keyLabel))]):e._e()],1)}),0)]):e._e()]:e._e()],2)})],2),e._v(" "),i("el-button",{staticStyle:{width:"100%","margin-top":"15px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addChannel}},[e._v("添加通道")]),e._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{height:"20px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},attrs:{type:"danger",size:"mini"},on:{click:e.deleteDevice}},[e._v("删 除")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitFormDevice2("formDevice2")}}},[e._v("保 存")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.sendFormDevice2("formDevice2")}}},[e._v("发 送")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var $t,Yt=i("VU/8")(Bt,Ut,!1,function(e){i("ymNt")},"data-v-8a2a555a",null).exports,Ft={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"搜索结果",visible:e.showDialog,width:"90%",modal:!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleClose}},[i("div",{staticClass:"divForm divScanResult",staticStyle:{width:"90%",padding:"0px"}},[i("el-form",{ref:"formResult",attrs:{model:e.formResult,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[null!=e.golbal.editing.scanBusResult&&e.golbal.editing.scanBusResult.length>0?i("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"网关"}},[i("ul",e._l(e.golbal.editing.scanBusResult,function(t){return i("li",{key:t.addr,on:{click:function(i){return e.busClick(t)}}},[i("div",{staticClass:"divFirstSummary"},[e._v("地址:"+e._s(t.addr))]),e._v(" "),i("div",{staticClass:"divSecondSummary"},[e._v("IP:"+e._s(t.ip))]),e._v(" "),i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-arrow-right"})])])}),0)]):e._e()],1)],1)])],1)},staticRenderFns:[]},Ht=i("VU/8")({data:function(){return{showDialog:!1,formResult:{}}},props:["scanBusResultVisible","golbal"],methods:{handleClose:function(){this.$emit("changeShow","false")},busClick:function(e){this.golbal.editing.bus=e,this.$router.push({name:"busEdit",params:{bus:e}})}},mounted:function(){},watch:{scanBusResultVisible:function(e,t){this.showDialog=this.scanBusResultVisible}}},Ft,!1,null,null,null).exports,Gt={data:function(){return{showDialog:!1,showCommandDialog:!1,optionsRooms:[],optionsBuses:[],optionsIcons:[{label:"无",value:""},{label:"icon-ls_1_light",value:"icon-ls_1_light"},{label:"icon-ls_2_heating",value:"icon-ls_2_heating"},{label:"icon-ls_3_media",value:"icon-ls_3_media"},{label:"icon-ls_4_dimmer",value:"icon-ls_4_dimmer"},{label:"icon-ls_5_home",value:"icon-ls_5_home"},{label:"icon-ls_6_video",value:"icon-ls_6_video"},{label:"icon-ls_7_ac",value:"icon-ls_7_ac"},{label:"icon-ls_8_spotlight",value:"icon-ls_8_spotlight"},{label:"icon-ls_9_on",value:"icon-ls_9_on"},{label:"icon-ls_10_meeting",value:"icon-ls_10_meeting"},{label:"icon-ls_11_tv",value:"icon-ls_11_tv"},{label:"icon-ls_12_blind",value:"icon-ls_12_blind"},{label:"icon-ls_13_roller",value:"icon-ls_13_roller"},{label:"icon-ls_14_window_pusher",value:"icon-ls_14_window_pusher"},{label:"icon-ls_15_window_screening",value:"icon-ls_15_window_screening"},{label:"icon-ls_16_curtain",value:"icon-ls_16_curtain"},{label:"icon-ls_17_lamp",value:"icon-ls_17_lamp"},{label:"icon-ls_18_droplight",value:"icon-ls_18_droplight"},{label:"icon-ls_19_heater",value:"icon-ls_19_heater"},{label:"icon-ls_20_leisure",value:"icon-ls_20_leisure"},{label:"icon-ls_21_thermostat",value:"icon-ls_21_thermostat"},{label:"icon-ls_22_new_trend",value:"icon-ls_22_new_trend"},{label:"icon-ls_23_curtain",value:"icon-ls_23_curtain"},{label:"icon-ls_24_body",value:"icon-ls_24_body"},{label:"icon-ls_25_toplight",value:"icon-ls_25_toplight"},{label:"icon-ls_26_go_off_work",value:"icon-ls_26_go_off_work"},{label:"icon-ls_27_office",value:"icon-ls_27_office"},{label:"icon-ls_32_leave",value:"icon-ls_32_leave"},{label:"icon-ls_33_music",value:"icon-ls_33_music"},{label:"icon-ls_34_downlight",value:"icon-ls_34_downlight"},{label:"icon-ls_35_work",value:"icon-ls_35_work"},{label:"icon-ls_36_cloakroom",value:"icon-ls_36_cloakroom"},{label:"icon-ls_37_stair_lamps",value:"icon-ls_37_stair_lamps"}],formRemote:{id:"",name:"",ip:"",mac:"",addr:"",roomId:"",remoteType:"custom",layoutType:"tv",keyMaps:[]},optionsLayout:[{name:"空调类型",value:"ac"},{name:"电视影音类型",value:"tv"},{name:"自定义",value:"custom"}],optionsRemoteType:[{name:"红外码库",value:"lab"},{name:"自定义指令",value:"custom"},{name:"红外学习",value:"learn"}],optionsKeysTV:[{name:"开",value:"key_on"},{name:"关",value:"key_off"},{name:"电源",value:"power"},{name:"开关",value:"switch"},{name:"静音",value:"silen"},{name:"音量+",value:"vol_up"},{name:"音量-",value:"vol_down"},{name:"频道+",value:"channel_up"},{name:"频道-",value:"channel_down"},{name:"按键1",value:"key_1"},{name:"按键2",value:"key_2"},{name:"按键3",value:"key_3"},{name:"按键4",value:"key_4"},{name:"按键5",value:"key_5"},{name:"按键6",value:"key_6"},{name:"按键7",value:"key_7"},{name:"按键8",value:"key_8"},{name:"按键9",value:"key_9"},{name:"按键0",value:"key_0"},{name:"收藏",value:"key_fav"},{name:"后退",value:"key_back"},{name:"菜单",value:"key_menu"},{name:"主页",value:"key_home"},{name:"上",value:"key_up"},{name:"下",value:"key_down"},{name:"左",value:"key_left"},{name:"右",value:"key_right"},{name:"确定",value:"key_ok"},{name:"返回",value:"key_return"},{name:"退出",value:"key_exit"},{name:"播放",value:"play"},{name:"暂停",value:"pause"}],optionsKeysAC:[{name:"电源",value:"power"},{name:"温度+",value:"vol_p"},{name:"温度-",value:"vol_m"},{name:"制暖",value:"sun"},{name:"制冷",value:"snow"},{name:"送风",value:"fan"},{name:"恒温",value:"keep"},{name:"除湿",value:"dry"},{name:"扫风",value:"scan"},{name:"高速",value:"highWind"},{name:"中速",value:"middleWind"},{name:"低速",value:"lowWind"}],optionsKeysMusic:[{name:"开",value:"key_on"},{name:"关",value:"key_off"},{name:"更多",value:"more"},{name:"开关",value:"switch"},{name:"弹出",value:"eject"},{name:"HDMI",value:"hdmi"},{name:"AUX",value:"aux"},{name:"USB",value:"usb"},{name:"蓝牙",value:"bluetooth"},{name:"菜单",value:"key_menu"},{name:"主页",value:"key_home"},{name:"上",value:"key_up"},{name:"下",value:"key_down"},{name:"左",value:"key_left"},{name:"右",value:"key_right"},{name:"确定",value:"key_ok"},{name:"返回",value:"key_return"},{name:"退出",value:"key_exit"},{name:"音量+",value:"vol_up"},{name:"音量-",value:"vol_down"},{name:"静音",value:"silen"},{name:"上一曲",value:"previous"},{name:"播放/暂停",value:"playstop"},{name:"播放",value:"play"},{name:"暂停",value:"pause"},{name:"下一曲",value:"next"},{name:"单曲循环",value:"loopone"},{name:"循环",value:"loop"},{name:"随机播放",value:"random"}],tabpage:1,keyVal:"",keyCmd:"",editingKeyMap:null}},props:["deviceEditVisible","golbal","device"],methods:($t={bankCardKeyup:function(){this.keyCmd=this.keyCmd.replace(/[^0123456789abcdefABCDEF]/g,"").replace(/([0123456789abcdefABCDEF]{2})(?=[0123456789abcdefABCDEF])/g,"$1 ")},loadSelectOptionRooms:function(){for(var e=[],t=0;t<this.golbal.blockCur.floors.length;t++)for(var i=0;i<this.golbal.blockCur.floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e},loadSelectOptionBuses:function(){for(var e=[],t=0;t<this.golbal.myProject.buses.length;t++){var i={};i.value=this.golbal.myProject.buses[t].addr,i.label=this.golbal.myProject.buses[t].name,e.push(i)}this.optionsBuses=e},handleClose:function(){this.$emit("changeShow","false")},handleCommandClose:function(){this.showCommandDialog=!1},saveRemote:function(){if(null!=this.formRemote.roomId&&0!=this.formRemote.roomId.length){var e={};e.id=this.formRemote.id,null!=this.formRemote.deviceType?e.deviceType=this.formRemote.deviceType:e.deviceType=this.formRemote.type,e.name=this.formRemote.name,e.addr=this.formRemote.addr,e.areacode=this.formRemote.areacode,e.channel=this.formRemote.channel,e.icon=this.formRemote.icon,e.roomId=this.formRemote.roomId,e.busId=this.formRemote.busId,e.projectId=this.golbal.projectId,e.isFavorite=this.formRemote.isFavorite,e.remoteType=this.formRemote.remoteType,e.layoutType=this.formRemote.layoutType,e.keyMaps=this.formRemote.keyMaps;var t=this.golbal.myProject;if(null!=t){if(""!=e.id)for(var i=0;i<t.blocks[0].floors.length;i++)for(var a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(null!=t.blocks[0].floors[i].rooms[a].devices)for(var o=0;o<t.blocks[0].floors[i].rooms[a].devices.length;o++)t.blocks[0].floors[i].rooms[a].devices[o].id==e.id&&t.blocks[0].floors[i].rooms[a].devices.splice(o,1);for(i=0;i<t.blocks[0].floors.length;i++)for(a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(t.blocks[0].floors[i].rooms[a].id==e.roomId){var s={};s.deviceType=e.deviceType,s.type=e.deviceType,""==e.id?s.id=b.a.uuid():s.id=e.id,s.name=e.name,s.panel_name=e.panel_name,s.addr=e.addr,s.areacode=e.areacode,s.channel=e.channel,s.icon=e.icon,s.roomId=e.roomId,s.selected=!1,s.isFavorite=e.isFavorite,s.busId=e.busId,s.remoteType=e.remoteType,s.layoutType=e.layoutType,"ac"==s.layoutType&&(s.value=26,s.mode="制冷"),s.keyMaps=e.keyMaps,t.blocks[0].floors[i].rooms[a].devices.push(s)}b.a.saveLocalSystem("projectList"+this.golbal.userId+".json",l()(this.golbal.projectList)),this.$message({type:"success",message:"成功保存设备!",duration:1e3}),b.a.getData(t),this.showDialog=!1}else this.$message({type:"error",message:"当前没有选定项目",duration:1e3})}else this.$message({type:"error",message:"请选择房间",duration:1e3})},deleteRemote:function(){var e=this;this.$confirm("确认要删除该遥控？?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e,i={};i.id=t.formRemote.id;var a=e.golbal.myProject;if(null!=a){if(""!=i.id)for(var o=0;o<a.blocks[0].floors.length;o++)for(var s=0;s<a.blocks[0].floors[o].rooms.length;s++)for(var n=0;n<a.blocks[0].floors[o].rooms[s].devices.length;n++)a.blocks[0].floors[o].rooms[s].devices[n].id==i.id&&a.blocks[0].floors[o].rooms[s].devices.splice(n,1);b.a.saveLocalSystem("projectList"+e.golbal.userId+".json",l()(e.golbal.projectList)),t.$message({type:"success",message:"删除成功!",duration:1e3}),b.a.getData(a),t.showDialog=!1,t.golbal.showSwitchPanel=!1}else e.$message({type:"error",message:"当前没有选定项目",duration:1e3})}).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})}},h()($t,"loadSelectOptionRooms",function(){for(var e=[],t=0;t<this.golbal.blockCur.floors.length;t++)for(var i=0;i<this.golbal.blockCur.floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e}),h()($t,"loadSelectOptionBuses",function(){for(var e=[],t=0;t<this.golbal.myProject.buses.length;t++){var i={};i.value=this.golbal.myProject.buses[t].addr,i.label=this.golbal.myProject.buses[t].name,e.push(i)}this.optionsBuses=e}),h()($t,"tabClick",function(e){this.tabpage=e}),h()($t,"keyClick",function(e){this.showCommandDialog=!0,this.keyVal!=e&&this.keyCmdChange(),this.keyVal=e;var t=this.getKeyMap(this.keyVal);this.keyCmd=null==t?"":t.cmd}),h()($t,"keyCmdChange",function(){if(null==this.editingKeyMap){console.log(this.keyCmd);var e=this.getKeyMap(this.keyVal);null!=e?(console.log(e.cmd),e.cmd=this.keyCmd):(e={val:this.keyVal,cmd:this.keyCmd},null==this.formRemote.keyMaps&&(this.formRemote.keyMaps=[]),this.formRemote.keyMaps.push(e))}else this.editingKeyMap.cmd=this.keyCmd,this.editingKeyMap.val=this.keyVal}),h()($t,"keyValChange",function(){console.log(this.editingKeyMap),null!=this.editingKeyMap&&(this.editingKeyMap.cmd=this.keyCmd,this.editingKeyMap.val=this.keyVal)}),h()($t,"getKeyMap",function(e){if(null!=this.formRemote.keyMaps)for(var t=0;t<this.formRemote.keyMaps.length;t++)if(this.formRemote.keyMaps[t].val==e)return this.formRemote.keyMaps[t];return null}),h()($t,"addKeyMap",function(){var e={val:"新键",cmd:""};null==this.formRemote.keyMaps&&(this.formRemote.keyMaps=[]),this.formRemote.keyMaps.push(e),this.editingKeyMap=e,this.keyVal=e.val,this.keyCmd=e.cmd,this.showCommandDialog=!0}),h()($t,"handleDeleteCustom",function(e,t){this.formRemote.keyMaps.splice(e,1)}),h()($t,"rowClick",function(e,t,i){this.editingKeyMap=e,this.keyVal=e.val,this.keyCmd=e.cmd,this.showCommandDialog=!0}),$t),mounted:function(){this.loadSelectOptionRooms(),this.loadSelectOptionBuses()},watch:{deviceEditVisible:function(e,t){this.showDialog=this.deviceEditVisible,this.showDialog&&(this.formRemote=JSON.parse(l()(this.device)),console.log(this.device))}}},Wt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"添加遥控",visible:e.showDialog,width:"90%",modal:!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleClose}},[i("div",{staticClass:"divFormAddDevice"},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("el-form",{ref:"formDevice",attrs:{model:e.formRemote,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"遥控名称",prop:"name"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formRemote.name,callback:function(t){e.$set(e.formRemote,"name",t)},expression:"formRemote.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"楼层房间",prop:"roomId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formRemote.roomId,callback:function(t){e.$set(e.formRemote,"roomId",t)},expression:"formRemote.roomId"}},e._l(e.optionsRooms,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"网关",prop:"busId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formRemote.busId,callback:function(t){e.$set(e.formRemote,"busId",t)},expression:"formRemote.busId"}},e._l(e.optionsBuses,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"区域地址",prop:"areacode"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:255},model:{value:e.formRemote.areacode,callback:function(t){e.$set(e.formRemote,"areacode",t)},expression:"formRemote.areacode"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备地址",prop:"addr"}},[i("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:255},model:{value:e.formRemote.addr,callback:function(t){e.$set(e.formRemote,"addr",t)},expression:"formRemote.addr"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"图标",prop:"icon"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formRemote.icon,callback:function(t){e.$set(e.formRemote,"icon",t)},expression:"formRemote.icon"}},e._l(e.optionsIcons,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[""!=t.value?i("i",{class:t.label,staticStyle:{"font-size":"1.5em"}}):i("i",{staticStyle:{"font-size":"1.5em"}},[e._v("无")])])}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"类型",prop:"remoteType"}},[i("el-select",{attrs:{placeholder:"选择遥控类型"},model:{value:e.formRemote.remoteType,callback:function(t){e.$set(e.formRemote,"remoteType",t)},expression:"formRemote.remoteType"}},e._l(e.optionsRemoteType,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{staticStyle:{height:"550px"},attrs:{label:"布局预览",prop:"addrcode"}},["tv"==e.formRemote.layoutType?i("div",{staticClass:"divDrawerRemote",staticStyle:{top:"0px"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_on")}}},[i("i",{staticClass:"icon-ls_38_on"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("pause")}}},[i("i",{staticClass:"icon-pause2"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_off")}}},[i("i",{staticClass:"icon-ls_39_off"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("channel_up")}}},[i("i",{staticClass:"icon-arrow2_up"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("play")}}},[i("i",{staticClass:"icon-play3"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("vol_up")}}},[i("i",{staticClass:"icon-plus"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("channel_down")}}},[i("i",{staticClass:"icon-arrow2_down"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("silen")}}},[i("i",{staticClass:"icon-volume-mute2"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("vol_down")}}},[i("i",{staticClass:"icon-minus"})])]),e._v(" "),i("div",{staticClass:"row rowSpace"},[i("table",{attrs:{cellpadding:"0",cellspacing:"0"}},[i("tr",[i("td",{class:1==e.tabpage?"active":"",style:"width:50%;"+(1==e.tabpage?"background-color:rgba(200,200,200,0.3)":"background-color:rgba(93,93,93,0.3)"),on:{click:function(t){return e.tabClick(1)}}},[e._v("123")]),e._v(" "),i("td",{class:2==e.tabpage?"active":"",style:"width:50%;"+(2==e.tabpage?"background-color:rgba(200,200,200,0.3)":"background-color:rgba(93,93,93,0.3)"),on:{click:function(t){return e.tabClick(2)}}},[e._v("菜单")])])])]),e._v(" "),1==e.tabpage?i("div",[i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_1")}}},[e._v("1")]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_2")}}},[e._v("2")]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_3")}}},[e._v("3")])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_4")}}},[e._v("4")]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_5")}}},[e._v("5")]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_6")}}},[e._v("6")])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_7")}}},[e._v("7")]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_8")}}},[e._v("8")]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_9")}}},[e._v("9")])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_fav")}}},[i("i",{staticClass:"icon-heart"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_0")}}},[e._v("0")]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_back")}}},[i("i",{staticClass:"icon-undo2"})])])]):e._e(),e._v(" "),2==e.tabpage?i("div",[i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_menu")}}},[i("i",{staticClass:"icon-category"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_up")}}},[i("i",{staticClass:"icon-arrow2_up"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_home")}}},[i("i",{staticClass:"icon-home1"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_left")}}},[i("i",{staticClass:"icon-arrow2_left"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_ok")}}},[e._v("OK")]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_right")}}},[i("i",{staticClass:"icon-arrow2_right"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_return")}}},[i("i",{staticClass:"icon-arrow-left2"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_down")}}},[i("i",{staticClass:"icon-arrow2_down"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_exit")}}},[i("i",{staticClass:"icon-exit"})])])]):e._e()]):e._e(),e._v(" "),"music"==e.formRemote.layoutType?i("div",{staticClass:"divDrawerRemote",staticStyle:{top:"0px"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_on")}}},[i("i",{staticClass:"icon-ls_38_on"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("more")}}},[i("i",{staticClass:"el-icon-more"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_off")}}},[i("i",{staticClass:"icon-ls_39_off"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("hdmi")}}},[e._v("HDMI")]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("usb")}}},[e._v("USB")]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("bluetooth")}}},[i("i",{staticClass:"icon-ls_47_bluetooth"})])]),e._v(" "),i("div",{staticClass:"row ",staticStyle:{"margin-top":"20px"}},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_menu")}}},[i("i",{staticClass:"icon-category"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_up")}}},[i("i",{staticClass:"icon-arrow2_up"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_home")}}},[i("i",{staticClass:"icon-home1"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_left")}}},[i("i",{staticClass:"icon-arrow2_left"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_ok")}}},[e._v("OK")]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("key_right")}}},[i("i",{staticClass:"icon-arrow2_right"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("key_return")}}},[i("i",{staticClass:"icon-arrow-left2"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("key_down")}}},[i("i",{staticClass:"icon-arrow2_down"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("silen")}}},[i("i",{staticClass:"icon-volume-mute2"})])]),e._v(" "),i("div",{staticClass:"row ",staticStyle:{"margin-top":"20px"}},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("previous")}}},[i("i",{staticClass:"icon-previous2"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("play")}}},[i("i",{staticClass:"icon-play3"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("vol_up")}}},[i("i",{staticClass:"icon-volume-increase"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("next")}}},[i("i",{staticClass:"icon-next2"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("pause")}}},[i("i",{staticClass:"icon-pause2"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("vol_down")}}},[i("i",{staticClass:"icon-volume-decrease"})])]),e._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("loopone")}}},[i("i",{staticClass:"icon-ls_45_loop_one"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("loop")}}},[i("i",{staticClass:"icon-ls_46_loop"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("random")}}},[i("i",{staticClass:"icon-shuffle"})])])]):e._e(),e._v(" "),"ac"==e.formRemote.layoutType?i("div",{staticClass:"divDrawerRemote",staticStyle:{top:"0px"}},[i("div",{staticClass:"row"},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("vol_p")}}},[i("i",{staticClass:"icon-plus"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("power")}}},[i("i",{staticClass:"icon-switch"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("vol_m")}}},[i("i",{staticClass:"icon-minus"})])]),e._v(" "),i("div",{staticClass:"row",staticStyle:{"margin-top":"50px"}},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("sun")}}},[i("i",{staticClass:"icon-sun"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("snow")}}},[i("i",{staticClass:"icon-kongdiao"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("fan")}}},[i("i",{staticClass:"icon-fan"})])]),e._v(" "),i("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("keep")}}},[i("i",{staticClass:"icon-ls_21_thermostat"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("dry")}}},[i("i",{staticClass:"icon-air-conditioner"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("scan")}}},[i("i",{staticClass:"icon-arrow-down-left"})])]),e._v(" "),i("div",{staticClass:"row",staticStyle:{"margin-top":"20px"}},[i("div",{staticClass:"btn left",on:{touchend:function(t){return e.keyClick("highWind")}}},[i("i",{staticClass:"icon-screw2"})]),e._v(" "),i("div",{staticClass:"btn center",on:{touchend:function(t){return e.keyClick("middleWind")}}},[i("i",{staticClass:"icon-screw"})]),e._v(" "),i("div",{staticClass:"btn right",on:{touchend:function(t){return e.keyClick("slowWind")}}},[i("i",{staticClass:"icon-propeller"})])])]):e._e(),e._v(" "),"custom"==e.formRemote.layoutType?i("div",{staticClass:"divDrawerRemote",staticStyle:{top:"0px"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.formRemote.keyMaps,height:"480px"},on:{"row-click":e.rowClick}},[i("el-table-column",{attrs:{label:"名称",width:"70",prop:"val"}}),e._v(" "),i("el-table-column",{attrs:{label:"指令",width:"180",prop:"cmd"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return i.stopPropagation(),e.handleDeleteCustom(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,1077704467)})],1),e._v(" "),i("el-button",{staticStyle:{width:"100%","margin-top":"15px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addKeyMap}},[e._v("添加按键")])],1):e._e()])],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{height:"20px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteRemote()}}},[e._v("删 除")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.saveRemote}},[e._v("确 定")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"按键指令",visible:e.showCommandDialog,width:"90%",modal:!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showCommandDialog=t},close:e.handleCommandClose}},[i("el-form",{ref:"formDevice",attrs:{model:e.formRemote,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},["learn"!=e.formRemote.remoteType&&"custom"!=e.formRemote.remoteType||"custom"==e.formRemote.layoutType?e._e():i("el-form-item",{attrs:{label:"选择按键"}},["tv"==e.formRemote.layoutType?i("el-select",{attrs:{placeholder:"选择按键",disabled:!0},on:{change:function(t){return e.keyClick(e.keyVal)}},model:{value:e.keyVal,callback:function(t){e.keyVal=t},expression:"keyVal"}},e._l(e.optionsKeysTV,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1):e._e(),e._v(" "),"ac"==e.formRemote.layoutType?i("el-select",{attrs:{placeholder:"选择按键",disabled:!0},on:{change:function(t){return e.keyClick(e.keyVal)}},model:{value:e.keyVal,callback:function(t){e.keyVal=t},expression:"keyVal"}},e._l(e.optionsKeysAC,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1):e._e(),e._v(" "),"music"==e.formRemote.layoutType?i("el-select",{attrs:{placeholder:"选择按键",disabled:!0},on:{change:function(t){return e.keyClick(e.keyVal)}},model:{value:e.keyVal,callback:function(t){e.keyVal=t},expression:"keyVal"}},e._l(e.optionsKeysMusic,function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1):e._e()],1),e._v(" "),"custom"==e.formRemote.layoutType?i("el-form-item",{attrs:{label:"按键名称"}},[i("el-input",{attrs:{clearable:""},on:{change:e.keyValChange},model:{value:e.keyVal,callback:function(t){e.keyVal=t},expression:"keyVal"}})],1):e._e(),e._v(" "),"learn"==e.formRemote.remoteType||"custom"==e.formRemote.remoteType||"custom"==e.formRemote.layoutType?i("el-form-item",{attrs:{label:"按键指令",prop:"addrcode"}},[i("el-input",{attrs:{type:"textarea",readonly:"learn"==e.formRemote.remoteType,clearable:"",placeholder:"命令",rows:3},on:{change:e.keyCmdChange,input:e.bankCardKeyup},model:{value:e.keyCmd,callback:function(t){e.keyCmd=t},expression:"keyCmd"}},["learn"==e.formRemote.remoteType?i("el-button",{attrs:{slot:"append"},slot:"append"},[e._v("学习")]):e._e()],1)],1):e._e()],1)],1)],1)},staticRenderFns:[]},Kt=i("VU/8")(Gt,Wt,!1,null,null,null).exports,zt={components:{CameraEdit:Lt,DeviceEdit1:Rt,DeviceEdit2:Yt,BusEdit:Mt,ScanBusResult:Ht,DeviceMain:ot,RemoteEdit:Kt},data:function(){return{cameraEditVisible:!1,deviceEdit1Visible:!1,deviceEdit2Visible:!1,scanBusResultVisible:!1,busEditVisible:!1,remoteEditVisible:!1,formDevice:{id:"",deviceType:"",name:"",addr:"",areacode:"",channel:"",icon:"",roomId:"",panel_name:"",channelList:[]},udp_client:null,timer:null}},props:["golbal"],methods:{editDeviceClick:function(e){if(1==this.golbal.myProject.isMaster||1==this.golbal.myProject.isAdmin)if(null!=e.type)switch(this.formDevice=e,e.type){case"light":case"dimmer":case"curtain":case"process_curtain":case"scene":case"module_light":case"module_dimmer":this.deviceEdit2Visible=!0;break;case"camera":this.cameraEditVisible=!0;break;case"remoteTV":case"remoteAC":case"remoteMusic":case"remoteCustom":this.remoteEditVisible=!0;break;default:this.deviceEdit1Visible=!0}else null!=e.ip&&(this.formDevice=e,this.busEditVisible=!0)},addDeviceClick:function(){1!=this.golbal.myProject.isMaster&&1!=this.golbal.myProject.isAdmin||"/addDevice"!=this.$route.path&&this.$router.push({path:"/addDevice"})},autoAddDeviceClick:function(){if(1==this.golbal.myProject.isMaster||1==this.golbal.myProject.isAdmin){this.golbal.scanDevice.isGet=!0;var e=this;this.timer=setInterval(function(){if(null!=e.golbal.scanDevice.channelList&&e.golbal.scanDevice.channelList.length>0){switch(e.formDevice.addr=e.golbal.scanDevice.addr,e.formDevice.areacode=e.golbal.scanDevice.areacode,null!=e.golbal.scanDevice.bus&&(e.formDevice.busId=e.golbal.scanDevice.bus.addr),e.golbal.scanDevice.channelList[0].deviceType){case"light":case"dimmer":case"curtain":case"process_curtain":case"scene":case"module_light":case"module_dimmer":null==b.a.devicesAll&&(b.a.devicesAll=[]);var t=b.a.getVODeviceByAddrAndArea(e.golbal.scanDevice.addr,e.golbal.scanDevice.areacode);if(null!=t)e.editDeviceClick(t);else{e.formDevice.id="",e.formDevice.channelList=e.golbal.scanDevice.channelList,e.formDevice.panelId=e.golbal.scanDevice.panelId;for(var i=0;i<e.formDevice.channelList.length;i++){var a=e.formDevice.channelList[i],o="";switch(a.deviceType){case"light":o="L";break;case"dimmer":o="D";break;case"module_light":o="L";break;case"module_dimmer":o="D";break;case"curtain":case"process_curtain":o="C";break;case"scene":o="S"}a.name=e.formDevice.areacode+"_"+e.formDevice.addr+"_"+o+a.channel}e.deviceEdit2Visible=!0}break;default:e.formDevice.deviceType=e.golbal.scanDevice.channelList[0].deviceType,e.formDevice.channel=e.golbal.scanDevice.channelList[0].channel,e.deviceEdit1Visible=!0}e.golbal.scanDevice.isGet=!1,e.golbal.scanDevice.channelList=[],null!=e.timer&&(clearInterval(e.timer),e.timer=null)}},50)}},cancelScan:function(){this.golbal.scanDevice.isGet=!1,null!=this.timer&&(clearInterval(this.timer),this.timer=null)},scanBusClick:function(){var e=this;this.golbal.scanDevice.isGet=!0,this.golbal.editing.scanBusResult=[],b.a.scanBusByWebSocket(function(){console.log("finish"),null!=e.golbal.editing.scanBusResult&&e.golbal.editing.scanBusResult.length>0&&(e.scanBusResultVisible=!0)}),setTimeout(function(){e.golbal.editing.scanningBus=!1,e.golbal.scanDevice.isGet=!1},3e4),w.a.sendRequestAddrDemo()},showCameraEdit:function(e){this.cameraEditVisible="false"!==e},showDeviceEdit1:function(e){this.deviceEdit1Visible="false"!==e},showDeviceEdit2:function(e){this.deviceEdit2Visible="false"!==e},showDeviceEdit3:function(e){this.scanBusResultVisible="false"!==e},showBusEdit:function(e){this.busEditVisible="false"!==e},showRemoteEdit:function(e){this.remoteEditVisible="false"!==e}},mounted:function(){this.golbal.showButtonFloor=!0,this.golbal.showButtonShare=!1,this.golbal.showCaseTopRight="FLOOR",this.golbal.menuCur="device"}},qt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"main",staticStyle:{bottom:"0"}},[i("DeviceMain",{ref:"DeviceMain",attrs:{golbal:e.golbal,mode:"SELECT",selectType:"edit"},on:{onSelectedDevice:e.editDeviceClick}})],1),e._v(" "),i("div",{staticClass:"divDeviceFooter",staticStyle:{"margin-bottom":"8px"}},[i("ul",[i("li",{on:{click:function(t){return e.scanBusClick()}}},[i("i",{staticClass:"el-icon-search",style:1!=e.golbal.myProject.isMaster&&1!=e.golbal.myProject.isAdmin?"color:#909090;":""}),i("span",{style:1!=e.golbal.myProject.isMaster&&1!=e.golbal.myProject.isAdmin?"color:#909090;":""},[e._v("搜索网关")])]),e._v(" "),i("li",{on:{click:function(t){return e.autoAddDeviceClick()}}},[i("i",{staticClass:"el-icon-magic-stick",style:1!=e.golbal.myProject.isMaster&&1!=e.golbal.myProject.isAdmin?"color:#909090;":""}),i("span",{style:1!=e.golbal.myProject.isMaster&&1!=e.golbal.myProject.isAdmin?"color:#909090;":""},[e._v("自动添加设备")])]),e._v(" "),i("li",{on:{click:function(t){return e.addDeviceClick()}}},[i("i",{staticClass:"el-icon-edit-outline",style:1!=e.golbal.myProject.isMaster&&1!=e.golbal.myProject.isAdmin?"color:#909090;":""}),i("span",{style:1!=e.golbal.myProject.isMaster&&1!=e.golbal.myProject.isAdmin?"color:#909090;":""},[e._v("手动添加设备")])])])]),e._v(" "),e.golbal.scanDevice.isGet?i("div",{staticClass:"divDeviceLoading"},[i("i",{staticClass:"el-icon-loading"}),e._v(" "),i("span",[e._v("设备搜索中")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.cancelScan}},[e._v("取 消")])],1):e._e(),e._v(" "),e.golbal.scanDevice.isGet?i("div",{staticClass:"divDeviceLoadingMask"}):e._e(),e._v(" "),i("CameraEdit",{attrs:{deviceEditVisible:e.cameraEditVisible,golbal:e.golbal,device:e.formDevice},on:{changeShow:e.showCameraEdit}}),e._v(" "),i("DeviceEdit1",{attrs:{deviceEditVisible:e.deviceEdit1Visible,golbal:e.golbal,device:e.formDevice},on:{changeShow:e.showDeviceEdit1}}),e._v(" "),i("DeviceEdit2",{attrs:{deviceEditVisible:e.deviceEdit2Visible,golbal:e.golbal,device:e.formDevice},on:{changeShow:e.showDeviceEdit2}}),e._v(" "),i("BusEdit",{attrs:{deviceEditVisible:e.busEditVisible,golbal:e.golbal,device:e.formDevice},on:{changeShow:e.showBusEdit}}),e._v(" "),i("ScanBusResult",{attrs:{scanBusResultVisible:e.scanBusResultVisible,golbal:e.golbal},on:{changeShow:e.showDeviceEdit3}}),e._v(" "),i("RemoteEdit",{attrs:{deviceEditVisible:e.remoteEditVisible,golbal:e.golbal,device:e.formDevice},on:{changeShow:e.showRemoteEdit}})],1)},staticRenderFns:[]},Jt=i("VU/8")(zt,qt,!1,null,null,null).exports,Qt={components:{},data:function(){return{projectEditVisible:!1,ul_width:200,touchAction:{isDown:!1},projectList:[],isClickBackup:!1,isClickRestore:!1,showPasswordDialog:!1,timer:null,itemClick:null,password:"",filterStr:""}},props:["golbal"],methods:{resetUlWidth:function(){for(var e=this.$refs.ul_room,t=0,i=0;i<e.children.length;i++)t+=e.children[i].clientWidth+2;return this.ul_width=t,t},validatePassword:function(e,t){1==e?(this.isClickBackup=!0,this.isClickRestore=!1,this.itemClick=t):2==e&&(this.isClickBackup=!1,this.isClickRestore=!0,this.itemClick=t),this.showPasswordDialog=!0},submitValidatePassword:function(){var e=this,t={action:"APP_VALIDATE_PASSWORD"};t.accessToken=this.golbal.accessToken,t.pwd=this.password,p.a.post(this.golbal.GET_DATA,t,{header:{"Content-Type":"application/jsonp"}}).then(function(t){"SUCCESS"==t.data.status?e.isClickBackup&&null!=e.itemClick?e.backupToCloud(e.itemClick):e.isClickRestore&&null!=e.itemClick&&e.loadFromCloud(e.itemClick.id):e.$message({type:"error",message:t.data.errorMessage,duration:1e3})}),this.password=""},editProjectClick:function(e){for(var t=this,i=0;i<this.golbal.projectList.length;i++){var a=this.golbal.projectList[i],o=null==a.projectId?a.id:a.projectId;null==e||null==e.project||e.project.projectId!=o&&e.project.id!=o||b.a.resumeProjectLocal(a,this,function(){t.golbal.editing.project=t.golbal.myProject,t.$router.push({name:"projectEdit",params:{project:t.golbal.myProject}})})}},initProjectList:function(){var e=this,t={action:"APP_GET_PROJECT_LIST"};t.accessToken=this.golbal.accessToken,p.a.post(this.golbal.GET_DATA,t,{header:{"Content-Type":"application/jsonp"}}).then(function(t){if("SUCCESS"==t.data.status){if(e.golbal.projectListCloud=t.data.projectList,null!=t.data.projectListLocal&&t.data.projectListLocal.length>0){e.golbal.projectList=t.data.projectListLocal;for(var i=0;i<e.golbal.projectList.length;i++){for(var a=e.golbal.projectList[i],o=!1,s=0;s<e.projectList.length;s++)e.projectList[s].id==a.projectId&&(e.projectList[s].local=!0,e.projectList[s].name=a.projectName,e.projectList[s].project=a,e.projectList[s].summary=a.projectSummary,e.projectList[s].isMaster=a.isMaster,e.projectList[s].isAdmin=a.isAdmin,o=!0);if(!o){var n={id:a.projectId,name:a.projectName,summary:a.projectSummary,project:a,local:!0,remote:!1,isMaster:a.isMaster,isAdmin:a.isAdmin};e.projectList.push(n)}}}i=0,s=0,o=!1,n=null;for(i=e.golbal.projectListCloud.length-1;i>=0;i--){var l=e.golbal.projectListCloud[i];for(s=0;s<e.golbal.projectListCloud.length;s++)if(null!=l.parentId&&l.parentId==e.golbal.projectListCloud[s].projectId){e.golbal.projectListCloud.splice(i,1);break}}for(i=0;i<e.golbal.projectListCloud.length;i++){var c=e.golbal.projectListCloud[i];for(o=!1,s=0;s<e.projectList.length;s++)e.projectList[s].id==c.projectId&&(e.projectList[s].remote=!0,e.projectList[s].isMaster=c.isMaster,e.projectList[s].isAdmin=c.isAdmin,o=!0);o||(n={id:c.projectId,name:c.projectName,summary:c.projectSummary,local:!1,remote:!0,isMaster:c.isMaster,isAdmin:c.isAdmin},e.projectList.push(n))}console.log(e.projectList)}})},backupToCloud:function(e){var t=this,i=this;0==e.isMaster&&0==e.isAdmin||this.$confirm("确认要用本地数据覆盖云端数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function a(){var o,s;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o={},console.log(e.project),(s=e.project).projectId==i.golbal.myProject.id?(s=i.golbal.myProject,o.isBackupWithProject=!0):o.isBackupWithProject=!1,null!=s){a.next=6;break}return a.abrupt("return");case 6:null==s.VERSION?s.VERSION=1:s.VERSION=s.VERSION+1,o.action="APP_BACKUP_PROJECT",o.project=s,o.accessToken=t.golbal.accessToken,p.a.post(i.golbal.GET_DATA,o,{header:{"Content-Type":"application/jsonp"}}).then(function(e){"SUCCESS"==e.data.status?i.$message({type:"success",message:"备份完成!",duration:1e3}):i.$message({type:"error",message:e.data.errorMessage,duration:1e3}),i.initProjectList(),i.showPasswordDialog=!1});case 11:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除",duration:1e3}),i.showPasswordDialog=!1})},loadFromCloud:function(e){var t=this,i=this;this.$confirm("确定要用云端数据覆盖本地数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={action:"APP_RESUME_PROJECT"};t.id=e,t.accessToken=i.golbal.accessToken,p.a.post(i.golbal.GET_DATA,t,{header:{"Content-Type":"application/jsonp"}}).then(function(e){if("SUCCESS"==e.data.status){var t=e.data.project;null==t.projectName&&(t.projectName=t.name),null==t.projectSummary&&(t.projectSummary=t.summary),t.localUserId=i.golbal.userId;for(var a=0;a<i.projectList.length;a++)i.projectList[a].id==t.id&&(t.isMaster=i.projectList[a].isMaster,t.isAdmin=i.projectList[a].isAdmin);i.initProjectList(),console.log(t.id),b.a.getData(t,function(){i.golbal.qrcode="http://app.lk-control.com/txt2qrcode?txt="+escape(i.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+i.golbal.projectId)}),i.$message({type:"success",message:"下载完成!",duration:1e3}),i.showPasswordDialog=!1}else i.$message({type:"error",message:e.data.errorMessage,duration:1e3}),i.showPasswordDialog=!1})}).catch(function(){t.$message({type:"info",message:"已取消删除",duration:1e3}),i.showPasswordDialog=!1})},filterChange:function(){console.log(this.filterStr)},getProjectList:function(){for(var e=[],t=0;t<this.projectList.length;t++)null!=this.projectList[t].name&&this.projectList[t].name.indexOf(this.filterStr)>-1&&e.push(this.projectList[t]);return e}},mounted:function(){this.golbal.showCaseTopRight="ADD_PROJECT",this.golbal.showCaseTopLeft="BACK",this.initProjectList()}},Zt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("span",{staticStyle:{display:"none"}},[e._v(e._s(e.golbal.timeCount))]),e._v(" "),i("div",{staticClass:"divDeviceList"},[i("el-input",{staticClass:"input_filter",staticStyle:{"border-top":"1px solid rgb(240, 133, 26)","border-bottom":"1px solid rgba(255, 255, 255, 0.2)","margin-top":"84px",width:"100%"},attrs:{placeholder:"输入关键字筛选"},on:{input:e.filterChange},model:{value:e.filterStr,callback:function(t){e.filterStr=t},expression:"filterStr"}}),e._v(" "),i("div",{staticClass:"divDeviceListContent",staticStyle:{height:"calc(100% - 88px)",overflow:"scroll"}},[i("ul",{staticClass:"ulTypeRow",staticStyle:{"margin-top":"0px"}},[e._l(""==e.filterStr?e.projectList:e.getProjectList(),function(t){return["b0b502b7-c000-4000-a000-0547116af000"!=t.id?i("li",{key:t.id,staticStyle:{"border-radius":"0px","border-bottom":"1px solid rgb(255 255 255 / 20%)","background-color":"#252523","margin-bottom":"0px",padding:"5px 0px"},on:{click:function(i){return e.editProjectClick(t)}}},[e._m(0,!0),e._v(" "),i("div",{staticClass:"divInfo"},[i("div",{staticClass:"spanDeviceName"},[e._v(e._s(t.name))]),e._v(" "),i("div",{staticClass:"spanDeviceSummary"},[e._v(e._s(t.summary))])]),e._v(" "),t.local?i("div",{staticClass:"divIcon",staticStyle:{width:"8vw","text-align":"right","margin-right":"12vw",float:"right"},on:{click:function(i){return i.stopPropagation(),e.validatePassword(1,t)}}},[i("i",{staticClass:"icon-cloud-upload",style:"font-size:1.5em;height:41px;line-height: 41px;"+(0==t.isMaster&&0==t.isAdmin?"color:#707070":"")})]):e._e(),e._v(" "),t.remote&&t.local?i("div",{staticClass:"divIcon",staticStyle:{width:"8vw","text-align":"right","padding-right":"5vw",float:"right"},on:{click:function(i){return i.stopPropagation(),e.validatePassword(2,t)}}},[i("i",{staticClass:"icon-cloud-download",style:"font-size:1.5em;height:41px;line-height: 41px;"})]):t.remote?i("div",{staticClass:"divIcon",staticStyle:{width:"8vw","text-align":"right","margin-right":"31.5vw",float:"right"},on:{click:function(i){return i.stopPropagation(),e.validatePassword(2,t)}}},[i("i",{staticClass:"icon-cloud-download",style:"font-size:1.5em;height:41px;line-height: 41px;"})]):e._e()]):e._e()]})],2)])],1),e._v(" "),i("el-dialog",{staticClass:"DialogPassword",attrs:{title:"请输入密码",visible:e.showPasswordDialog,"append-to-body":!0,width:"80%"},on:{"update:visible":function(t){e.showPasswordDialog=t}}},[i("el-form",[i("el-form-item",{attrs:{label:"密码"}},[i("el-input",{attrs:{"show-password":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},on:{click:function(t){e.showPasswordDialog=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitValidatePassword()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"icon-office",staticStyle:{"font-size":"25px",height:"40px","line-height":"40px","margin-top":"0px"}})])}]};var Xt=i("VU/8")(Qt,Zt,!1,function(e){i("EaHM")},"data-v-0ff6f040",null).exports,ei={data:function(){var e=this;return{isEnabled:[!0],showDialog:!1,activeName:"",mode:"EDIT",formProject:{id:"",projectSummary:"",projectName:"",floors:[]},isSelectLogic:function(t){if(null!=e.selectSceneBackup){for(var i=0;i<e.selectSceneBackup.length;i++)if(e.selectSceneBackup[i].id==t.id)return!0;return!1}return!1},selectSceneBackup:[],roomList:[{id:"0",floor:"全部楼层",room:"全部房间",value:"",label:"全部"},{id:"1",floor:"一楼",room:"101",value:"101",label:"一楼 101"},{id:"2",floor:"一楼",room:"102",value:"102",label:"一楼 102"},{id:"3",floor:"二楼",room:"201",value:"201",label:"二楼 201"},{id:"4",floor:"二楼",room:"202",value:"202",label:"二楼 202"}],selectRoomId:"",sceneList:function(){if(null==e.formProject.scenes)return[];if(""==e.selectRoomId){for(var t=[],i=0;i<e.formProject.scenes.length;i++){var a=e.formProject.scenes[i];e.activeName==a.sceneType&&t.push(a)}return t}for(t=[],i=0;i<e.formProject.scenes.length;i++){a=e.formProject.scenes[i];if(e.activeName==a.sceneType)if("TIMER"!=a.sceneType){for(var o=0;o<a.conditions.length;o++){var s=a.conditions[o];null!=s.device&&s.device.roomId==e.selectRoomId&&-1==t.indexOf(a)&&t.push(a)}if("AUTOMATION"==a.sceneType&&null!=a.actions&&a.actions.length>0)for(o=0;o<a.actions.length;o++){var n=null;null!=(l=a.actions[o]).device&&(n=l.device),null!=l.deviceId&&(n=b.a.getVODeviceById(l.deviceId)),null!=n&&n.roomId==e.selectRoomId&&-1==t.indexOf(a)&&t.push(a)}}else if(null!=a.actions&&a.actions.length>0)for(o=0;o<a.actions.length;o++){var l;n=null;null!=(l=a.actions[o]).device&&(n=l.device),null!=l.deviceId&&(n=b.a.getVODeviceById(l.deviceId)),null!=aactionDev&&n.roomId==e.selectRoomId&&-1==t.indexOf(a)&&t.push(a)}}return t}}},props:["projectEditVisible","golbal","project"],methods:{sceneClick:function(e){if("EDIT"==this.mode)this.golbal.editing.scene=e,this.golbal.editing.activeSceneName=this.activeName,this.$router.push({name:"sceneEdit",params:{scene:e}});else if("SELECT"==this.mode){if(null==this.selectSceneBackup)return;for(var t=0;t<this.selectSceneBackup.length;t++)if(this.selectSceneBackup[t].id==e.id)return this.selectSceneBackup.splice(t,1),void this.$forceUpdate();this.selectSceneBackup.push({id:e.id,name:e.name}),this.$forceUpdate()}},newSceneClick:function(e){this.golbal.editing.scene=null,this.golbal.editing.activeSceneName=this.activeName,this.$router.push({name:"sceneEdit",params:{scene:null,sceneType:e}})},changeEnabled:function(e){e.enabled=this.isEnabled[this.formProject.scenes.indexOf(e)],b.a.saveProject(this.golbal.myProject),w.a.sendAutomationEnabled([e],e.enabled)},saveSecurityClick:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o,s,n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e.golbal.editing.security){t.next=2;break}return t.abrupt("return");case 2:if(e.golbal.editing.security.length>0)for(i=e.golbal.editing.security.length-1;i>=0;i--)e.golbal.editing.security.splice(i,1);for(i=0;i<e.selectSceneBackup.length;i++)e.golbal.editing.security.push(e.selectSceneBackup[i]);for(null==e.golbal.myProject.secureIn&&(e.golbal.myProject.secureIn=[]),i=e.golbal.myProject.secureIn.length-1;i>=0;i--){for(a=e.golbal.myProject.secureIn[i],o=!1,s=0;s<e.golbal.myProject.scenes.length;s++)n=e.golbal.myProject.scenes[s],a.id==n.id&&(o=!0);o||e.golbal.myProject.secureIn.splice(i,1)}for(null==e.golbal.myProject.secureOut&&(e.golbal.myProject.secureOut=[]),i=e.golbal.myProject.secureOut.length-1;i>=0;i--){for(a=e.golbal.myProject.secureOut[i],o=!1,s=0;s<e.golbal.myProject.scenes.length;s++)n=e.golbal.myProject.scenes[s],a.id==n.id&&(o=!0);o||e.golbal.myProject.secureOut.splice(i,1)}b.a.saveProject(e.golbal.myProject),e.$message({message:"成功安防设置！",type:"success",duration:1e3}),e.$router.back(-1);case 11:case"end":return t.stop()}},t,e)}))()},selectRoomChange:function(){console.log(this.selectRoomId),this.golbal.editing.selectRoomId=this.selectRoomId}},mounted:function(){var e=this;this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var t=this.golbal.myProject;null!=t?(null==t.scenes&&(t.scenes=[]),this.formProject.id=t.id,this.formProject.projectName=t.name,this.formProject.projectSummary=t.summary,this.formProject.scenes=t.scenes,this.formProject.floors=t.blocks[0].floors):(this.formProject.id="",this.formProject.projectName="",this.formProject.projectSummary="",this.formProject.floors=[],this.formProject.scenes=[]),this.isEnabled=[];for(var i=0;i<this.formProject.scenes.length;i++){this.isEnabled.push(!1);var a=this.formProject.scenes[i];"TIMER"!=a.sceneType&&"AUTOMATION"!=a.sceneType||(null==a.enabled&&(a.enabled=!1),this.isEnabled[i]=a.enabled)}null!=this.$route.params&&null!=this.$route.params.mode&&(this.mode=this.$route.params.mode),setTimeout(function(){"SELECT"==e.mode?(e.activeName="AUTOMATION",null!=e.golbal.editing.security&&(e.selectSceneBackup=JSON.parse(l()(e.golbal.editing.security)))):null==e.golbal.editing.activeSceneName||""==e.golbal.editing.activeSceneName?e.activeName="SCENE":(e.activeName=e.golbal.editing.activeSceneName,setTimeout(function(){var t=document.getElementById("DivLogicListScene"),i=document.getElementById("UlLogicListScene"),a=0;if(i.children.length>0&&(a=i.children[0].clientHeight),console.log("divHeight:"+t.clientHeight+",ulHeight:"+i.clientHeight),null!=e.golbal.editing.scene&&a>0){for(var o=e.sceneList(),s=e.golbal.editing.scene,n=0,l=0;l<o.length;l++)o[l].id==s.id&&(n=l);(n+1)*a>t.clientHeight&&(t.scrollTop=(n+1)*a-t.clientHeight)}},500))},50),this.roomList=[{id:"",floor:"全部楼层",room:"全部房间",value:{},label:"全部"}];for(i=0;i<this.formProject.floors.length;i++)for(var o=this.formProject.floors[i],s=0;s<o.rooms.length;s++){var n=o.rooms[s],c={id:n.id,floor:o.name,room:n.name,value:n,label:o.name+" "+n.name};this.roomList.push(c)}null!=this.golbal.editing.selectRoomId&&(this.selectRoomId=this.golbal.editing.selectRoomId)}},ti={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mainLogic main"},[i("div",{staticClass:"divFormList"},[i("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},["EDIT"==e.mode?i("el-tab-pane",{staticClass:"spanTabHeader",attrs:{name:"SCENE"}},[i("div",{staticClass:"spanTabHeader",attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-user"}),e._v(" 场景")]),e._v(" "),i("el-select",{staticStyle:{"margin-top":"5px",width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.selectRoomChange},model:{value:e.selectRoomId,callback:function(t){e.selectRoomId=t},expression:"selectRoomId"}},e._l(e.roomList,function(t){return i("el-option",{key:t.id,attrs:{label:t.label,value:t.id}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.floor))]),e._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(e._s(t.room))])])}),1),e._v(" "),i("div",{staticClass:"divLogicList",attrs:{id:"DivLogicListScene"}},[i("ul",{attrs:{id:"UlLogicListScene"}},[e._l(e.sceneList(),function(t){return[i("li",{key:t.id,class:"groupLi "+(e.isSelectLogic(t)?"groupLiC":""),on:{click:function(i){return e.sceneClick(t)}}},[i("span",{staticClass:"spanSceneTitle"},[e._v(e._s(t.name))]),i("div",{staticClass:"divIcon",staticStyle:{height:"55px","line-height":"55px"}},[i("i",{staticClass:"el-icon-arrow-right"})])])]})],2)])],1):e._e(),e._v(" "),"EDIT"==e.mode?i("el-tab-pane",{attrs:{name:"RELATIVE"}},[i("span",{staticClass:"spanTabHeader",attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-connection"}),e._v(" 双控")]),e._v(" "),i("el-select",{staticStyle:{"margin-top":"5px",width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.selectRoomChange},model:{value:e.selectRoomId,callback:function(t){e.selectRoomId=t},expression:"selectRoomId"}},e._l(e.roomList,function(t){return i("el-option",{key:t.id,attrs:{label:t.label,value:t.id}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.floor))]),e._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(e._s(t.room))])])}),1),e._v(" "),i("div",{staticClass:"divLogicList"},[i("ul",[e._l(e.sceneList(),function(t){return[i("li",{key:t.id,class:"groupLi "+(e.isSelectLogic(t)?"groupLiC":""),on:{click:function(i){return e.sceneClick(t)}}},[i("span",{staticClass:"spanSceneTitle"},[e._v(e._s(t.name))]),i("div",{staticClass:"divIcon",staticStyle:{height:"55px","line-height":"55px"}},[i("i",{staticClass:"el-icon-arrow-right"})])])]})],2)])],1):e._e(),e._v(" "),"EDIT"==e.mode?i("el-tab-pane",{attrs:{name:"TIMER"}},[i("span",{staticClass:"spanTabHeader",attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-alarm-clock"}),e._v(" 定时")]),e._v(" "),i("el-select",{staticStyle:{"margin-top":"5px",width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.selectRoomChange},model:{value:e.selectRoomId,callback:function(t){e.selectRoomId=t},expression:"selectRoomId"}},e._l(e.roomList,function(t){return i("el-option",{key:t.id,attrs:{label:t.label,value:t.id}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.floor))]),e._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.room))])])}),1),e._v(" "),i("div",{staticClass:"divLogicList"},[i("ul",[e._l(e.sceneList(),function(t){return[i("li",{key:t.id,class:"groupLi "+(e.isSelectLogic(t)?"groupLiC":"")},[i("span",{staticClass:"spanSceneTitle",on:{click:function(i){return e.sceneClick(t)}}},[e._v(e._s(t.name))]),e._v(" "),"EDIT"==e.mode?i("el-switch",{staticClass:"switchRight",attrs:{"active-color":"#f08519","inactive-color":"#c4c4c4"},on:{change:function(i){return e.changeEnabled(t)}},model:{value:e.isEnabled[e.formProject.scenes.indexOf(t)],callback:function(i){e.$set(e.isEnabled,e.formProject.scenes.indexOf(t),i)},expression:"isEnabled[formProject.scenes.indexOf(scene)]"}}):e._e()],1)]})],2)])],1):e._e(),e._v(" "),i("el-tab-pane",{attrs:{name:"AUTOMATION"}},[i("span",{staticClass:"spanTabHeader",attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"el-icon-setting"}),e._v(" 自动化")]),e._v(" "),i("el-select",{staticStyle:{"margin-top":"5px",width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.selectRoomChange},model:{value:e.selectRoomId,callback:function(t){e.selectRoomId=t},expression:"selectRoomId"}},e._l(e.roomList,function(t){return i("el-option",{key:t.id,attrs:{label:t.label,value:t.id}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.floor))]),e._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.room))])])}),1),e._v(" "),i("div",{staticClass:"divLogicList"},[i("ul",[e._l(e.sceneList(),function(t){return[i("li",{key:t.id,class:"groupLi "+(e.isSelectLogic(t)?"groupLiC":"")},[i("span",{staticClass:"spanSceneTitle",on:{click:function(i){return e.sceneClick(t)}}},[e._v(e._s(t.name))]),e._v(" "),"EDIT"==e.mode?i("el-switch",{staticClass:"switchRight",attrs:{"active-color":"#f08519","inactive-color":"#c4c4c4"},on:{change:function(i){return e.changeEnabled(t)}},model:{value:e.isEnabled[e.formProject.scenes.indexOf(t)],callback:function(i){e.$set(e.isEnabled,e.formProject.scenes.indexOf(t),i)},expression:"isEnabled[formProject.scenes.indexOf(scene)]"}}):e._e()],1)]})],2)])],1)],1),e._v(" "),"EDIT"==e.mode?i("div",{staticClass:"divPlus",staticStyle:{"margin-top":"0px",color:"#f08519",position:"absolute",top:"15px",right:"5.3%"},on:{click:function(t){return e.newSceneClick(e.activeName)}}},[e._v("+")]):e._e(),e._v(" "),"SELECT"==e.mode?i("div",{staticClass:"divPlus",staticStyle:{"margin-top":"0px",color:"#f08519",position:"absolute",top:"15px",right:"5.3%"},on:{click:function(t){return e.saveSecurityClick()}}},[i("i",{staticClass:"icon-save"})]):e._e()],1)])},staticRenderFns:[]};var ii=i("VU/8")(ei,ti,!1,function(e){i("VQRa")},"data-v-74919334",null).exports,ai={components:{DeviceEdit1:Rt,DeviceEdit2:Yt,BusEdit:Mt,RemoteEdit:Kt},data:function(){return{deviceEdit1Visible:!1,deviceEdit2Visible:!1,busEditVisible:!1,remoteEditVisible:!1,dialogVisibleYingshi:!1,formYingshi:{id:"",deviceName:"",deviceSerial:"",validateCode:"",roomId:"",brand:"",username:"",password:"",ip:""},cameraBrand:[{label:"海康",value:"HAI_KANG"},{label:"大华",value:"DA_HUA"},{label:"萤石",value:"YING_SHI"}],device:{id:"",deviceType:"",channel:"1",icon:"",name:"",addr:"1",areacode:"1",roomId:"",panel_name:""},rulesYingshi:{deviceName:[{required:!0,message:"请输入设备名称",trigger:"blur"}],deviceSerial:[{required:!0,message:"请输入设备序列号",trigger:"blur"}],validateCode:[{required:!0,message:"请输入设备验证码",trigger:"blur"}],roomId:[{required:!0,message:"请选择楼层房间",trigger:"change"}]},optionsRooms:[]}},props:["golbal"],methods:{changeBrand:function(){console.log(this.formYingshi.brand)},submitFormYingshi:function(e){var t=this;"YING_SHI"==this.formYingshi.brand?this.$refs[e].validate(function(e){if(!e)return!1;t.addYingshi()}):this.addOther()},addYingshi:function(){var e=this,t={action:"APP_ADD_DEVICE_YS"};t.deviceName=e.formYingshi.deviceName,t.deviceSerial=e.formYingshi.deviceSerial,t.validateCode=e.formYingshi.validateCode,t.roomId=e.formYingshi.roomId,t.accessToken=e.golbal.accessToken,t.projectId=e.golbal.projectId,p()({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(t)),header:{"Content-Type":"application/jsonp"}}).then(function(t){"SUCCESS"==t.data.status?e.addOther():e.$message({type:"error",message:t.data.errorMessage,duration:1e3})}).catch(function(e){console.log(e)})},addOther:function(){var e={};e.id=this.formYingshi.id,e.deviceType="camera",e.name=this.formYingshi.deviceName,e.panel_name=this.formYingshi.deviceName,e.roomId=this.formYingshi.roomId,e.ip=this.formYingshi.ip,e.username=this.formYingshi.username,e.password=this.formYingshi.password,e.brand=this.formYingshi.brand,e.deviceSerial=this.formYingshi.deviceSerial,e.validateCode=this.formYingshi.validateCode,e.isFavorite=!1;var t=this.golbal.myProject;if(null!=t){if(""!=e.id)for(var i=0;i<t.blocks[0].floors.length;i++)for(var a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(null!=t.blocks[0].floors[i].rooms[a].devices)for(var o=0;o<t.blocks[0].floors[i].rooms[a].devices.length;o++)t.blocks[0].floors[i].rooms[a].devices[o].id==e.id&&t.blocks[0].floors[i].rooms[a].devices.splice(o,1);for(i=0;i<t.blocks[0].floors.length;i++)for(a=0;a<t.blocks[0].floors[i].rooms.length;a++)if(t.blocks[0].floors[i].rooms[a].id==e.roomId){var s={};s.deviceType=e.deviceType,s.type=e.deviceType,""==e.id?s.id=b.a.uuid():s.id=e.id,s.name=e.name,s.panel_name=e.panel_name,s.roomId=e.roomId,s.ip=e.ip,s.username=e.username,s.password=e.password,s.selected=!1,s.brand=e.brand,s.deviceSerial=e.deviceSerial,s.validateCode=e.validateCode,s.isFavorite=e.isFavorite,s.icon="icon-ls_3_media",t.blocks[0].floors[i].rooms[a].devices.push(s)}b.a.saveLocalSystem("projectList"+this.golbal.userId+".json",l()(this.golbal.projectList)),this.$message({type:"success",message:"成功保存设备!",duration:1e3}),b.a.getData(t),this.showDialog=!1,this.golbal.showSwitchPanel=!1}else this.$message({type:"error",message:"当前没有选定项目",duration:1e3})},loadSelectOptionRooms:function(){for(var e=[],t=0;t<this.golbal.blockCur.floors.length;t++)for(var i=0;i<this.golbal.blockCur.floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e},openDialogDevice:function(e){"bus"==e?(this.device.deviceType=e,this.device.type=e,this.busEditVisible=!0):"remoteTV"==e||"remoteAC"==e||"remoteMusic"==e||"remoteCustom"==e?(this.device.deviceType=e,this.device.type=e,"remoteTV"==e?this.device.layoutType="tv":"remoteMusic"==e?this.device.layoutType="music":"remoteAC"==e?this.device.layoutType="ac":"remoteCustom"==e&&(this.device.layoutType="custom"),this.remoteEditVisible=!0):(this.device.deviceType=e,this.device.type=e,this.deviceEdit1Visible=!0)},openDialogDevice2:function(e,t){this.device.icon="",this.device.deviceType=e,this.device.panel_name=t,this.device.panelId=b.a.uuid(),this.deviceEdit2Visible=!0},showDeviceEdit1:function(e){this.deviceEdit1Visible="false"!==e},showDeviceEdit2:function(e){this.deviceEdit2Visible="false"!==e},showBusEdit:function(e){this.busEditVisible="false"!==e},showRemoteEdit:function(e){this.remoteEditVisible="false"!==e}},mounted:function(){this.golbal.showButtonFloor=!1,this.golbal.showButtonShare=!1,this.golbal.menuCur="user",this.loadSelectOptionRooms()}},oi={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"main",staticStyle:{height:"calc(100% - 49px)"}},[i("div",{staticClass:"tabsAddDevice"},[i("el-tabs",{style:"height:calc(100vh - 50px)",attrs:{type:"border-card","tab-position":"left"}},[i("el-tab-pane",{attrs:{label:"智能网关"}},[i("ul",{staticClass:"ulAddDeviceType"},[i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("remote")}}},[i("i",{staticClass:"icon-mobilefill"}),i("span",[e._v("红外控制器")])])])])]),e._v(" "),i("el-tab-pane",{attrs:{label:"智能面板"}},[i("ul",{staticClass:"ulAddDeviceType"},[i("li",[i("div",{on:{click:function(t){return e.openDialogDevice2("light","灯控")}}},[i("i",{staticClass:"icon-ls_1_light"}),i("span",[e._v("灯控")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice2("dimmer","调光")}}},[i("i",{staticClass:"icon-ls_4_dimmer"}),i("span",[e._v("调光")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice2("curtain","窗帘")}}},[i("i",{staticClass:"icon-ls_23_curtain"}),i("span",[e._v("窗帘")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice2("process_curtain","行程窗帘")}}},[i("i",{staticClass:"icon-ls_12_blind"}),i("span",[e._v("行程窗帘")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice2("scene","场景")}}},[i("i",{staticClass:"icon-ls_32_leave"}),i("span",[e._v("场景")])])])])]),e._v(" "),i("el-tab-pane",{attrs:{label:"智能模块"}},[i("ul",{staticClass:"ulAddDeviceType"},[i("li",[i("div",{on:{click:function(t){return e.openDialogDevice2("module_light","继电器模块")}}},[i("i",{staticClass:"icon-mobilefill"}),i("span",[e._v("继电器模块")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice2("module_dimmer","调光模块")}}},[i("i",{staticClass:"icon-mobilefill"}),i("span",[e._v("调光模块")])])])])]),e._v(" "),i("el-tab-pane",{attrs:{label:"智能温控"}},[i("ul",{staticClass:"ulAddDeviceType"},[i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("ac")}}},[i("i",{staticClass:"icon-ls_7_ac"}),i("span",[e._v("空调")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("heat")}}},[i("i",{staticClass:"icon-ls_2_heating"}),i("span",[e._v("地暖")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("air")}}},[i("i",{staticClass:"icon-ls_22_new_trend"}),i("span",[e._v("新风")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("combo")}}},[i("i",{staticClass:"icon-mobilefill"}),i("span",[e._v("三合一")])])])])]),e._v(" "),i("el-tab-pane",{attrs:{label:"安防传感"}},[i("ul",{staticClass:"ulAddDeviceType"},[i("li",[i("div",{on:{click:function(t){e.dialogVisibleYingshi=!0}}},[i("i",{staticClass:"el-icon-video-camera"}),i("span",[e._v("监控")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_pules","脉冲量")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("脉冲量")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_switch","开关量")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("开关量")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_temperature","温度传感器")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("温度")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_humidity","湿度传感器")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("湿度")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_brightness","亮度传感器")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("亮度")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_pm25","PM2.5传感器")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("PM2.5")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_hcho","甲醛浓度传感器")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("甲醛")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_co2","二氧化碳浓度传感器")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("二氧化碳")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("sensor_ch4","燃气传感器")}}},[i("i",{staticClass:"el-icon-odometer"}),i("span",[e._v("燃气")])])])])]),e._v(" "),i("el-tab-pane",{attrs:{label:"智能遥控"}},[i("ul",{staticClass:"ulAddDeviceType"},[i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("remoteTV")}}},[i("i",{staticClass:"icon-ls_7_ac"}),i("span",[e._v("电视")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("remoteAC")}}},[i("i",{staticClass:"icon-ls_2_heating"}),i("span",[e._v("空调")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("remoteMusic")}}},[i("i",{staticClass:"icon-ls_22_new_trend"}),i("span",[e._v("背景音乐")])])]),e._v(" "),i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("remoteCustom")}}},[i("i",{staticClass:"icon-ls_22_new_trend"}),i("span",[e._v("自定义")])])])])]),e._v(" "),i("el-tab-pane",{attrs:{label:"背景音乐"}}),e._v(" "),i("el-tab-pane",{attrs:{label:"密码锁"}},[i("ul",{staticClass:"ulAddDeviceType"},[i("li",[i("div",{on:{click:function(t){return e.openDialogDevice("nl_lock")}}},[i("i",{staticClass:"icon-lock1"}),i("span",[e._v("耶鲁锁")])])])])])],1)],1)]),e._v(" "),i("el-dialog",{attrs:{title:"添加摄像头",visible:e.dialogVisibleYingshi,width:"90%",modal:!0},on:{"update:visible":function(t){e.dialogVisibleYingshi=t}}},[i("div",{staticClass:"divFormAddDevice"},[i("el-form",{ref:"formYingshi",attrs:{model:e.formYingshi,rules:e.rulesYingshi,"label-width":"100px","label-position":"top","inline-message":!0}},[i("el-form-item",{attrs:{label:"设备名称",prop:"deviceName"}},[i("el-input",{model:{value:e.formYingshi.deviceName,callback:function(t){e.$set(e.formYingshi,"deviceName",t)},expression:"formYingshi.deviceName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeBrand},model:{value:e.formYingshi.brand,callback:function(t){e.$set(e.formYingshi,"brand",t)},expression:"formYingshi.brand"}},e._l(e.cameraBrand,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),"YING_SHI"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"设备序列号",prop:"deviceSerial"}},[i("el-input",{model:{value:e.formYingshi.deviceSerial,callback:function(t){e.$set(e.formYingshi,"deviceSerial",t)},expression:"formYingshi.deviceSerial"}})],1):e._e(),e._v(" "),"YING_SHI"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"设备验证码",prop:"validateCode"}},[i("el-input",{model:{value:e.formYingshi.validateCode,callback:function(t){e.$set(e.formYingshi,"validateCode",t)},expression:"formYingshi.validateCode"}})],1):e._e(),e._v(" "),"HAI_KANG"==e.formYingshi.brand||"DA_HUA"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"IP地址",prop:"ip"}},[i("el-input",{model:{value:e.formYingshi.ip,callback:function(t){e.$set(e.formYingshi,"ip",t)},expression:"formYingshi.ip"}})],1):e._e(),e._v(" "),"HAI_KANG"==e.formYingshi.brand||"DA_HUA"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"用户名",prop:"username"}},[i("el-input",{model:{value:e.formYingshi.username,callback:function(t){e.$set(e.formYingshi,"username",t)},expression:"formYingshi.username"}})],1):e._e(),e._v(" "),"HAI_KANG"==e.formYingshi.brand||"DA_HUA"==e.formYingshi.brand?i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{model:{value:e.formYingshi.password,callback:function(t){e.$set(e.formYingshi,"password",t)},expression:"formYingshi.password"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"楼层房间",prop:"roomId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formYingshi.roomId,callback:function(t){e.$set(e.formYingshi,"roomId",t)},expression:"formYingshi.roomId"}},e._l(e.optionsRooms,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisibleYingshi=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitFormYingshi("formYingshi")}}},[e._v("确 定")])],1)]),e._v(" "),i("DeviceEdit1",{attrs:{deviceEditVisible:e.deviceEdit1Visible,golbal:e.golbal,device:e.device},on:{changeShow:e.showDeviceEdit1}}),e._v(" "),i("DeviceEdit2",{attrs:{deviceEditVisible:e.deviceEdit2Visible,golbal:e.golbal,device:e.device},on:{changeShow:e.showDeviceEdit2}}),e._v(" "),i("BusEdit",{attrs:{deviceEditVisible:e.busEditVisible,golbal:e.golbal,device:e.device},on:{changeShow:e.showBusEdit}}),e._v(" "),i("RemoteEdit",{attrs:{deviceEditVisible:e.remoteEditVisible,golbal:e.golbal,device:e.device},on:{changeShow:e.showRemoteEdit}})],1)},staticRenderFns:[]},si=i("VU/8")(ai,oi,!1,null,null,null).exports,ni={data:function(){return{showDialog:!1,formProject:{id:"",projectSummary:"",projectName:"",floors:[],userMaster:"",isMaster:!1,isAdmin:!1},project:null,rulesProject:{projectName:[{required:!0,message:"请输入项目名称",trigger:"blur"}]}}},props:["projectEditVisible","golbal"],methods:{submitFormProject:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveProject()})},saveProject:function(){var e=null;if(""==this.formProject.id){var t=b.a.uuid();e={id:b.a.uuid(),name:this.formProject.projectName,summary:this.formProject.projectSummary,projectName:this.formProject.projectName,projectSummary:this.formProject.projectSummary,blocks:[{floors:[{id:t,name:"默认楼层",rooms:[{id:b.a.uuid(),name:"默认房间",floorId:t,devices:[]}]}]}],isMaster:1,isAdmin:0},this.golbal.projectList.push(e)}else null!=(e=this.golbal.myProject)&&(e.name=this.formProject.projectName,e.summary=this.formProject.projectSummary,e.projectName=this.formProject.projectName,e.projectSummary=this.formProject.projectSummary);var i=this,a={action:"APP_BACKUP_PROJECT_LOCAL"};a.project=e,a.accessToken=this.golbal.accessToken,p.a.post(i.golbal.GET_DATA,a,{header:{"Content-Type":"application/jsonp"}}).then(function(e){"SUCCESS"==e.data.status||i.$message({type:"error",message:e.data.errorMessage,duration:1e3})}),this.$message({message:"成功保存项目！",type:"success",duration:1e3}),this.$router.back(-1)},deleteProject:function(){var e=this,t=this,i=null;this.$confirm("确认要删除当前项目?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={};if(null==e.project.local&&null!=e.project.blocks){for(var o=0;o<e.golbal.projectList.length;o++){if(e.formProject.id==e.golbal.projectList[o].id||e.formProject.id==e.golbal.projectList[o].projectId){e.golbal.myProject.id==e.formProject.id&&!0,e.golbal.projectList.splice(o,1);break}null==i&&(i=e.golbal.projectList[o])}console.log("删除本地"),a.action="APP_DELETE_PROJECT_LOCAL",a.accessToken=t.golbal.accessToken,a.id=t.formProject.id,p.a.post(t.golbal.GET_DATA,a,{header:{"Content-Type":"application/jsonp"}}).then(function(e){"SUCCESS"==e.data.status||t.$message({type:"error",message:e.data.errorMessage,duration:1e3}),(a={}).action="APP_DELETE_PROJECT",a.accessToken=t.golbal.accessToken,a.id=t.formProject.id,p.a.post(t.golbal.GET_DATA,a,{header:{"Content-Type":"application/jsonp"}}).then(function(e){"SUCCESS"==e.data.status?(t.$message({type:"success",message:"删除成功!",duration:1e3}),setTimeout(function(){t.$router.push({path:"/project"})},1e3)):(t.$message({type:"error",message:e.data.errorMessage,duration:1e3}),t.$router.push({path:"/project"})),b.a.resumeProjectLocal(null,t)})})}}).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})},floorClick:function(e){1!=this.formProject.isMaster&&1!=this.formProject.isAdmin||(this.golbal.editing.floor=e,this.$router.push({name:"floorEdit",params:{floor:e}}))},sceneClick:function(e){1!=this.formProject.isMaster&&1!=this.formProject.isAdmin||(this.golbal.editing.scene=e,this.$router.push({name:"sceneEdit",params:{scene:e}}))},gotoEditName:function(){if(1==this.formProject.isMaster){for(var e=!1,t=0;t<this.golbal.projectListCloud.length;t++){var i=this.golbal.projectListCloud[t];this.formProject.id==i.projectId&&(e=!0)}e?this.$router.push({name:"editValue",params:{obj:this.formProject,key:"userMaster",label:"主账号"}}):this.$alert("请先将项目备份到云端再转让","提示",{confirmButtonText:"确定"})}},gotoEditAdmin:function(e){if(1==this.formProject.isMaster){for(var t=!1,i=0;i<this.golbal.projectListCloud.length;i++){var a=this.golbal.projectListCloud[i];this.formProject.id==a.projectId&&(t=!0)}t?this.$router.push({name:"editValue",params:{obj:e,key:"userAdmin",label:"管理员"}}):this.$alert("请先将项目备份到云端再转让","提示",{confirmButtonText:"确定"})}},addUserAdmin:function(){if(1==this.formProject.isMaster){for(var e=!1,t=0;t<this.golbal.projectListCloud.length;t++){var i=this.golbal.projectListCloud[t];this.formProject.id==i.projectId&&(e=!0)}e?this.$router.push({name:"editValue",params:{obj:"",key:"userAdmin",label:"管理员"}}):this.$alert("请先将项目备份到云端再转让","提示",{confirmButtonText:"确定"})}},sharedClick:function(e){this.$router.push({name:"projectShared",params:{projectId:e}})},projectCancelShareClick:function(e){var t=this;this.$confirm("确认取消对"+e.nickname+"的分享？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"divUserConfirm"}).then(function(){t.projectCancelShare(e)}).catch(function(){})},projectCancelShare:function(e){var t=this;return d()(r.a.mark(function i(){var a;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("删除分享"),(a={}).action="APP_DELETE_PROJECT_SHARE",a.uuid=t.golbal.myUuid,a.projectId=e.projectId,a.userId=e.userId,i.next=8,p()({method:"post",url:t.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 8:"SUCCESS"==i.sent.data.status&&b.a.loadProjectShare(t.formProject.id);case 10:case"end":return i.stop()}},i,t)}))()},setAdminProjectClick:function(e){var t=this,i={action:"APP_SET_ADMIN_PROJECT"};i.accessToken=this.golbal.accessToken,i.projectId=e.projectId,i.parentId=this.formProject.id,i.targetUsername=e.username,i.isAdmin=e.isAdmin?1:0,p.a.post(this.golbal.GET_DATA,i,{header:{"Content-Type":"application/jsonp"}}).then(function(e){"SUCCESS"==e.data.status&&(t.$message({message:"设置成功",type:"success",duration:1e3}),b.a.loadProjectShare(t.formProject.id))})}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.$route.params.project;null==e&&(e=this.golbal.editing.project),null!=e?(console.log(e),this.project=e,this.formProject.id=e.id,this.formProject.projectName=e.name,this.formProject.projectSummary=e.summary,this.formProject.isMaster=e.isMaster,this.formProject.isAdmin=e.isAdmin,null!=e.blocks&&(this.formProject.floors=e.blocks[0].floors,this.formProject.scenes=e.scenes,this.formProject.userMaster=e.master_name,this.formProject.userAdmin=e.userAdmin,null==e.userAdmins&&(e.userAdmins=[]),this.formProject.userAdmins=e.userAdmins,null==this.formProject.userAdmins&&(this.formProject.userAdmins=[]),null!=this.formProject.userAdmin&&-1==this.formProject.userAdmins.indexOf(this.formProject.userAdmin)&&(this.formProject.userAdmins.push(this.formProject.userAdmin),this.formProject.userAdmin=null)),(this.formProject.isMaster||this.formProject.isAdmin)&&b.a.loadProjectShare(this.formProject.id)):(this.formProject.id="",this.formProject.projectName="",this.formProject.projectSummary="",this.formProject.floors=[],this.formProject.scenes=[],this.formProject.userMaster="",this.formProject.userAdmin="",this.formProject.userAdmins=[],this.formProject.isMaster=1,this.formProject.isAdmin=0)},watch:{}},li={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divFormList divFormAndList",staticStyle:{height:"calc(100% - 20px)","overflow-y":"scroll"}},[i("el-form",{ref:"formProject",attrs:{model:e.formProject,rules:e.rulesProject,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"项目名称",prop:"projectName"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formProject.projectName,callback:function(t){e.$set(e.formProject,"projectName",t)},expression:"formProject.projectName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"摘要",prop:"projectSummary"}},[i("el-input",{attrs:{type:"textarea",rows:"2"},model:{value:e.formProject.projectSummary,callback:function(t){e.$set(e.formProject,"projectSummary",t)},expression:"formProject.projectSummary"}})],1),e._v(" "),null!=e.formProject.id&&e.formProject.id.length>0&&(1==e.formProject.isMaster||1==e.formProject.isAdmin)?i("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"楼层"}},[i("ul",{staticClass:"ulFloorEdit",staticStyle:{border:"1px solid #e3e1e1","border-radius":"10px"}},[e._l(e.formProject.floors,function(t){return i("li",{key:t.id,on:{click:function(i){return e.floorClick(t)}}},[i("span",[e._v(e._s(t.name))]),i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-arrow-right"})])])}),e._v(" "),i("li",{on:{click:function(t){return e.floorClick(null)}}},[e._v("添加新楼层"),i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-plus"})])])],2)]):e._e(),e._v(" "),i("el-button",{staticStyle:{"margin-top":"20px",float:"right"},attrs:{type:"primary",size:"mini",disabled:1!=e.formProject.isMaster&&1!=e.formProject.isAdmin},on:{click:function(t){return e.submitFormProject("formProject")}}},[e._v("保存")]),e._v(" "),i("el-button",{staticStyle:{"margin-top":"20px","margin-left":"0px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteProject()}}},[e._v("删除")]),e._v(" "),null!=e.formProject.id&&e.formProject.id.length>0&&1==e.formProject.isMaster?i("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"信息管理"}},[i("div",{staticClass:"drawerShareList"},[i("ul",{staticStyle:{border:"1px solid #e3e1e1","border-radius":"10px"}},[i("li",[i("div",{staticClass:"divGateway3"},[e._v("类型")]),e._v(" "),i("div",{staticClass:"divGateway1"},[e._v("用户名")]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v("昵称")]),e._v(" "),i("div",{staticClass:"divGateway4"},[e._v("操作")])]),e._v(" "),i("li",{on:{click:e.gotoEditName}},[i("div",{staticClass:"divGateway3"},[e._v("主账号")]),e._v(" "),i("div",{staticClass:"divGateway1"},[e._v(e._s(e.golbal.username))]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v(e._s(e.golbal.nickname))]),e._v(" "),i("div",{staticClass:"divGateway4"},[i("i",{staticClass:"el-icon-arrow-right"})])]),e._v(" "),e._l(e.golbal.projectShare,function(t){return[t.isAdmin?i("li",{key:t.username},[i("div",{staticClass:"divGateway3"},[e._v("管理员")]),e._v(" "),i("div",{staticClass:"divGateway1"},[e._v(e._s(t.username))]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v(e._s(null==t.nickname||""==t.nickname?" ":t.nickname))]),e._v(" "),i("div",{staticClass:"divGateway4"},[i("i",{staticClass:"icon-delete2",on:{click:function(i){return e.projectCancelShareClick(t)}}})])]):e._e()]}),e._v(" "),e._l(e.golbal.projectShare,function(t){return[t.isAdmin?e._e():i("li",{key:t.username},[i("div",{staticClass:"divGateway3"},[e._v("用户组")]),e._v(" "),i("div",{staticClass:"divGateway1"},[e._v(e._s(t.username))]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v(e._s(null==t.nickname||""==t.nickname?" ":t.nickname))]),e._v(" "),i("div",{staticClass:"divGateway4"},[i("i",{staticClass:"icon-delete2",on:{click:function(i){return e.projectCancelShareClick(t)}}})])])]})],2)])]):e._e(),e._v(" "),null!=e.formProject.id&&e.formProject.id.length>0&&1==e.formProject.isAdmin?i("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"信息管理"}},[i("div",{staticClass:"drawerShareList"},[i("ul",{staticStyle:{border:"1px solid #e3e1e1","border-radius":"10px"}},[i("li",[i("div",{staticClass:"divGateway3"}),e._v(" "),i("div",{staticClass:"divGateway1"},[e._v("用户名")]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v("昵称")]),e._v(" "),i("div",{staticClass:"divGateway4"},[e._v("删除")])]),e._v(" "),e._l(e.golbal.projectShare,function(t){return i("li",{key:t.username},[i("div",{staticClass:"divGateway3"}),e._v(" "),i("div",{staticClass:"divGateway1"},[e._v(e._s(t.username))]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v(e._s(null==t.nickname||""==t.nickname?" ":t.nickname))]),e._v(" "),i("div",{staticClass:"divGateway4"},[i("i",{staticClass:"icon-delete2",on:{click:function(i){return e.projectCancelShareClick(t)}}})])])})],2)])]):e._e(),e._v(" "),null!=e.formProject.id&&e.formProject.id.length>0&&(1==e.formProject.isMaster||1==e.formProject.isAdmin)?[i("el-button",{staticStyle:{"margin-top":"20px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.sharedClick(e.formProject.id)}}},[e._v("分享")]),e._v(" "),1==e.formProject.isMaster?i("el-button",{staticStyle:{"margin-top":"20px","margin-left":"0px"},attrs:{type:"primary",size:"mini"},on:{click:e.addUserAdmin}},[e._v("添加管理员")]):e._e()]:e._e()],2)],1)])},staticRenderFns:[]},ci=i("VU/8")(ni,li,!1,null,null,null).exports,ri={data:function(){return{showDialog:!1,formFloor:{id:"",name:"",rooms:[]},rulesFloor:{name:[{required:!0,message:"请输入楼层名称",trigger:"blur"}]}}},props:["golbal","floor"],methods:{submitFormFloor:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveFloor()})},saveFloor1:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_SAVE_FLOOR",a.accessToken=i.golbal.accessToken,a.id=i.formFloor.id,null!=e.golbal.editing.project&&(a.projectId=e.golbal.editing.project.id),a.name=i.formFloor.name,t.next=9,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 9:"SUCCESS"==(o=t.sent).data.status?(e.$message({message:"成功保存楼层！",type:"success",duration:1e3}),null==e.golbal.editing.floor?e.golbal.editing.project.blocks[0].floors.push(o.data.floor):e.golbal.editing.floor.name=i.formFloor.name,null!=e.golbal.editing.project.id&&e.golbal.editing.project.id==i.golbal.myProject.id&&null!=o.data.project&&b.a.getData(o.data.project,function(){}),i.showDialog=!1):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 12:case"end":return t.stop()}},t,e)}))()},saveFloor:function(){if(null==this.golbal.editing.floor){var e={id:b.a.uuid(),name:this.formFloor.name,rooms:[]};null==this.golbal.editing.project.blocks&&(this.golbal.editing.project.blocks=[{floors:[]}]),this.golbal.editing.project.blocks[0].floors.push(e),b.a.saveProject(this.golbal.editing.project)}else this.golbal.editing.floor.name=this.formFloor.name,b.a.saveProject(this.golbal.editing.project);this.$message({message:"成功保存楼层！",type:"success",duration:1e3}),this.$router.push({path:"/projectEdit"})},deleteFloor1:function(){var e=this;return d()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("确认要删除当前楼层及其中的房间?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_DELETE_FLOOR",a.floorId=i.formFloor.id,a.accessToken=i.golbal.accessToken,null!=e.golbal.editing.project&&(a.projectId=e.golbal.editing.project.id),t.next=8,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 8:"SUCCESS"==(o=t.sent).data.status?(i.$message({type:"success",message:"删除成功!",duration:1e3}),null!=o.data.project&&b.a.getData(o.data.project,function(){}),e.golbal.editing.project.blocks[0].floors.splice(e.golbal.editing.project.blocks[0].floors.indexOf(e.golbal.editing.floor),1),e.$router.back(-1)):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 11:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})});case 1:case"end":return t.stop()}},t,e)}))()},deleteFloor:function(){var e=this,t=this;this.$confirm("确认要删除当前楼层及其中的房间?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function i(){var a;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a=0;case 1:if(!(a<e.golbal.editing.project.blocks[0].floors.length)){i.next=8;break}if(e.formFloor.id!=e.golbal.editing.project.blocks[0].floors[a].id){i.next=5;break}return e.golbal.editing.project.blocks[0].floors.splice(a,1),i.abrupt("break",8);case 5:a++,i.next=1;break;case 8:b.a.saveProject(e.golbal.editing.project),e.$message({type:"success",message:"删除成功!",duration:1e3}),setTimeout(function(){t.$router.push({path:"/projectEdit"})},1e3);case 11:case"end":return i.stop()}},i,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})},roomClick:function(e){this.golbal.editing.room=e,this.$router.push({name:"roomEdit",params:{room:e}})}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.$route.params.floor;null==e&&(e=this.golbal.editing.floor),null!=e?(this.formFloor.id=e.id,this.formFloor.name=e.name,this.formFloor.rooms=e.rooms):(this.formFloor.id="",this.formFloor.name="",this.formFloor.rooms=[])},watch:{}},ui={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divFormList divFormAndList",staticStyle:{height:"calc(100% - 20px)","overflow-y":"scroll"}},[i("el-form",{ref:"formFloor",attrs:{model:e.formFloor,rules:e.rulesFloor,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"楼层名称",prop:"name"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formFloor.name,callback:function(t){e.$set(e.formFloor,"name",t)},expression:"formFloor.name"}})],1),e._v(" "),null!=e.formFloor.id&&e.formFloor.id.length>0?i("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:"房间"}},[i("ul",[e._l(e.formFloor.rooms,function(t){return i("li",{key:t.id,on:{click:function(i){return e.roomClick(t)}}},[i("span",[e._v(e._s(t.name))]),i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-arrow-right"})])])}),e._v(" "),i("li",{on:{click:function(t){return e.roomClick(null)}}},[e._v("添加房间")])],2)]):e._e(),e._v(" "),i("el-button",{staticStyle:{"margin-top":"20px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitFormFloor("formFloor")}}},[e._v("保存")]),e._v(" "),i("el-button",{staticStyle:{"margin-top":"20px","margin-left":"0px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteFloor()}}},[e._v("删除")])],1)],1)])},staticRenderFns:[]},di=i("VU/8")(ri,ui,!1,null,null,null).exports,mi={data:function(){return{showDialog:!1,formRoom:{id:"",name:"",busId:""},rulesRoom:{name:[{required:!0,message:"请输入房间名称",trigger:"blur"}]}}},props:["golbal","room"],methods:{submitFormRoom:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveRoom()})},saveRoom1:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_SAVE_ROOM",a.id=i.formRoom.id,a.accessToken=i.golbal.accessToken,a.name=i.formRoom.name,null!=e.golbal.editing.project&&(a.projectId=e.golbal.editing.project.id),null!=e.golbal.editing.floor&&(a.floorId=e.golbal.editing.floor.id),a.busId="",t.next=11,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 11:"SUCCESS"==(o=t.sent).data.status?(e.$message({message:"成功保存房间！",type:"success",duration:1e3}),null==e.golbal.editing.room?e.golbal.editing.floor.rooms.push(o.data.room):e.golbal.editing.room.name=i.formRoom.name,null!=e.golbal.editing.project.id&&e.golbal.editing.project.id==i.golbal.myProject.id&&null!=o.data.project&&b.a.getData(o.data.project,function(){})):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 14:case"end":return t.stop()}},t,e)}))()},saveRoom:function(){if(null==this.golbal.editing.room){var e={id:b.a.uuid(),name:this.formRoom.name,floorId:this.golbal.editing.floor.id,devices:[]};null==this.golbal.editing.floor.rooms&&(this.golbal.editing.floor.rooms=[]),this.golbal.editing.floor.rooms.push(e),b.a.saveProject(this.golbal.editing.project)}else this.golbal.editing.room.name=this.formRoom.name,b.a.saveProject(this.golbal.editing.project);this.$message({message:"成功保存房间！",type:"success",duration:1e3}),this.$router.back(-1)},deleteRoom1:function(){var e=this;return d()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("确认要删除当前房间以及其中设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_DELETE_ROOM",a.roomId=i.formRoom.id,a.accessToken=i.golbal.accessToken,null!=e.golbal.editing.project&&(a.projectId=e.golbal.editing.project.id),null!=e.golbal.editing.floor&&(a.floorId=e.golbal.editing.floor.id),t.next=9,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 9:"SUCCESS"==(o=t.sent).data.status?(i.$message({type:"success",message:"删除成功!",duration:1e3}),null!=e.golbal.editing.project.id&&e.golbal.editing.project.id==i.golbal.myProject.id&&null!=o.data.project&&b.a.getData(o.data.project,function(){}),e.golbal.editing.floor.rooms.splice(e.golbal.editing.floor.rooms.indexOf(e.golbal.editing.room),1),e.$router.back(-1)):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 12:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})});case 1:case"end":return t.stop()}},t,e)}))()},deleteRoom:function(){var e=this,t=this;this.$confirm("确认要删除当前房间?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function i(){var a;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:a=0;case 1:if(!(a<e.golbal.editing.floor.rooms.length)){i.next=8;break}if(e.formRoom.id!=e.golbal.editing.floor.rooms[a].id){i.next=5;break}return e.golbal.editing.floor.rooms.splice(a,1),i.abrupt("break",8);case 5:a++,i.next=1;break;case 8:b.a.saveProject(e.golbal.editing.project),e.$message({type:"success",message:"删除成功!",duration:1e3}),setTimeout(function(){t.$router.push({path:"/floorEdit"})},1e3);case 11:case"end":return i.stop()}},i,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.$route.params.room;null!=e&&(this.formRoom.id=e.id,this.formRoom.name=e.name,this.formRoom.busId=e.busId)},watch:{}},hi={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main",staticStyle:{"overflow-y":"scroll"}},[i("div",{staticClass:"divFormList divFormAndList",staticStyle:{"min-height":"calc(100% - 20px)"}},[i("el-form",{ref:"formRoom",attrs:{model:e.formRoom,rules:e.rulesRoom,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"房间名称",prop:"name"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formRoom.name,callback:function(t){e.$set(e.formRoom,"name",t)},expression:"formRoom.name"}})],1),e._v(" "),i("el-button",{staticStyle:{"margin-top":"20px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitFormRoom("formRoom")}}},[e._v("保存")]),e._v(" "),i("el-button",{staticStyle:{"margin-top":"20px","margin-left":"0px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteRoom()}}},[e._v("删除")])],1)],1)])},staticRenderFns:[]},vi=i("VU/8")(mi,hi,!1,null,null,null).exports,pi=[{label:"周日",value:1},{label:"周一",value:2},{label:"周二",value:4},{label:"周三",value:8},{label:"周四",value:16},{label:"周五",value:32},{label:"周六",value:64}],gi=[{label:"场景",value:"SCENE"},{label:"关联",value:"RELATIVE"},{label:"定时",value:"TIMER"},{label:"自动化",value:"AUTOMATION"}],fi=function(e){return e<10?"0"+e:e+""},bi={data:function(){return{title:"编辑场景",showDialog:!1,dialogTimePicker:!1,optionsBuses:[],weekDays:pi,sceneTypes:gi,formScene:{id:"",name:"",sceneType:"TIMER",enabled:!0,days:[],addr:255,code:0,timer:"00:00",conditions:[],actions:[],isRepeat:!1},rulesScene:{name:[{required:!0,message:"请输入自动化名称",trigger:"blur"}]},hourIndex:0,minuteIndex:0,editingTimer:0,isWaitAnswer:!1}},computed:{hours:function(){for(var e=[],t=0;t<=23;t++)e.push({value:t,text:fi(t)});return e},minutes:function(){for(var e=[],t=0;t<=59;t++)e.push({value:t,text:fi(t)});return e},time:function(){return this.hours[this.hourIndex].text+":"+this.minutes[this.minuteIndex].text}},props:["golbal","floor"],methods:{loadSelectOptionBuses:function(){for(var e=[],t=0;t<this.golbal.myProject.buses.length;t++){var i={};i.value=this.golbal.myProject.buses[t].addr,i.label=this.golbal.myProject.buses[t].name,e.push(i)}this.optionsBuses=e},submitScene:function(){var e=this;"TIMER"!=this.formScene.sceneType||0!=this.formScene.days.length?"AUTOMATION"!=this.formScene.sceneType||0!=this.formScene.days.length||null!=this.formScene.conditions&&0!=this.formScene.conditions.length?null!=this.formScene.conditions&&0!=this.formScene.conditions.length||"SCENE"!=this.formScene.sceneType&&"RELATIVE"!=this.formScene.sceneType?null!=this.formScene.actions&&0!=this.formScene.actions.length?this.$confirm("确定要保存并发送当前的"+this.golbal.customTitle+"设置？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.saveScene()}).catch(function(e){console.log(e)}):this.$message({message:"请选择"+this.golbal.customTitle+"的结果",type:"error",duration:1e3}):this.$message({message:"请选择"+this.golbal.customTitle+"的条件",type:"error",duration:1e3}):this.$message({message:"请选择"+this.golbal.customTitle+"的时间或条件",type:"error",duration:1e3}):this.$message({message:"请选择"+this.golbal.customTitle+"的时间",type:"error",duration:1e3})},saveScene:function(){if(("SCENE"==this.formScene.sceneType||"RELATIVE"==this.formScene.sceneType)&&this.formScene.conditions.length>0){var e=this.formScene.conditions[0],t=parseInt(e.device.areacode),i=parseInt(e.device.addr);this.formScene.addr=(t<<8)+i,this.formScene.code=e.device.sceneCode}var a=this.formScene.deleteActions;this.formScene.deleteActions=null;var o=this.golbal.myProject,s=null;null==o.scenes&&(o.scenes=[]);for(var n=0;n<o.scenes.length;n++){var l=o.scenes[n];l.id==this.formScene.id&&(s=l,!0)}null==s&&(s={id:b.a.uuid(),name:"",sceneType:"TIMER",addr:255,code:0,enabled:!0,days:[],timer:"",conditions:[],actions:[]},o.scenes.push(s)),null!=s&&(s.name=this.formScene.name,s.isRepeat=this.formScene.isRepeat,s.days=this.formScene.days,s.timer=this.formScene.timer,s.conditions=this.formScene.conditions,s.actions=this.formScene.actions,s.addr=this.formScene.addr,s.code=this.formScene.code,s.sceneType=this.formScene.sceneType,s.busId=this.formScene.busId,"TIMER"==s.sceneType&&(s.enabled=!0)),b.a.saveProject(this.golbal.myProject),this.$message({message:"成功保存"+this.golbal.customTitle+"！",type:"success",duration:1e3}),this.sendScene(a),"TIMER"==s.sceneType&&w.a.sendAutomationEnabled([s],s.enabled),this.showDialog=!1,this.$router.push({name:"logic",params:{project:this.golbal.myProject,mode:"EDIT"}})},deleteScene:function(){var e=this;this.$confirm("确认要删除当前"+this.golbal.customTitle+"设置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.sendDeleteScene(),i=0;case 2:if(!(i<e.golbal.myProject.scenes.length)){t.next=10;break}if(e.golbal.myProject.scenes[i].id!=e.formScene.id){t.next=7;break}return e.golbal.myProject.scenes.splice(i,1),t.abrupt("break",10);case 7:i++,t.next=2;break;case 10:e.$message({type:"success",message:"删除成功!",duration:1e3}),b.a.saveProject(e.golbal.myProject),e.$router.push({name:"logic",params:{project:e.golbal.myProject,mode:"EDIT"}});case 13:case"end":return t.stop()}},t,e)}))).catch(function(t){console.log(t),e.$message({type:"info",message:"已取消删除",duration:1e3})})},actionClick:function(e){this.golbal.editing.action=e,this.golbal.editing.sceneType="action",null==e&&(this.golbal.editing.selObj=null),this.$router.push({name:"actionEdit",params:{action:e}})},conditionClick:function(e){this.golbal.editing.condition=e,this.golbal.editing.sceneType=this.formScene.sceneType,this.$router.push({name:"conditionEdit",params:{condition:e,sceneType:this.formScene.sceneType}})},sendScene:function(e){var t=this;this.golbal.fullscreenLoading=!0;var i=t.golbal.editing.scene;if(null==i.code||0==i.code)if(i.conditions.length>0){var a=i.conditions[0].device;i.code=a.sceneCode}else t.golbal.editing.scene.code=t.golbal.myProject.scenes.indexOf(t.golbal.editing.scene)+1;setTimeout(function(){w.a.sendAutomation(t.golbal.editing.scene,e,t.isWaitAnswer)},100)},sendDeleteScene:function(){var e=null;if(this.formScene.conditions.length>0){var t=this.formScene.conditions[0];null!=t.device&&(e=t.device)}null!=e&&("SCENE"==this.formScene.sceneType?w.a.sendDeleteScene(e):"RELATIVE"==this.formScene.sceneType&&w.a.sendDeleteRelative(e)),"TIMER"!=this.formScene.sceneType&&"AUTOMATION"!=this.formScene.sceneType||w.a.sendDeleteAutomationOrTimer(this.golbal.editing.scene)},openTimePicker:function(e){console.log(this.formScene.timer),this.editingTimer=e,this.dialogTimePicker=!0;var t="";0==e?t=this.formScene.timer:1==e?t=this.formScene.timer[0]:2==e&&(t=this.formScene.timer[1]),t.length>0&&(this.hourIndex=parseInt(t.split(":")[0]),this.minuteIndex=parseInt(t.split(":")[1]))},handleConfirmTimer:function(){console.log(this.formScene.timer),this.golbal.editing.scene.timer=this.formScene.timer},gotoSetCustomCondition:function(e){var t=e;null==t&&(t={id:"",name:"",summary:"",device:null,deviceName:"",type:"custom",command:""}),this.golbal.editing.action=null,this.golbal.editing.condition=t,this.$router.push({name:"editValue",params:{obj:this.golbal.editing.condition,key:"newCustomCondition",label:"自定义指令"}})},gotoSetLoopTime:function(e){var t=e;null==t&&(t={id:"",name:"",summary:"",device:null,deviceName:"",type:"loop",timeHour:"00",timeMinute:"00",timeSecond:"00"}),this.golbal.editing.action=null,this.golbal.editing.condition=t,this.golbal.editing.scene.conditions.push(t),this.$router.push({name:"editValue",params:{obj:this.golbal.editing.condition,key:"newLoopTime",label:"循环时间"}})},gotoSetCustomCommand:function(e){var t=e;null==t&&(t={id:"",name:"",summary:"",device:null,deviceName:"",delay:0,type:"custom",command:""}),this.golbal.editing.action=t,this.$router.push({name:"editValue",params:{obj:this.golbal.editing.action,key:"newCustomAction",label:"自定义指令"}})},gotoEditName:function(){null==this.golbal.editing.scene&&(this.golbal.editing.scene=this.formScene),this.$router.push({name:"editValue",params:{obj:this.golbal.editing.scene,key:"name",label:"名称"}})},gotoEditDelay:function(e){this.golbal.editing.condition=null,this.golbal.editing.action=e,this.$router.push({name:"editValue",params:{obj:this.golbal.editing.action,key:"delay",label:"延时",datatype:"int",range:[0,255]}})},gotoSelectAction:function(e){if(null==e)return this.golbal.editing.condition=null,this.golbal.editing.action=e,void this.$router.push({name:"selectDevice",params:{selectType:"action"}});null==e.type||"device"==e.type?(this.golbal.editing.condition=null,this.golbal.editing.action=e,this.$router.push({name:"selectDevice",params:{selectType:"action"}})):null!=e.type&&"custom"==e.type&&(this.golbal.editing.action=e,null!=e.deviceId?(this.golbal.editing.condition=null,this.$router.push({name:"selectDevice",params:{selectType:"action"}})):this.$router.push({name:"editValue",params:{obj:this.golbal.editing.action,key:"EditCustomAction",label:"自定义指令"}}))},gotoSelectCondition:function(e){return null!=e&&null!=e.type&&"custom"==e.type?(this.golbal.editing.condition=e,void this.$router.push({name:"editValue",params:{obj:this.golbal.editing.condition,key:"EditCustomCondition",label:"自定义指令"}})):null!=e&&null!=e.type&&"loop"==e.type?(this.golbal.editing.condition=e,void this.$router.push({name:"editValue",params:{obj:this.golbal.editing.condition,key:"newLoopTime",label:"循环时间"}})):void("SCENE"==this.formScene.sceneType&&null!=e||"RELATIVE"==this.formScene.sceneType&&null!=e||(this.golbal.editing.action=null,this.golbal.editing.condition=e,this.$router.push({name:"selectDevice",params:{selectType:"condition"}})))},deleteAction:function(e){var t=this;this.$confirm("确定要删除所选的结果设置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"divUserConfirm"}).then(function(){null==t.formScene.deleteActions&&(t.formScene.deleteActions=[]),t.formScene.deleteActions.push(e),t.formScene.actions.splice(t.formScene.actions.indexOf(e),1)}).catch(function(){})},onSwipeAction:function(e,t){var i=document.querySelector("#right"+t),a=document.querySelector("#left"+t);1==e?(i.style.marginRight="0px",a.style.marginLeft="-50px"):2==e&&(i.style.marginRight="-40px",a.style.marginLeft="0px")},deleteCondition:function(e){var t=this;this.$confirm("确定要删除所选的条件设置?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"divUserConfirm"}).then(function(){t.formScene.conditions.splice(t.formScene.conditions.indexOf(e),1)}).catch(function(){})},onSwipeCondition:function(e,t){if("SCENE"!=this.formScene.sceneType&&"RELATIVE"!=this.formScene.sceneType){var i=document.querySelector("#rightCond"+t),a=document.querySelector("#leftCond"+t);1==e?(i.style.marginRight="0px",a.style.marginLeft="-50px"):2==e&&(i.style.marginRight="-40px",a.style.marginLeft="0px")}},finishClick:function(){this.dialogTimePicker=!1,1==this.editingTimer?this.formScene.timer[0]=this.time:2==this.editingTimer?this.formScene.timer[1]=this.time:0==this.editingTimer&&(this.formScene.timer=this.time,this.formScene.name="定时 "+this.time)},cancelSelect:function(){this.dialogTimePicker=!1},onHourChange:function(e){this.hourIndex=e},onMinuteChange:function(e){this.minuteIndex=e}},mounted:function(){this.loadSelectOptionBuses(),this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.$route.params.scene;null==e&&(e=this.golbal.editing.scene),this.formScene.id="",this.formScene.name="",this.formScene.enabled=!0;var t=(new Date).Format("hh:mm");if(this.formScene.timer=[t,t],this.formScene.days=[],this.formScene.conditions=[],this.formScene.actions=[],this.formScene.isRepeat=!1,null!=this.$route.params.sceneType?this.formScene.sceneType=this.$route.params.sceneType:this.formScene.sceneType="TIMER","TIMER"==this.formScene.sceneType&&(this.formScene.timer=t),null!=e){var i=JSON.parse(l()(e));null==i.sceneType&&("scene"==i.type?i.sceneType="SCENE":"relative"==i.type?i.sceneType="RELATIVE":"timer"==i.type?i.sceneType="TIMER":"automation"==i.type?i.sceneType="AUTOMATION":"securityIn"==i.type?i.sceneType="SECURITY_IN":"securityOut"==i.type&&(i.sceneType="SECURITY_OUT")),null==i.conditions&&(i.conditions=[]),null==i.actions&&(i.actions=[]),null!=i.code&&0!=i.code||(i.code=this.golbal.myProject.scenes.indexOf(e)+1),this.formScene=i,this.golbal.editing.scene=i}else this.golbal.editing.scene=this.formScene,e=this.formScene,"SCENE"==this.formScene.sceneType?this.formScene.name="新建场景":"RELATIVE"==this.formScene.sceneType?this.formScene.name="新建双控":"TIMER"==this.formScene.sceneType?this.formScene.name="新建定时":"AUTOMATION"==this.formScene.sceneType?this.formScene.name="新建自动化":"SECURITY_IN"==this.formScene.sceneType?this.formScene.name="新建在家布防":"SECURITY_OUT"==this.formScene.sceneType?this.formScene.name="新建离家布防":this.formScene.name="新建场景";switch((null==this.formScene.code||this.formScene.code<=0)&&(this.formScene.code=this.golbal.myProject.scenes.length+1),this.formScene.sceneType){case"TIMER":this.golbal.customTitle="定时";break;case"RELATIVE":this.golbal.customTitle="双控";break;case"AUTOMATION":this.golbal.customTitle="自动化";break;case"SCENE":this.golbal.customTitle="场景";break;case"SECURITY_IN":this.golbal.customTitle="在家布防";break;case"SECURITY_OUT":this.golbal.customTitle="离家布防"}null==this.formScene.busId&&("TIMER"!=this.formScene.sceneType&&"AUTOMATION"!=this.formScene.sceneType||(this.formScene.busId=this.optionsBuses[0].value));var a=this;setTimeout(function(){for(var e=document.getElementById("DivLogicListAction"),t=document.getElementsByClassName("panel"),i=0,o=0;o<t.length-1;o++)i+=t[o].clientHeight+20;t[t.length-1].children.length>0&&(i+=t[t.length-1].children[0].clientHeight+40);var s=0;if(t[t.length-1].children.length>1&&(s=t[t.length-1].children[1].clientHeight+1),null!=a.golbal.editing.action&&s>0){var n=a.formScene.actions,l=a.golbal.editing.action,c=-1;for(o=0;o<n.length;o++)n[o].deviceName==l.deviceName&&(c=o);(c+1)*s+i>e.clientHeight&&(e.scrollTop=(c+1)*s+i-e.clientHeight)}},500)}},_i={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mainLogic main"},[i("div",{staticClass:"divFormSceneEdit",attrs:{id:"DivLogicListAction"}},[i("div",{staticClass:"panel"},[i("div",{staticClass:"panelItem",on:{click:e.gotoEditName}},[i("div",{staticClass:"panelLabel"},[e._v(e._s(e.golbal.customTitle)+"名称")]),e._v(" "),i("div",{staticClass:"panelValue"},[e._v(e._s(e.formScene.name))]),e._v(" "),e._m(0)])]),e._v(" "),"TIMER"==e.formScene.sceneType||"AUTOMATION"==e.formScene.sceneType?i("div",{staticClass:"panel"},[i("div",{staticClass:"panelItem",on:{click:e.gotoEditName}},[i("div",{staticClass:"panelLabel"},[e._v("绑定网关")])]),e._v(" "),i("div",{staticClass:"panelItem",staticStyle:{"padding-top":"0px"}},[i("div",{staticStyle:{"text-align":"center"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formScene.busId,callback:function(t){e.$set(e.formScene,"busId",t)},expression:"formScene.busId"}},e._l(e.optionsBuses,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)])]):e._e(),e._v(" "),"TIMER"==e.formScene.sceneType?i("div",{staticClass:"panel"},[i("div",{staticClass:"panelItem"},[i("div",{staticClass:"panelLabel",staticStyle:{width:"35%"}},[e._v("时间")]),e._v(" "),i("div",[i("el-time-picker",{staticClass:"pickerTimer",staticStyle:{width:"40%"},attrs:{size:"small",align:"center","value-format":"HH:mm",format:"HH:mm",placeholder:"任意时间点"},model:{value:e.formScene.timer,callback:function(t){e.$set(e.formScene,"timer",t)},expression:"formScene.timer"}})],1)]),e._v(" "),"AUTOMATION"==e.formScene.sceneType||"TIMER"==e.formScene.sceneType?i("div",{staticClass:"panelItem"},[i("div",{staticClass:"panelLabel"},[e._v("重复运行")]),e._v(" "),i("div",{staticClass:"panelValue",staticStyle:{float:"right"}},[i("el-switch",{attrs:{"active-color":"#f08519","inactive-color":"#c4c4c4"},model:{value:e.formScene.isRepeat,callback:function(t){e.$set(e.formScene,"isRepeat",t)},expression:"formScene.isRepeat"}})],1)]):e._e(),e._v(" "),i("div",{staticClass:"panelItem"},[i("div",{staticStyle:{"text-align":"center"}},[i("el-checkbox-group",{attrs:{size:"mini"},model:{value:e.formScene.days,callback:function(t){e.$set(e.formScene,"days",t)},expression:"formScene.days"}},e._l(e.weekDays,function(t){return i("el-checkbox-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1)])]):e._e(),e._v(" "),"AUTOMATION"==e.formScene.sceneType?i("div",{staticClass:"panel"},[i("div",{staticClass:"panelItem"},[i("div",{staticClass:"panelLabel",staticStyle:{width:"28%"}},[e._v("有效时间")]),e._v(" "),i("el-time-picker",{staticClass:"pickerAutomation",staticStyle:{width:"32%"},attrs:{size:"small",align:"center","value-format":"HH:mm",format:"HH:mm",placeholder:"任意时间点"},model:{value:e.formScene.timer[0],callback:function(t){e.$set(e.formScene.timer,0,t)},expression:"formScene.timer[0]"}}),e._v(" "),i("div",{staticStyle:{float:"left",width:"8%"}},[e._v("至")]),e._v(" "),i("el-time-picker",{staticClass:"pickerAutomation",staticStyle:{width:"32%"},attrs:{size:"small",align:"center","value-format":"HH:mm",format:"HH:mm","picker-options":{minTime:e.formScene.timer[0]},placeholder:"任意时间点"},model:{value:e.formScene.timer[1],callback:function(t){e.$set(e.formScene.timer,1,t)},expression:"formScene.timer[1]"}})],1),e._v(" "),"AUTOMATION"==e.formScene.sceneType||"TIMER"==e.formScene.sceneType?i("div",{staticClass:"panelItem"},[i("div",{staticClass:"panelLabel"},[e._v("重复运行")]),e._v(" "),i("div",{staticClass:"panelValue",staticStyle:{float:"right"}},[i("el-switch",{attrs:{"active-color":"#f08519","inactive-color":"#c4c4c4"},model:{value:e.formScene.isRepeat,callback:function(t){e.$set(e.formScene,"isRepeat",t)},expression:"formScene.isRepeat"}})],1)]):e._e(),e._v(" "),i("div",{staticClass:"panelItem"},[i("div",{staticStyle:{"text-align":"center"}},[i("el-checkbox-group",{attrs:{size:"mini"},model:{value:e.formScene.days,callback:function(t){e.$set(e.formScene,"days",t)},expression:"formScene.days"}},e._l(e.weekDays,function(t){return i("el-checkbox-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1)])]):e._e(),e._v(" "),"AUTOMATION"==e.formScene.sceneType||"SCENE"==e.formScene.sceneType||"RELATIVE"==e.formScene.sceneType?i("div",{staticClass:"panel"},[i("div",{staticClass:"panelItem"},[i("div",{staticClass:"panelLabel"},[e._v("条件设置")]),e._v(" "),"AUTOMATION"==e.formScene.sceneType?i("el-popover",{attrs:{placement:"top",width:"160","popper-class":"popoverLogic"}},[i("ul",{staticStyle:{"list-style":"none","padding-inline-start":"0px","margin-block-end":"0px","margin-block-start":"0px"}},[i("li",{staticStyle:{"border-bottom":"1px solid #cccccc",height:"40px","line-height":"40px"},on:{click:function(t){return e.gotoSelectCondition(null)}}},[e._v("控制设备")]),e._v(" "),i("li",{staticStyle:{"border-bottom":"1px solid #cccccc",height:"40px","line-height":"40px"},on:{click:function(t){return e.gotoSetCustomCondition(null)}}},[e._v("自定义指令")]),e._v(" "),i("li",{staticStyle:{height:"40px","line-height":"40px"},on:{click:function(t){return e.gotoSetLoopTime(null)}}},[e._v("循环时间")])]),e._v(" "),e.formScene.conditions.length<3&&"AUTOMATION"==e.formScene.sceneType?i("div",{staticClass:"divPlus",attrs:{slot:"reference"},slot:"reference"},[e._v("+")]):e._e()]):0==e.formScene.conditions.length&&"SCENE"==e.formScene.sceneType?i("div",{staticClass:"divPlus",on:{click:function(t){return e.gotoSelectCondition(null)}}},[e._v("+")]):0==e.formScene.conditions.length&&"RELATIVE"==e.formScene.sceneType?i("div",{staticClass:"divPlus",on:{click:function(t){return e.gotoSelectCondition(null)}}},[e._v("+")]):e._e()],1),e._v(" "),e.formScene.conditions.length>0?[e._l(e.formScene.conditions,function(t,a){return[i("v-touch",{key:"condition"+a,staticClass:"boxItem",staticStyle:{"touch-action":"pan-y!important",height:"40px","border-top":"1px solid #c1c1c1"},attrs:{tag:"div"},on:{swipeleft:function(t){return e.onSwipeCondition(1,a)},swiperight:function(t){return e.onSwipeCondition(2,a)}}},[i("div",{staticClass:"left",attrs:{id:"leftCond"+a}},[i("div",{staticClass:"panelItem",staticStyle:{"padding-top":"10px"},on:{click:function(i){return e.gotoSelectCondition(t)}}},[i("div",{staticClass:"panelLabel",staticStyle:{width:"80%"}},[e._v(e._s(t.summary))]),e._v(" "),"AUTOMATION"==e.formScene.sceneType?i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-arrow-right"})]):e._e()])]),e._v(" "),i("div",{staticClass:"right",staticStyle:{"margin-top":"0px"},attrs:{id:"rightCond"+a},on:{click:function(i){return i.stopPropagation(),e.deleteCondition(t)}}},[i("i",{staticClass:"el-icon-delete-solid"})])])]})]:[i("div",{staticClass:"panelItem"})]],2):e._e(),e._v(" "),i("div",{staticClass:"panel"},[i("div",{staticClass:"panelItem"},[i("div",{staticClass:"panelLabel"},[e._v("结果设置")]),e._v(" "),"RELATIVE"==e.formScene.sceneType?i("div",{staticClass:"divPlus",on:{click:function(t){return e.gotoSelectAction(null)}}},[e._v("+")]):i("el-popover",{attrs:{placement:"top",width:"160","popper-class":"popoverLogic"}},[i("ul",{staticStyle:{"list-style":"none","padding-inline-start":"0px","margin-block-end":"0px","margin-block-start":"0px"}},[i("li",{staticStyle:{"border-bottom":"1px solid #cccccc",height:"40px","line-height":"40px"},on:{click:function(t){return e.gotoSelectAction(null)}}},[e._v("控制设备")]),e._v(" "),i("li",{staticStyle:{height:"40px","line-height":"40px"},on:{click:function(t){return e.gotoSetCustomCommand(null)}}},[e._v("自定义指令")])]),e._v(" "),i("div",{staticClass:"divPlus",attrs:{slot:"reference"},slot:"reference"},[e._v("+")])])],1),e._v(" "),e.formScene.actions.length>0?[e._l(e.formScene.actions,function(t,a){return["RELATIVE"!=e.formScene.sceneType?i("v-touch",{key:t.id+a,staticClass:"boxItem",staticStyle:{"border-top":"1px solid #c1c1c1"},attrs:{tag:"div"},on:{swipeleft:function(t){return e.onSwipeAction(1,a)},swiperight:function(t){return e.onSwipeAction(2,a)}}},[i("div",{staticClass:"left",attrs:{id:"left"+a}},[i("div",{staticClass:"panelItem",staticStyle:{"padding-top":"10px"},on:{click:function(i){return e.gotoEditDelay(t)}}},[i("div",{staticClass:"panelLabel"},[e._v("延时")]),e._v(" "),i("div",{staticClass:"panelValue"},[e._v(e._s(t.delay)+"秒")]),e._v(" "),i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-arrow-right"})])]),e._v(" "),i("div",{staticClass:"panelItem",on:{click:function(i){return e.gotoSelectAction(t)}}},[i("div",{staticClass:"panelLabel",staticStyle:{width:"90%"}},[e._v(e._s(t.summary))]),e._v(" "),i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-arrow-right"})])])]),e._v(" "),i("div",{staticClass:"right",staticStyle:{"margin-top":"0px"},attrs:{id:"right"+a},on:{click:function(i){return i.stopPropagation(),e.deleteAction(t)}}},[i("i",{staticClass:"el-icon-delete-solid"})])]):i("v-touch",{key:t.id+a,staticClass:"boxItem",staticStyle:{height:"40px","border-top":"1px solid #c1c1c1"},attrs:{tag:"div"},on:{swipeleft:function(t){return e.onSwipeAction(1,a)},swiperight:function(t){return e.onSwipeAction(2,a)}}},[i("div",{staticClass:"left",attrs:{id:"left"+a}},[i("div",{staticClass:"panelItem",staticStyle:{"padding-top":"10px"},on:{click:function(i){return e.gotoSelectAction(t)}}},[i("div",{staticClass:"panelLabel",staticStyle:{width:"90%"}},[e._v(e._s(t.summary))]),e._v(" "),i("div",{staticClass:"divIcon"},[i("i",{staticClass:"el-icon-arrow-right"})])])]),e._v(" "),i("div",{staticClass:"right",staticStyle:{"margin-top":"0px"},attrs:{id:"right"+a},on:{click:function(i){return i.stopPropagation(),e.deleteAction(t)}}},[i("i",{staticClass:"el-icon-delete-solid"})])])]})]:[i("div",{staticClass:"panelItem"})]],2),e._v(" "),i("div",{staticClass:"footerBar"},[i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitScene("formScene")}}},[e._v("保存")]),e._v(" "),i("el-checkbox",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"mini"},model:{value:e.isWaitAnswer,callback:function(t){e.isWaitAnswer=t},expression:"isWaitAnswer"}},[e._v("等待回复")]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"0px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteScene()}}},[e._v("删除")])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"divIcon"},[t("i",{staticClass:"el-icon-arrow-right"})])}]};var yi=i("VU/8")(bi,_i,!1,function(e){i("ktjB")},"data-v-1d57e1c2",null).exports,Ci={data:function(){return{showDialog:!1,formBus:{id:"",name:"",ip:"",mac:"",addr:"",addrcode:"01 ff",roomId:"",rfid:"",relay:""},rulesBus:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]},rooms:[{name:"101",id:1},{name:"102",id:2},{name:"103",id:3},{name:"104",id:4}],optionsRooms:[]}},props:["golbal"],methods:{submitFormBus:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveBus()})},saveBus1:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e.formBus.roomId&&0!=e.formBus.roomId.length){t.next=3;break}return e.$message({type:"error",message:"请选择房间",duration:1e3}),t.abrupt("return");case 3:return i=e,a=b.a.hexStringToBytes(i.formBus.addrcode),(o={}).action="APP_BUS_SAVE",o.id=i.formBus.id,o.accessToken=i.golbal.accessToken,o.projectId=i.golbal.myProject.id,o.name=i.formBus.name,o.addr=i.formBus.addr,o.roomId=i.formBus.roomId,a.length>0&&(o.areacode=a[0],o.areaaddr=a[1]),o.addrcode=i.formBus.addrcode,o.mac=i.formBus.mac,o.ip=i.formBus.ip,o.rfid=i.formBus.rfid,o.relay=i.formBus.relay,null!=e.golbal.editing.project&&(o.projectId=e.golbal.editing.project.id),t.next=22,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(o)),header:{"Content-Type":"application/jsonp"}});case 22:"SUCCESS"==(s=t.sent).data.status?(e.$message({message:"成功保存网关！",type:"success",duration:1e3}),null!=e.golbal.editing.scanBusResult&&e.golbal.editing.scanBusResult.length>0&&e.golbal.editing.scanBusResult.indexOf(e.$route.params.bus)>-1&&e.golbal.editing.scanBusResult.splice(e.golbal.editing.scanBusResult.indexOf(e.$route.params.bus),1),null!=s.data.project&&b.a.getData(s.data.project,function(){if(null!=i.golbal.myProject.buses&&i.golbal.myProject.buses.length>0)for(var e=0;e<i.golbal.myProject.buses.length;e++){var t=i.golbal.myProject.buses[e];t.addr==i.formBus.addr&&Object(_.e)(S.a.receiveData,t.ws_url,function(){w.a.sendSaveBusUserid(t,i.golbal.userId)})}})):e.$message({type:"error",message:s.data.errorMessage,duration:1e3});case 25:case"end":return t.stop()}},t,e)}))()},saveBus:function(){if(null!=this.formBus.roomId&&0!=this.formBus.roomId.length){var e=this,t=b.a.hexStringToBytes(e.formBus.addrcode),i={};i.id=e.formBus.id,i.accessToken=e.golbal.accessToken,i.projectId=e.golbal.myProject.id,i.name=e.formBus.name,i.addr=e.formBus.addr,i.roomId=e.formBus.roomId,t.length>0&&(i.areacode=t[0],i.areaaddr=t[1]),i.addrcode=e.formBus.addrcode,i.mac=e.formBus.mac,i.ip=e.formBus.ip,i.rfid=e.formBus.rfid,i.relay=e.formBus.relay,null!=this.golbal.editing.project&&(i.projectId=this.golbal.editing.project.id);var a=this.golbal.myProject;if(null!=a){var o=null,s=!1;if(null!=a.buses)for(var n=0;n<a.buses.length;n++){var l=a.buses[n];l.addr==i.addr&&(o=l,s=!0)}s?(o.ip=i.ip,o.addr=i.addr,o.ws_url="ws://"+i.ip+":6432/",o.mac=i.mac,o.name=i.name,o.areacode=i.areacode,o.areaaddr=i.areaaddr,o.roomId=i.roomId,o.rfid=i.rfid,o.relay=i.relay,b.a.saveProject(a)):((o={id:b.a.uuid(),name:i.name,ip:i.ip,port:"",ws_url:"ws://"+i.ip+":6432/",mac:i.name,addr:i.addr,isOnline:!0,isScan:!1}).areacode=i.areacode,o.areaaddr=i.areaaddr,o.roomId=i.roomId,o.rfid=i.rfid,o.relay=i.relay,null==a.buses&&(a.buses=[]),a.buses.push(o),b.a.saveProject(a)),this.$message({message:"成功保存网关！",type:"success",duration:1e3}),null!=this.golbal.editing.scanBusResult&&this.golbal.editing.scanBusResult.length>0&&this.golbal.editing.scanBusResult.indexOf(this.$route.params.bus)>-1&&this.golbal.editing.scanBusResult.splice(this.golbal.editing.scanBusResult.indexOf(this.$route.params.bus),1),null!=a&&b.a.getData(a,function(){if(null!=e.golbal.myProject.buses&&e.golbal.myProject.buses.length>0)for(var t=0;t<e.golbal.myProject.buses.length;t++){var i=e.golbal.myProject.buses[t];i.addr==e.formBus.addr&&Object(_.e)(S.a.receiveData,i.ws_url,function(){w.a.sendSaveBusUserid(i,e.golbal.userId)})}e.$router.back(-1)})}else this.$message({type:"error",message:"当前没有选定项目",duration:1e3})}else this.$message({type:"error",message:"请选择房间",duration:1e3})},deleteBus1:function(){var e=this;return d()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("确认要删除该网关？?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_BUS_DELETE",a.busId=i.formBus.id,a.accessToken=i.golbal.accessToken,null!=e.golbal.editing.project?a.projectId=e.golbal.editing.project.id:null!=e.golbal.myProject&&(a.projectId=e.golbal.myProject.id),t.next=8,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 8:"SUCCESS"==(o=t.sent).data.status?(w.a.sendSaveBusUserid(e.$route.params.bus,0),setTimeout(function(){Object(_.c)("ws://"+i.formBus.ip+":6432/"),i.$message({type:"success",message:"删除成功!",duration:1e3}),null!=o.data.project&&b.a.getData(o.data.project,function(){}),i.$router.back(-1)},500)):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 11:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})});case 1:case"end":return t.stop()}},t,e)}))()},deleteBus:function(){var e=this;this.$confirm("确认要删除该网关？?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e,i={};i.busId=t.formBus.id,null!=e.golbal.editing.project?i.projectId=e.golbal.editing.project.id:null!=e.golbal.myProject&&(i.projectId=e.golbal.myProject.id);var a=e.golbal.myProject;if(null!=a){var o=null;if(null!=a.buses)for(var s=0;s<a.buses.length;s++){var n=a.buses[s];n.addr==i.addr&&(o=n,!0)}a.buses.splice(a.buses.indexOf(o),1),w.a.sendSaveBusUserid(e.$route.params.bus,0),setTimeout(function(){Object(_.c)("ws://"+t.formBus.ip+":6432/"),t.$message({type:"success",message:"删除成功!",duration:1e3}),b.a.saveProject(a),b.a.getData(a,function(){}),t.$router.back(-1)},500)}else e.$message({type:"error",message:"当前没有选定项目",duration:1e3})}).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})})},cancelClick:function(){this.$router.back(-1)},loadSelectOptionRooms:function(){for(var e=[],t=0;t<this.golbal.blockCur.floors.length;t++)for(var i=0;i<this.golbal.blockCur.floors[t].rooms.length;i++){var a={};a.value=this.golbal.blockCur.floors[t].rooms[i].id,a.label=this.golbal.blockCur.floors[t].name+" "+this.golbal.blockCur.floors[t].rooms[i].name,e.push(a)}this.optionsRooms=e},sendRFID:function(){null!=this.$route.params.bus&&(w.a.sendGWRFID(this.$route.params.bus,this.formBus.rfid),this.$message({message:"发送成功",type:"success",duration:1e3}))},sendRelay:function(){null!=this.$route.params.bus&&(w.a.sendGWRelay(this.$route.params.bus,this.formBus.relay),this.$message({message:"发送成功",type:"success",duration:1e3}))}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.$route.params.bus;if(null!=e){this.formBus.id=e.id,this.formBus.name=e.name,this.formBus.ip=e.ip,this.formBus.addr=e.addr,this.formBus.roomId=e.roomId,this.formBus.mac=e.mac,this.formBus.roomId=e.roomId,this.formBus.rfid=null==e.rfid?"":e.rfid,this.formBus.relay=null==e.relay?"":e.relay;var t=[e.areacode,e.areaaddr];this.formBus.addrcode=b.a.bytes2hex(t)}this.loadSelectOptionRooms()}},ki={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divForm"},[i("el-form",{ref:"formBus",attrs:{model:e.formBus,rules:e.rulesBus,"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"网关名称",prop:"name"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formBus.name,callback:function(t){e.$set(e.formBus,"name",t)},expression:"formBus.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"IP",prop:"ip"}},[i("el-input",{model:{value:e.formBus.ip,callback:function(t){e.$set(e.formBus,"ip",t)},expression:"formBus.ip"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"UID地址",prop:"addr"}},[i("el-input",{attrs:{readonly:""},model:{value:e.formBus.addr,callback:function(t){e.$set(e.formBus,"addr",t)},expression:"formBus.addr"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备地址",prop:"addrcode"}},[i("el-input",{model:{value:e.formBus.addrcode,callback:function(t){e.$set(e.formBus,"addrcode",t)},expression:"formBus.addrcode"}})],1),e._v(" "),e.formBus.id.length>0?i("el-form-item",{attrs:{label:"无线频道"}},[i("el-select",{staticStyle:{width:"calc(100% - 46px)","margin-right":"2px","margin-top":"1px",float:"left"},attrs:{placeholder:"选择无线频道"},model:{value:e.formBus.rfid,callback:function(t){e.$set(e.formBus,"rfid",t)},expression:"formBus.rfid"}},[i("el-option",{attrs:{label:"0",value:"0"}}),e._v(" "),e._l(40,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})],2),e._v(" "),i("el-button",{attrs:{icon:"el-icon-s-promotion"},on:{click:e.sendRFID}})],1):e._e(),e._v(" "),e.formBus.id.length>0?i("el-form-item",{attrs:{label:"中继使能"}},[i("el-select",{staticStyle:{width:"calc(100% - 46px)","margin-right":"2px","margin-top":"1px",float:"left"},attrs:{placeholder:"设置中继使能"},model:{value:e.formBus.relay,callback:function(t){e.$set(e.formBus,"relay",t)},expression:"formBus.relay"}},[i("el-option",{attrs:{label:"关闭",value:"0"}}),e._v(" "),i("el-option",{attrs:{label:"启动",value:"1"}})],1),e._v(" "),i("el-button",{attrs:{icon:"el-icon-s-promotion"},on:{click:e.sendRelay}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"房间",prop:"roomId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formBus.roomId,callback:function(t){e.$set(e.formBus,"roomId",t)},expression:"formBus.roomId"}},e._l(e.optionsRooms,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitFormBus("formBus")}}},[e._v("保存")]),e._v(" "),i("el-button",{staticStyle:{float:"right","margin-right":"5px"},attrs:{size:"mini"},on:{click:function(t){return e.cancelClick()}}},[e._v("取消")]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"0px"},attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.deleteBus()}}},[e._v("删除")])],1)],1)])},staticRenderFns:[]},Ei=i("VU/8")(Ci,ki,!1,null,null,null).exports,Ti={data:function(){return{logic:0,showDialog:!1,formAction:{id:"",name:"",summary:"",device:null,deviceName:"",delay:0,status:h()({power:{logic:2,value:!0},brightness:{logic:2,value:0},action:{logic:2,value:0},process:{logic:2,value:0},switch:{logic:2,value:0},setTemperature:{logic:2,value:0},mode:{logic:2,value:0},fan:{logic:2,value:0},ac_setTemperature:{logic:2,value:0},ac_mode:{logic:2,value:0},ac_fan:{logic:2,value:0},heat_power:{logic:2,value:0},heat_setTemperature:{logic:2,value:0},air_power:{logic:2,value:0},air_fan:{logic:2,value:0},temperature:{logic:2,value:0},humidity:{logic:2,value:0},pm25:{logic:2,value:0},hcho:{logic:2,value:0},co2:{logic:2,value:0}},"humidity",{logic:2,value:0})},ObjDeviceType:function(){A.a.DEVICE_ACTION_DEFINE.light}}},props:["golbal","action"],methods:{submitAction:function(){var e=null;if(null==this.golbal.editing.action){if(null!=this.golbal.editing.scene){e=JSON.parse(l()(this.formAction));this.golbal.editing.scene.actions.push(e)}}else e=this.golbal.editing.action,this.golbal.editing.action.summary=this.formAction.summary,this.golbal.editing.action.device=this.formAction.device,this.golbal.editing.action.deviceName=this.formAction.deviceName,this.golbal.editing.action.status=this.formAction.status;this.ObjDeviceType=A.a.DEVICE_ACTION_DEFINE[this.formAction.device.type],e.status={};for(var t=0;t<this.ObjDeviceType.actions.length;t++){var i=this.ObjDeviceType.actions[t];e.status[i.key]=JSON.parse(l()(this.formAction.status[i.key]))}this.golbal.editing.action=null,this.$router.back(-1)},deleteRoom:function(){var e=this;return d()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("确认要删除当前房间以及其中设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_DELETE_ROOM",a.roomId=i.formRoom.id,a.accessToken=i.golbal.accessToken,null!=e.golbal.editing.project&&(a.projectId=e.golbal.editing.project.id),null!=e.golbal.editing.floor&&(a.floorId=e.golbal.editing.floor.id),t.next=9,axios({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 9:"SUCCESS"==(o=t.sent).data.status?(i.$message({type:"success",message:"删除成功!",duration:1e3}),null!=e.golbal.editing.project.id&&e.golbal.editing.project.id==i.golbal.myProject.id&&null!=o.data.project&&b.a.getData(o.data.project,function(){}),e.golbal.editing.floor.rooms.splice(e.golbal.editing.floor.rooms.indexOf(e.golbal.editing.room),1),e.$router.back(-1)):e.$message({type:"error",duration:1e3,message:o.data.errorMessage});case 12:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})});case 1:case"end":return t.stop()}},t,e)}))()},goSelectDevice:function(){this.$router.push({name:"selectDevice",params:{selectType:"action"}})}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.golbal.editing.selObj;if(null!=this.golbal.editing.action&&(this.formAction.id=this.golbal.editing.action.id,this.formAction.summary=this.golbal.editing.action.summary,this.formAction.device=this.golbal.editing.action.device,this.formAction.deviceName=this.golbal.editing.action.deviceName,this.formAction.delay=null==this.golbal.editing.action.delay?0:this.golbal.editing.action.delay,null!=this.formAction.device)){this.ObjDeviceType=A.a.DEVICE_ACTION_DEFINE[this.formAction.device.type];for(var t=0;t<this.ObjDeviceType.actions.length;t++){var i=this.ObjDeviceType.actions[t];this.formAction.status[i.key].logic=this.golbal.editing.action.status[i.key].logic,this.formAction.status[i.key].value=this.golbal.editing.action.status[i.key].value}}null!=e&&(this.formAction.device=e.device,this.formAction.deviceName=e.floorName+" "+e.roomName+" "+e.device.name,this.formAction.summary=e.floorName+" "+e.roomName+" "+e.device.name,"boolean"==e.action.type?this.formAction.summary=this.formAction.summary+" "+(e.value?"开":"关"):"int"==e.action.type?this.formAction.summary=this.formAction.summary+" "+(e.action.name+e.value):e.action.type)}},Di={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divForm"},[i("el-form",{attrs:{"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"描述"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formAction.summary,callback:function(t){e.$set(e.formAction,"summary",t)},expression:"formAction.summary"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"延时"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formAction.delay,callback:function(t){e.$set(e.formAction,"delay",t)},expression:"formAction.delay"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备和动作",prop:"deviceName"}},[i("div",{staticClass:"divCondAct",on:{click:e.goSelectDevice}},[e._v(e._s(""==e.formAction.deviceName?"请选择设备":e.formAction.deviceName))])]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitAction()}}},[e._v("确定")]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"0px"},attrs:{type:"danger",size:"mini"}},[e._v("删除")])],1)],1)])},staticRenderFns:[]},Si=i("VU/8")(Ti,Di,!1,null,null,null).exports,wi={data:function(){return{logicOptions:[{label:"大于",value:0},{label:"小于",value:1},{label:"等于",value:2}],logic:0,showDialog:!1,formCondition:{id:"",name:"",summary:"",device:null,deviceName:"",status:h()({power:{logic:2,value:!0},brightness:{logic:2,value:0},action:{logic:2,value:0},process:{logic:2,value:0},switch:{logic:2,value:0},setTemperature:{logic:2,value:0},mode:{logic:2,value:0},fan:{logic:2,value:0},ac_setTemperature:{logic:2,value:0},ac_mode:{logic:2,value:0},ac_fan:{logic:2,value:0},heat_power:{logic:2,value:0},heat_setTemperature:{logic:2,value:0},air_power:{logic:2,value:0},air_fan:{logic:2,value:0},temperature:{logic:2,value:0},humidity:{logic:2,value:0},pm25:{logic:2,value:0},hcho:{logic:2,value:0},co2:{logic:2,value:0}},"humidity",{logic:2,value:0})},ObjDeviceType:function(){A.a.DEVICE_ACTION_DEFINE.light}}},props:["golbal","condition"],methods:{submitCondition:function(){var e=null;null==this.golbal.editing.condition?null!=this.golbal.editing.scene&&(e=JSON.parse(l()(this.formCondition)),this.golbal.editing.scene.conditions.push(e)):e=this.golbal.editing.condition,this.ObjDeviceType=A.a.DEVICE_ACTION_DEFINE[this.formCondition.device.type],e.status={};for(var t=0;t<this.ObjDeviceType.actions.length;t++){var i=this.ObjDeviceType.actions[t];e.status[i.key]=JSON.parse(l()(this.formCondition.status[i.key]))}this.golbal.editing.condition=null,this.$router.back(-1)},saveRoom:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_SAVE_ROOM",a.id=i.formRoom.id,a.accessToken=i.golbal.accessToken,a.name=i.formRoom.name,null!=e.golbal.editing.project&&(a.projectId=e.golbal.editing.project.id),null!=e.golbal.editing.floor&&(a.floorId=e.golbal.editing.floor.id),t.next=10,axios({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 10:"SUCCESS"==(o=t.sent).data.status?(e.$message({message:"成功保存房间！",type:"success",duration:1e3}),null==e.golbal.editing.room?e.golbal.editing.floor.rooms.push(o.data.room):e.golbal.editing.room.name=i.formRoom.name,null!=e.golbal.editing.project.id&&e.golbal.editing.project.id==i.golbal.myProject.id&&null!=o.data.project&&b.a.getData(o.data.project,function(){})):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 13:case"end":return t.stop()}},t,e)}))()},deleteRoom:function(){var e=this;return d()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("确认要删除当前房间以及其中设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(d()(r.a.mark(function t(){var i,a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_DELETE_ROOM",a.roomId=i.formRoom.id,a.accessToken=i.golbal.accessToken,null!=e.golbal.editing.project&&(a.projectId=e.golbal.editing.project.id),null!=e.golbal.editing.floor&&(a.floorId=e.golbal.editing.floor.id),t.next=9,axios({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 9:"SUCCESS"==(o=t.sent).data.status?(i.$message({type:"success",message:"删除成功!",duration:1e3}),null!=e.golbal.editing.project.id&&e.golbal.editing.project.id==i.golbal.myProject.id&&null!=o.data.project&&b.a.getData(o.data.project,function(){}),e.golbal.editing.floor.rooms.splice(e.golbal.editing.floor.rooms.indexOf(e.golbal.editing.room),1),e.$router.back(-1)):e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 12:case"end":return t.stop()}},t,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除",duration:1e3})});case 1:case"end":return t.stop()}},t,e)}))()},goSelectDevice:function(){this.$router.push({name:"selectDevice",params:{selectType:"condition"}})}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e=this.golbal.editing.selObj;if(null!=this.golbal.editing.condition){if(this.formCondition.id=this.golbal.editing.condition.id,this.formCondition.summary=this.golbal.editing.condition.summary,this.formCondition.device=this.golbal.editing.condition.device,this.formCondition.deviceName=this.golbal.editing.condition.deviceName,null!=this.formCondition.device){this.ObjDeviceType=A.a.DEVICE_ACTION_DEFINE[this.formCondition.device.type];for(var t=0;t<this.ObjDeviceType.actions.length;t++){var i=this.ObjDeviceType.actions[t];this.formCondition.status[i.key].logic=this.golbal.editing.condition.status[i.key].logic,this.formCondition.status[i.key].value=this.golbal.editing.condition.status[i.key].value}}}else null!=e&&(this.formCondition.device=e.device,this.formCondition.deviceName=e.floorName+" "+e.roomName+" "+e.device.name,this.formCondition.summary=e.floorName+" "+e.roomName+" "+e.device.name,"boolean"==e.action.type?this.formCondition.summary=this.formCondition.summary+" "+(e.value?"开":"关"):"int"==e.action.type?this.formCondition.summary=this.formCondition.summary+" "+(e.action.name+e.value):e.action.type)}},Ii={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divForm"},[i("el-form",{attrs:{"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{attrs:{label:"描述"}},[i("el-input",{attrs:{clearable:""},model:{value:e.formCondition.summary,callback:function(t){e.$set(e.formCondition,"summary",t)},expression:"formCondition.summary"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备",prop:"deviceName"}},[i("div",{staticClass:"divCondAct",on:{click:e.goSelectDevice}},[e._v(e._s(""==e.formCondition.deviceName?"选择设备":e.formCondition.deviceName))])]),e._v(" "),null!=e.ObjDeviceType?[e._l(e.ObjDeviceType.actions,function(t){return[i("el-form-item",{key:t.key,attrs:{label:t.name}},["boolean"==t.type?i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#c1c1c1"},model:{value:e.formCondition.status[t.key].value,callback:function(i){e.$set(e.formCondition.status[t.key],"value",i)},expression:"formCondition.status[action.key].value"}}):"int"==t.type?i("el-slider",{staticStyle:{width:"100%"},attrs:{"show-tooltip":!1,min:t.range[0],max:t.range[1],"show-input":""},model:{value:e.formCondition.status[t.key].value,callback:function(i){e.$set(e.formCondition.status[t.key],"value",i)},expression:"formCondition.status[action.key].value"}}):"enum"==t.type?i("el-select",{staticStyle:{width:"100%"},model:{value:e.formCondition.status[t.key].value,callback:function(i){e.$set(e.formCondition.status[t.key],"value",i)},expression:"formCondition.status[action.key].value"}},e._l(t.enum,function(e){return i("el-option",{key:e.key,attrs:{label:e.name,value:e.value}})}),1):"logic"==t.type?[i("el-select",{staticStyle:{width:"40%",float:"left"},attrs:{placeholder:"选择判定规则"},model:{value:e.formCondition.status[t.key].logic,callback:function(i){e.$set(e.formCondition.status[t.key],"logic",i)},expression:"formCondition.status[action.key].logic"}},e._l(e.logicOptions,function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),i("el-input-number",{staticStyle:{width:"50%",float:"right"},attrs:{"show-tooltip":!1,min:t.range[0],max:t.range[1]},model:{value:e.formCondition.status[t.key].value,callback:function(i){e.$set(e.formCondition.status[t.key],"value",i)},expression:"formCondition.status[action.key].value"}})]:e._e()],2)]})]:e._e(),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitCondition()}}},[e._v("确定")]),e._v(" "),i("el-button",{staticStyle:{"margin-left":"0px"},attrs:{type:"danger",size:"mini"}},[e._v("删除")])],2)],1)])},staticRenderFns:[]},ji=i("VU/8")(wi,Ii,!1,null,null,null).exports,Oi={components:{DeviceMain:ot,ACPanel:q,RemoteMusicPanel:Pe,RemoteTVPanel:_e,RemoteCustomPanel:Ve,RemoteACPanel:De},data:function(){return{logicOptions:[{label:"大于",value:0},{label:"小于",value:1},{label:"等于",value:2}],slots:[{flex:1,values:["大于","小于","等于"],className:"slot1",textAlign:"right"},{divider:!0,content:"",className:"slot2"},{flex:1,values:["25℃","26℃","27℃","28℃","29℃","30℃","31℃","32℃","33℃","34℃","35℃"],className:"slot3",textAlign:"left"}],selectType:"action",selectDevice:null,dailogSelectActionShow:!1,sliderValue:0,logicDisplay:"等于",logic:2,logicValue:0,ObjDeviceType:function(){A.a.DEVICE_ACTION_DEFINE.light},formCondition:{id:"",name:"",summary:"",device:null,deviceName:"",type:"device",status:h()({power:{logic:2,value:!0},brightness:{logic:2,value:0},action:{logic:2,value:0},process:{logic:2,value:0},switch:{logic:2,value:0},setTemperature:{logic:2,value:0},mode:{logic:2,value:0},fan:{logic:2,value:0},ac_setTemperature:{logic:2,value:0},ac_mode:{logic:2,value:0},ac_fan:{logic:2,value:0},heat_power:{logic:2,value:0},heat_setTemperature:{logic:2,value:0},air_power:{logic:2,value:0},air_fan:{logic:2,value:0},temperature:{logic:2,value:0},humidity:{logic:2,value:0},pm25:{logic:2,value:0},hcho:{logic:2,value:0},co2:{logic:2,value:0}},"humidity",{logic:2,value:0})},formAction:{id:"",name:"",summary:"",device:null,deviceName:"",delay:0,type:"device",command:"",status:h()({power:{logic:2,value:!0},brightness:{logic:2,value:0},action:{logic:2,value:0},process:{logic:2,value:0},switch:{logic:2,value:0},setTemperature:{logic:2,value:0},mode:{logic:2,value:0},fan:{logic:2,value:0},ac_setTemperature:{logic:2,value:0},ac_mode:{logic:2,value:0},ac_fan:{logic:2,value:0},heat_power:{logic:2,value:0},heat_setTemperature:{logic:2,value:0},air_power:{logic:2,value:0},air_fan:{logic:2,value:0},temperature:{logic:2,value:0},humidity:{logic:2,value:0},pm25:{logic:2,value:0},hcho:{logic:2,value:0},co2:{logic:2,value:0}},"humidity",{logic:2,value:0})},selObj:{device:null,roomName:"",floorName:"",action:null,logic:0,value:"",status:{ac:{isOn:!1,value:26,fan:0,mode:"制冷"},heat:{isOn:!1,value:26},air:{isOn:!1,fan:0}}},selObjDemo:{device:null,roomName:"",floorName:"",action:null,logic:0,value:"",status:{ac:{isOn:!1,value:26,fan:0,mode:"制冷"},heat:{isOn:!1,value:26},air:{isOn:!1,fan:0}}}}},props:["golbal"],methods:{onSelectedDevice:function(e){console.log(e.deviceType);var t=null,i=null;if("RELATIVE"!=this.golbal.editing.scene.sceneType){if("SCENE"==this.golbal.editing.scene.sceneType){if("condition"==this.selectType){n=null;return this.golbal.editing.scene.conditions.length>0?(n=this.golbal.editing.scene.conditions[0]).device=e:((n=JSON.parse(l()(this.formCondition))).device=e,this.golbal.editing.scene.conditions.push(n)),this.selObj.device=e,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,n.deviceName=this.selObj.floorName+" "+this.selObj.roomName+" "+this.selObj.device.name,n.summary=this.selObj.floorName+" "+this.selObj.roomName+" "+this.selObj.device.name,this.golbal.editing.scene.name.startsWith("新建")&&(this.golbal.editing.scene.name=n.summary),void this.$router.back(-1)}if("action"==this.selectType){n=null;if(this.golbal.editing.scene.conditions.length>0&&(n=this.golbal.editing.scene.conditions[0]),b.a.isDevEqual(n.device,e))return}}if("action"==this.selectType){i=null;for(var a=0;a<this.golbal.editing.scene.actions.length;a++){var o=null;null!=(c=this.golbal.editing.scene.actions[a]).device&&(o=c.device),null!=c.deviceId&&(o=b.a.getVODeviceById(c.deviceId)),null!=o&&b.a.isDevEqual(o,e)&&(this.golbal.editing.action=c,i=this.golbal.editing.action.status)}if("scene"==e.deviceType||"scene"==e.type){if(this.selectDevice=e,this.selObj.device=e,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.ObjDeviceType=A.a.DEVICE_ACTION_DEFINE[e.type],null!=this.ObjDeviceType.actions&&(this.selObj.action=this.ObjDeviceType.actions[0]),null==i||""==i.value)this.selObj.value=!0,this.updateObj(this.selObj);else if(null!=this.golbal.editing.scene&&null!=this.golbal.editing.action)(a=this.golbal.editing.scene.actions.indexOf(this.golbal.editing.action))>-1&&(e.isOn=!1,w.a.sendAction(e),this.golbal.editing.scene.actions.splice(a,1),this.golbal.editing.action=null);return}}else if("condition"==this.selectType&&null!=this.golbal.editing.condition){i=this.golbal.editing.condition.status,t=this.golbal.editing.condition.device;for(a=0;a<this.golbal.editing.scene.conditions.length;a++){n=this.golbal.editing.scene.conditions[a];if(b.a.isDevEqual(n.device,e)&&!b.a.isDevEqual(e,t))return}}if(this.selectDevice=e,this.selObj.device=e,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.ObjDeviceType=A.a.DEVICE_ACTION_DEFINE[e.type],this.dailogSelectActionShow=!0,null!=this.ObjDeviceType.actions&&(this.selObj.action=this.ObjDeviceType.actions[0]),null!=this.ObjDeviceType.actions)if("logic"==this.ObjDeviceType.actions[0].type){var s=this.ObjDeviceType.actions[0];this.slots[2].values=[];for(a=s.range[0];a<=s.range[1];a++)this.slots[2].values.push(a);switch(this.selObj.logic=i.logic,this.selObj.value=i.value,this.sliderValue=i.value,this.logic=i.logic,this.logic){case 0:this.logicDisplay="大于";break;case 1:this.logicDisplay="小于";break;case 2:this.logicDisplay="等于"}}else"boolean"==this.ObjDeviceType.actions[0].type?null==i||""==i.value?this.selObj.value=!1:this.selObj.value=i.value:"int"==this.ObjDeviceType.actions[0].type?null==i||""==i.value?(this.selObj.value=0,this.sliderValue=0):(this.selObj.value=i.value,this.sliderValue=i.value):"enum"==this.ObjDeviceType.actions[0].type?null==i||""==i.value?this.selObj.value=0:this.selObj.value=i.value:"ac"==this.ObjDeviceType.actions[0].type?null!=i&&(this.selObj.status=i):"combo"==this.ObjDeviceType.actions[0].type?null!=i&&(this.selObj.status=i):"air"==this.ObjDeviceType.actions[0].type?null!=i&&(this.selObj.status=i):"heat"==this.ObjDeviceType.actions[0].type?null!=i&&(this.selObj.status=i):"remoteMusic"==this.ObjDeviceType.actions[0].type?null!=i&&(this.selObj.status=i):"remoteTV"==this.ObjDeviceType.actions[0].type?null!=i&&(this.selObj.status=i):"remoteAC"==this.ObjDeviceType.actions[0].type?null!=i&&(this.selObj.status=i):"remoteCustom"==this.ObjDeviceType.actions[0].type&&null!=i&&(this.selObj.status=i)}else if("action"==this.selectType){var n=null;if(this.golbal.editing.scene.conditions.length>0&&(n=this.golbal.editing.scene.conditions[0]),b.a.isDevEqual(n.device,e))return;var c=null;null!=this.golbal.editing.action?(c=this.golbal.editing.action).deviceId=e.id:((c=JSON.parse(l()(this.formAction))).deviceId=e.id,this.golbal.editing.scene.actions.push(c)),this.selObj.device=e,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,c.deviceName=this.selObj.floorName+" "+this.selObj.roomName+" "+this.selObj.device.name,c.summary=this.selObj.floorName+" "+this.selObj.roomName+" "+this.selObj.device.name,this.$router.back(-1)}else if("condition"==this.selectType){var n=null;this.golbal.editing.scene.conditions.length>0?(n=this.golbal.editing.scene.conditions[0]).device=e:((n=JSON.parse(l()(this.formCondition))).device=e,this.golbal.editing.scene.conditions.push(n)),this.selObj.device=e,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,n.deviceName=this.selObj.floorName+" "+this.selObj.roomName+" "+this.selObj.device.name,n.summary=this.selObj.floorName+" "+this.selObj.roomName+" "+this.selObj.device.name,this.golbal.editing.scene.name.startsWith("新建")&&(this.golbal.editing.scene.name=n.summary),this.$router.back(-1)}},onSelectedCustom:function(e,t){if("action"==this.selectType){for(var i=null,a=0;a<this.golbal.editing.scene.actions.length;a++){var o=this.golbal.editing.scene.actions[a];o.deviceId==e.id&&"custom"==o.type&&o.command==t.cmd&&(this.golbal.editing.action=o,i=o)}if("custom"==e.remoteType){if(null==i)this.selectDevice=e,this.selObj.device=e,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.selObj.keyName=t.name,this.selObj.keyVal=t.cmd,this.updateObj(this.selObj);else if(null!=this.golbal.editing.scene&&null!=this.golbal.editing.action)(a=this.golbal.editing.scene.actions.indexOf(this.golbal.editing.action))>-1&&(this.golbal.editing.scene.actions.splice(a,1),this.golbal.editing.action=null);return}}},switchClick:function(e,t){this.selObj.device=this.selectDevice,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.selObj.action=e,this.selObj.value=t},enumClick:function(e,t){this.selObj.device=this.selectDevice,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.selObj.action=e,this.selObj.value=t},sliderChange:function(e,t){this.selObj.device=this.selectDevice,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.selObj.action=e,this.selObj.value=this.sliderValue},onPickerValuesChange:function(e){switch(this.logicDisplay){case"大于":this.logic=0;break;case"小于":this.logic=1;break;case"等于":this.logic=2}console.log(this.logic),this.selObj.device=this.selectDevice,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.selObj.action=e,this.selObj.logic=this.logic,this.selObj.value=this.sliderValue},submitSensorValue:function(e){this.selObj.device=this.selectDevice,this.selObj.roomName=this.golbal.roomCur.name,this.selObj.floorName=this.golbal.floorCur.name,this.selObj.action=e,this.selObj.logic=this.logic,this.selObj.value=this.logicValue},cancelSelect:function(){this.dailogSelectActionShow=!1,b.a.golbal.editing.selectedDevice=null,this.$router.back(-1)},finishClick:function(){null==this.selObj.action||"combo"!=this.selObj.action.type||null!=this.selObj.channels?(this.selObj.device.type.startsWith("remote")||this.updateObj(this.selObj),this.dailogSelectActionShow=!1,this.selObj=JSON.parse(l()(this.selObjDemo))):this.$alert("请选择三合一面板的动作","提示",{confirmButtonText:"确定"})},updateObj:function(e){if("action"==this.$route.params.selectType){var t=null,i=null;if(null!=this.golbal.editing.action&&(null!=this.golbal.editing.action.device&&(i=this.golbal.editing.action.device),null!=this.golbal.editing.action.deviceId&&(i=b.a.getVODeviceById(this.golbal.editing.action.deviceId)),null!=i&&b.a.isDevEqual(i,e.device)&&(t=this.golbal.editing.action,null!=e.device.deviceType&&e.device.deviceType.startsWith("remote")&&"custom"==e.device.remoteType&&(t=null))),null!=this.golbal.editing.scene&&null==t&&(t=JSON.parse(l()(this.formAction)),this.golbal.editing.scene.actions.push(t)),null==e.device)return;if(i=e.device,t.deviceId=e.device.id,t.deviceName=e.floorName+" "+e.roomName+" "+e.device.name,t.summary=e.floorName+" "+e.roomName+" "+e.device.name,"boolean"==e.action.type)"scene"==i.deviceType?t.status={value:e.value}:(t.summary=t.summary+" "+(e.value?"开":"关"),t.status={value:e.value});else if("int"==e.action.type)t.summary=t.summary+" "+(e.action.name+e.value),t.status={value:e.value};else if("enum"==e.action.type){for(var a="",o=0;o<e.action.enum.length;o++)e.value==e.action.enum[o].value&&(a=e.action.enum[o].name);t.summary=t.summary+" "+a,t.status={value:e.value}}else"ac"==e.action.type?(t.summary=t.summary+" ",t.summary=t.summary+(e.status.ac.isOn?"开":"关"),e.status.ac.isOn&&(t.summary=t.summary+" "+e.status.ac.value+"℃",t.summary=t.summary+" "+e.status.ac.mode,t.summary=t.summary+" "+("1"==e.status.ac.fan?"低速":"2"==e.status.ac.fan?"中速":(e.status.ac.fan,"高速"))),t.status=JSON.parse(l()(e.status))):"heat"==e.action.type?(t.summary=t.summary+" ",t.summary=t.summary+(e.status.heat.isOn?"开":"关"),e.status.heat.isOn&&(t.summary=t.summary+" "+e.status.heat.value+"℃"),t.status=JSON.parse(l()(e.status))):"air"==e.action.type?(t.summary=t.summary+" ",t.summary=t.summary+(e.status.air.isOn?"开":"关"),e.status.air.isOn&&("1"==e.status.air.fan&&"2"==e.status.air.fan&&"3"==e.status.air.fan||(e.status.air.fan="3"),t.summary=t.summary+" "+("1"==e.status.air.fan?"低速":"2"==e.status.air.fan?"中速":(e.status.air.fan,"高速"))),t.status=JSON.parse(l()(e.status))):"combo"==e.action.type?(t.summary=t.summary,e.status.ac.isOn&&(t.summary=t.summary+" 空调:开",t.summary=t.summary+" "+e.status.ac.value+"℃",t.summary=t.summary+" "+e.status.ac.mode,"1"==e.status.ac.fan&&"2"==e.status.ac.fan&&"3"==e.status.ac.fan||(e.status.ac.fan="3"),t.summary=t.summary+" "+("1"==e.status.ac.fan?"低速":"2"==e.status.ac.fan?"中速":(e.status.ac.fan,"高速"))),e.status.heat.isOn&&(t.summary=t.summary+" 地暖:开",t.summary=t.summary+" "+e.status.heat.value+"℃"),e.status.air.isOn&&(t.summary=t.summary+" 新风:开","1"==e.status.ac.fan&&"2"==e.status.ac.fan&&"3"==e.status.ac.fan||(e.status.ac.fan="3"),t.summary=t.summary+" "+("1"==e.status.ac.fan?"低速":"2"==e.status.ac.fan?"中速":(e.status.ac.fan,"高速"))),t.status=JSON.parse(l()(e.status)),t.channels=JSON.parse(l()(e.channels))):"remoteMusic"==e.action.type?null!=e&&(t.device=null,t.type="custom",t.summary=t.summary+" "+e.keyName,t.command=e.keyVal):"remoteTV"==e.action.type?null!=e&&(t.device=null,t.type="custom",t.summary=t.summary+" "+e.keyName,t.command=e.keyVal):"remoteAC"==e.action.type?null!=e&&(t.device=null,t.type="custom",t.summary=t.summary+" "+e.keyName,t.command=e.keyVal):"remoteCustom"==e.action.type&&null!=e&&(t.device=null,t.type="custom",t.summary=t.summary+" "+e.keyName,t.command=e.keyVal);this.sendControl(e)}if("condition"==this.$route.params.selectType){var s=null;if(null==this.golbal.editing.condition?null!=this.golbal.editing.scene&&(s=JSON.parse(l()(this.formCondition)),this.golbal.editing.scene.conditions.push(s)):s=this.golbal.editing.condition,s.device=e.device,s.deviceName=e.floorName+" "+e.roomName+" "+e.device.name,s.summary=e.floorName+" "+e.roomName+" "+e.device.name,null!=e.logic&&(s.logic=e.logic),"boolean"==e.action.type)s.status={value:e.value},s.summary=s.summary+" "+(e.value?"开":"关");else if("int"==e.action.type)s.status={value:e.value},s.summary=s.summary+" "+(e.action.name+e.value);else if("enum"==e.action.type);else if("logic"==e.action.type){var n=null==e.logic?"等于":0==e.logic?"大于":1==e.logic?"小于":2==e.logic?"等于":"";s.status={logic:e.logic,value:e.value},s.summary=s.summary+" "+n+" "+e.value}this.golbal.editing.scene.name.startsWith("新建")&&(this.golbal.editing.scene.name=s.summary)}},sendControl:function(e){null!=e.action&&("boolean"==e.action.type?(e.device.isOn=e.value,w.a.sendAction(e.device)):"int"==e.action.type?(e.device.value=e.value,w.a.sendAction(e.device)):"enum"==e.action.type&&(e.device.value=e.value,w.a.sendAction(e.device)))},onClickPlus:function(){this.sliderValue++},onClickMinus:function(){this.sliderValue--},deleteAction:function(){if(null!=this.golbal.editing.scene&&null!=this.golbal.editing.action){var e=this.golbal.editing.scene.actions.indexOf(this.golbal.editing.action);e>-1&&(this.golbal.editing.scene.actions.splice(e,1),this.golbal.editing.action=null)}this.dailogSelectActionShow=!1,this.selObj=JSON.parse(l()(this.selObjDemo))},getArrCommand:function(e){var t=[];if(null!=e)for(var i=0;i<this.golbal.editing.scene.actions.length;i++){var a=this.golbal.editing.scene.actions[i];a.deviceId==e.id&&"custom"==a.type&&t.push(a.command)}return t}},mounted:function(){this.golbal.showButtonFloor=!0,this.golbal.showButtonShare=!1,this.golbal.showCaseTopRight="FLOOR",this.golbal.showCaseTopLeft="BACK",this.golbal.menuCur="room",this.selectType=this.$route.params.selectType,this.$refs.DeviceMain.resetUlWidth()},updated:function(){this.$refs.DeviceMain.resetUlWidth()}},Pi={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("DeviceMain",{ref:"DeviceMain",attrs:{golbal:e.golbal,mode:"SELECT",selectType:e.selectType},on:{onSelectedDevice:e.onSelectedDevice}}),e._v(" "),i("el-drawer",{staticStyle:{outline:"transparent"},attrs:{title:"选择标题",visible:e.dailogSelectActionShow,direction:"btt",modal:!0,wrapperClosable:!0,withHeader:!1,"modal-append-to-body":!0,"append-to-body":!0,size:null==e.selectDevice?"40%":"ac"==e.selectDevice.type||"fan"==e.selectDevice.type||"air"==e.selectDevice.type||"combo"==e.selectDevice.type?"60%":e.selectDevice.type.startsWith("remote")?"100%":"40%"},on:{"update:visible":function(t){e.dailogSelectActionShow=t}}},[i("div",{staticClass:"dialogPanel"},[i("div",{staticClass:"titleBar"},[i("div",{staticClass:"divIcon",staticStyle:{float:"left",height:"30px","padding-top":"10px",width:"10%","text-align":"center","line-height":"30px"},on:{click:e.cancelSelect}},[i("i",{staticClass:"el-icon-arrow-left"})]),e._v(" "),i("div",{staticClass:"title"},[e._v(e._s(null==e.selectDevice?"":e.selectDevice.name))]),e._v(" "),i("div",{staticClass:"titleRight",staticStyle:{float:"right","margin-right":"10px"},on:{click:e.finishClick}},[e._v("确定")])]),e._v(" "),e._l(e.ObjDeviceType.actions,function(t){return[i("div",{key:t.key,staticStyle:{"text-align":"center"}},["boolean"==t.type?[i("ul",[i("li",{style:null!=e.selObj.value&&e.selObj.value?"background-color:#f08519":"",on:{click:function(i){return e.switchClick(t,!0)}}},[e._v(e._s(null==t.labelOn?"开":t.labelOn))]),e._v(" "),i("li",{style:null!=e.selObj.value?e.selObj.value?"":"background-color:#f08519":"",on:{click:function(i){return e.switchClick(t,!1)}}},[e._v(e._s(null==t.labelOff?"关":t.labelOff))]),e._v(" "),i("li",{on:{click:function(i){return e.deleteAction(t)}}},[e._v("取消")])])]:"int"==t.type?[i("ul",[i("li",{staticStyle:{height:"68px"}},[i("div",{staticStyle:{width:"90%","margin-left":"5%","text-align":"center"}},[e._v(e._s(e.sliderValue)+e._s(100==t.range[1]?"%":""))]),e._v(" "),i("el-slider",{staticStyle:{width:"90%","margin-left":"5%"},attrs:{"show-tooltip":!1,min:t.range[0],max:t.range[1]},on:{change:function(i){return e.sliderChange(t,e.sliderValue)}},model:{value:e.sliderValue,callback:function(t){e.sliderValue=t},expression:"sliderValue"}})],1),e._v(" "),i("li",{on:{click:function(i){return e.deleteAction(t)}}},[e._v("取消")])])]:e._e(),e._v(" "),"enum"==t.type?[i("ul",[e._l(t.enum,function(a){return i("li",{key:a.key,style:null!=e.selObj.value&&e.selObj.value==a.value?"background-color:#f08519":"",on:{click:function(i){return e.enumClick(t,a.value)}}},[e._v(e._s(a.name))])}),e._v(" "),i("li",{on:{click:function(i){return e.deleteAction(t)}}},[e._v("取消")])],2)]:"logic"==t.type?[i("el-radio-group",{attrs:{size:"mini"},on:{change:function(i){return e.onPickerValuesChange(t)}},model:{value:e.logicDisplay,callback:function(t){e.logicDisplay=t},expression:"logicDisplay"}},e._l(e.logicOptions,function(e){return i("el-radio-button",{key:e.value,attrs:{label:e.label}})}),1),e._v(" "),i("div",{staticStyle:{width:"90%","margin-left":"5%","margin-top":"20px","text-align":"center"}},[e._v(e._s(e.sliderValue))]),e._v(" "),i("div",{staticClass:"btnSlider btnSlider1",on:{click:function(t){return t.stopPropagation(),e.onClickMinus(t)}}},[i("i",{staticClass:"icon-move1"})]),e._v(" "),i("el-slider",{staticStyle:{width:"70%",float:"left"},attrs:{"show-tooltip":!1,min:t.range[0],max:t.range[1]},on:{change:function(i){return e.sliderChange(t,e.sliderValue)}},model:{value:e.sliderValue,callback:function(t){e.sliderValue=t},expression:"sliderValue"}}),e._v(" "),i("div",{staticClass:"btnSlider btnSlider3",on:{click:function(t){return t.stopPropagation(),e.onClickPlus(t)}}},[i("i",{staticClass:"icon-add1"})])]:"ac"==t.type||"combo"==t.type||"heat"==t.type||"air"==t.type?[i("ACPanel",{ref:"acpanel",refInFor:!0,attrs:{golbal:e.golbal,selObj:e.selObj}})]:"remoteMusic"==t.type?[i("RemoteMusicPanel",{ref:"musicpanel",refInFor:!0,attrs:{golbal:e.golbal,device:e.selObj.device,mode:"SELECT",arr_command:e.getArrCommand(e.selObj.device)},on:{onSelectedCustom:e.onSelectedCustom}})]:"remoteTV"==t.type?[i("RemoteTVPanel",{ref:"tvpanel",refInFor:!0,attrs:{golbal:e.golbal,device:e.selObj.device,mode:"SELECT",arr_command:e.getArrCommand(e.selObj.device)},on:{onSelectedCustom:e.onSelectedCustom}})]:"remoteAC"==t.type?[i("RemoteACPanel",{ref:"remoteacpanel",refInFor:!0,attrs:{golbal:e.golbal,device:e.selObj.device,mode:"SELECT",arr_command:e.getArrCommand(e.selObj.device)},on:{onSelectedCustom:e.onSelectedCustom}})]:"remoteCustom"==t.type?[i("RemoteCustomPanel",{ref:"remotecustompanel",refInFor:!0,attrs:{golbal:e.golbal,device:e.selObj.device,mode:"SELECT",arr_command:e.getArrCommand(e.selObj.device)},on:{onSelectedCustom:e.onSelectedCustom}})]:e._e()],2)]})],2)])],1)},staticRenderFns:[]};var Ri=i("VU/8")(Oi,Pi,!1,function(e){i("aqBC")},"data-v-4f214c54",null).exports,xi={data:function(){return{editObj:{name:"",password:"",command:"",summary:"",timeHour:"",timeMinute:"",timeSecond:""},label:"",key:"name",obj:null,datatype:"string",range:[0,255],optionH:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],optionM:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],optionS:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]}},props:["golbal"],methods:{bankCardKeyup:function(){console.log(this.editObj.command),this.editObj.command=this.editObj.command.replace(/[^0123456789abcdefABCDEF]/g,"").replace(/([0123456789abcdefABCDEF]{2})(?=[0123456789abcdefABCDEF])/g,"$1 ")},saveValue:function(){var e=document.getElementById("InputValue");null!=e&&(this.editObj.name=e.children[0].children[2].children[0].value),null!=this.obj&&(this.obj[this.key]=this.editObj.name),this.$router.back(-1)},saveCustomCommand:function(){if(null!=this.editObj.command&&0!=this.editObj.command.trim().length)if(null!=this.editObj.summary&&0!=this.editObj.summary.trim().length){var e=b.a.hexStringToBytes(this.editObj.command);null!=e&&0!=e.length?(this.obj.summary=this.editObj.summary,this.obj.command=this.editObj.command,"newCustomCondition"==this.key?this.golbal.editing.scene.conditions.push(this.obj):"newCustomAction"==this.key&&this.golbal.editing.scene.actions.push(this.obj),this.$router.back(-1)):this.$message({type:"error",message:"请输入正确的指令码",duration:1e3})}else this.$message({type:"error",message:"请输入备注",duration:1e3});else this.$message({type:"error",message:"请输入指令",duration:1e3})},saveLoopTime:function(){this.obj.summary="循环时间 "+this.editObj.timeHour+":"+this.editObj.timeMinute+":"+this.editObj.timeSecond,this.obj.timeHour=this.editObj.timeHour,this.obj.timeMinute=this.editObj.timeMinute,this.obj.timeSecond=this.editObj.timeSecond,this.$router.back(-1)},transferProjectClick:function(){var e=this;this.$confirm("转让当前项目给该用户，并删除当前的项目？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.transferProject()}).catch(function(){})},transferProject:function(){var e=this;return d()(r.a.mark(function t(){var i,a,o,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e,(a={}).action="APP_TRANSFER_PROJECT",a.accessToken=e.golbal.accessToken,a.projectId=e.golbal.editing.project.id,a.targetUsername=e.editObj.name,a.targetPassword=e.editObj.password,t.next=9,p()({method:"post",url:i.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 9:if("SUCCESS"!=(o=t.sent).data.status){t.next=25;break}e.$message({message:"转让成功",type:"success",duration:1e3}),s=0;case 13:if(!(s<e.golbal.projectList.length)){t.next=20;break}if(e.golbal.editing.project.id!=e.golbal.projectList[s].id){t.next=17;break}return e.golbal.projectList.splice(s,1),t.abrupt("break",20);case 17:s++,t.next=13;break;case 20:b.a.saveLocalSystem("projectList"+e.golbal.userId+".json",l()(e.golbal.projectList)),i.$message({type:"success",message:"删除成功!",duration:1e3}),e.golbal.myProject.id==e.golbal.editing.project.id&&b.a.getData(null),t.next=26;break;case 25:e.$message({type:"error",message:o.data.errorMessage,duration:1e3});case 26:case 27:case"end":return t.stop()}},t,e)}))()},setAdminProjectClick:function(){var e=this,t={action:"APP_SET_ADMIN_PROJECT"};t.accessToken=this.golbal.accessToken,t.projectId=this.golbal.editing.project.id,t.parentId=this.golbal.editing.project.id,t.targetUsername=this.editObj.name,t.isAdmin=1,p.a.post(this.golbal.GET_DATA,t,{header:{"Content-Type":"application/jsonp"}}).then(function(t){"SUCCESS"==t.data.status?(e.$message({message:"设置成功",type:"success",duration:1e3}),null==e.golbal.editing.project.userAdmins&&(e.golbal.editing.project.userAdmins=[]),e.golbal.editing.project.userAdmins.indexOf(e.obj)>-1&&e.golbal.editing.project.userAdmins.splice(e.golbal.editing.project.userAdmins.indexOf(e.obj),1),e.golbal.editing.project.userAdmins.push(e.editObj.name),b.a.saveProject(e.golbal.editing.project),e.$router.back(-1)):e.$message({message:t.data.errorMessage,type:"error",duration:1e3})})},deleteAdminProjectClick:function(){var e=this,t={action:"APP_SET_ADMIN_PROJECT"};t.accessToken=this.golbal.accessToken,t.projectId=this.golbal.editing.project.id,t.targetUsername="",t.targetUsernameOld=this.obj,p.a.post(this.golbal.GET_DATA,t,{header:{"Content-Type":"application/jsonp"}}).then(function(t){"SUCCESS"==t.data.status&&(e.$message({message:"删除成功",type:"success",duration:1e3}),e.golbal.editing.project.userAdmin==e.obj&&(e.golbal.editing.project.userAdmin=null),null==e.golbal.editing.project.userAdmins&&(e.golbal.editing.project.userAdmins=[]),e.golbal.editing.project.userAdmins.indexOf(e.obj)>-1&&e.golbal.editing.project.userAdmins.splice(e.golbal.editing.project.userAdmins.indexOf(e.obj),1),b.a.saveProject(e.golbal.editing.project),e.$router.back(-1))})},userLogout:function(){var e=this;return d()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(i={}).action="APP_USER_LOGOUT",i.uuid=e.golbal.myUuid,t.next=5,p()({method:"post",url:e.golbal.GET_DATA,data:"data="+escape(l()(i)),header:{"Content-Type":"application/jsonp"}});case 5:"SUCCESS"==(a=t.sent).data.status?(e.golbal.username="",e.golbal.nickname="",e.golbal.accessToken="",e.golbal.refreshToken="",e.golbal.projectId="",e.golbal.isMaster=0,e.golbal.projectList=[],b.a.getData(a.data.project),e.$router.push({path:"/login"})):e.$message({type:"error",message:a.data.errorMessage,duration:1e3});case 8:case"end":return t.stop()}},t,e)}))()}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK",this.obj=this.$route.params.obj,this.key=this.$route.params.key,this.datatype=null==this.$route.params.datatype?"string":this.$route.params.datatype,this.range=null==this.$route.params.range?[0,255]:this.$route.params.range,this.label=this.$route.params.label,null!=this.obj&&("userMaster"==this.key?(this.editObj.name="",this.editObj.password="",this.golbal.customTitle="修改主账号"):"userAdmin"==this.key?(this.editObj.name=this.obj,this.golbal.customTitle="添加管理员"):"newCustomCondition"==this.key||"newCustomAction"==this.key||"EditCustomAction"==this.key||"EditCustomCondition"==this.key?(this.golbal.customTitle="自定义指令",this.editObj.summary=this.obj.summary,this.editObj.command=this.obj.command):"newLoopTime"==this.key?(this.editObj.timeHour=this.obj.timeHour,this.editObj.timeMinute=this.obj.timeMinute,this.editObj.timeSecond=this.obj.timeSecond,this.golbal.customTitle="设置循环时间"):(this.golbal.customTitle="编辑值","int"==this.datatype?this.editObj.name=parseInt(this.obj[this.key]):this.editObj.name=this.obj[this.key]))}},Ai={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divForm",style:"userMaster"==e.key||"newCustomCondition"==e.key||"newCustomAction"==e.key||"EditCustomAction"==e.key||"EditCustomCondition"==e.key?"height:140px":"newLoopTime"==e.key?"height:240px":"height:80px"},["userMaster"==e.key?[i("el-input",{attrs:{clearable:"",placeholder:"用户名"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}}),e._v(" "),i("br"),i("br"),e._v(" "),i("el-input",{attrs:{clearable:"",placeholder:"密码","show-password":""},model:{value:e.editObj.password,callback:function(t){e.$set(e.editObj,"password",t)},expression:"editObj.password"}}),e._v(" "),i("el-button",{staticStyle:{"margin-top":"10px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.transferProjectClick}},[e._v("保存")])]:"userAdmin"==e.key?[i("el-input",{attrs:{clearable:"",placeholder:"用户名"},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}}),e._v(" "),i("el-button",{staticStyle:{"margin-top":"10px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.setAdminProjectClick}},[e._v("保存")])]:"newCustomCondition"==e.key||"newCustomAction"==e.key||"EditCustomAction"==e.key||"EditCustomCondition"==e.key?[i("el-input",{attrs:{clearable:"",placeholder:"备注"},model:{value:e.editObj.summary,callback:function(t){e.$set(e.editObj,"summary",t)},expression:"editObj.summary"}}),e._v(" "),i("br"),i("br"),e._v(" "),i("el-input",{attrs:{clearable:"",placeholder:"命令",maxlength:"47"},on:{input:e.bankCardKeyup},model:{value:e.editObj.command,callback:function(t){e.$set(e.editObj,"command",t)},expression:"editObj.command"}}),e._v(" "),i("el-button",{staticStyle:{"margin-top":"10px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.saveCustomCommand}},[e._v("保存")])]:"newLoopTime"==e.key?[i("el-form",{ref:"form",attrs:{model:e.editObj,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"选择时"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editObj.timeHour,callback:function(t){e.$set(e.editObj,"timeHour",t)},expression:"editObj.timeHour"}},e._l(e.optionH,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"选择分"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editObj.timeMinute,callback:function(t){e.$set(e.editObj,"timeMinute",t)},expression:"editObj.timeMinute"}},e._l(e.optionM,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"选择秒"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editObj.timeSecond,callback:function(t){e.$set(e.editObj,"timeSecond",t)},expression:"editObj.timeSecond"}},e._l(e.optionS,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),i("el-button",{staticStyle:{"margin-top":"10px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.saveLoopTime}},[e._v("保存")])],1)]:["string"==e.datatype?i("el-input",{attrs:{clearable:""},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}}):e._e(),e._v(" "),"int"==e.datatype?i("el-slider",{staticStyle:{width:"90%","margin-left":"5%"},attrs:{id:"InputValue","show-tooltip":!1,min:e.range[0],max:e.range[1],"show-input":"",debounce:100},model:{value:e.editObj.name,callback:function(t){e.$set(e.editObj,"name",t)},expression:"editObj.name"}}):e._e(),e._v(" "),i("el-button",{staticStyle:{"margin-top":"10px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.saveValue}},[e._v("保存")])]],2)])},staticRenderFns:[]},Li=i("VU/8")(xi,Ai,!1,null,null,null).exports,Ni={data:function(){return{editProject:null,dataShared:[],defaultProps:{children:"children",label:"label"},defaultExpend:[],filterText:"",showDialog:!1,qrcode:"http://app.lk-control.com/txt2qrcode?txt="+escape(this.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+this.golbal.myProject.id),showDialogToUser:!1,toUser:""}},props:["golbal","floor"],methods:{initDataShared:function(){this.dataShared=[],this.defaultExpend=[];for(var e=this.golbal.myProject,t=this.$route.params.projectId,i=0;i<this.golbal.projectList.length;i++)this.golbal.projectList[i].id==t&&(e=this.golbal.projectList[i]);if(null!=e){this.editProject=this.golbal.myProject;for(i=0;i<e.blocks[0].floors.length;i++){var a=e.blocks[0].floors[i],o={id:a.id,label:a.name,children:[],type:"floor"};this.defaultExpend.push(a.id),this.dataShared.push(o);for(var s=0;s<a.rooms.length;s++){var n=a.rooms[s],l={id:n.id,label:n.name,children:[],type:"room"};o.children.push(l)}}}},createSharedProject:function(){var e=this;return d()(r.a.mark(function t(){var i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e.editProject){t.next=2;break}return t.abrupt("return");case 2:if(0!=e.$refs.tree.getCheckedNodes().length){t.next=6;break}return e.$message({type:"error",message:"请最少选择一个设备再分享",duration:1e3}),t.abrupt("return");case 6:return t.next=8,e.upload();case 8:i=t.sent,e.qrcode=i,e.showDialog=!0;case 11:case"end":return t.stop()}},t,e)}))()},createSharedProjectToUser:function(){null!=this.editProject&&(0!=this.$refs.tree.getCheckedNodes().length?this.showDialogToUser=!0:this.$message({type:"error",message:"请最少选择一个设备再分享",duration:1e3}))},upload:function(e){var t=this;return d()(r.a.mark(function i(){var a,o,s,n,c,u,d,m,h,v;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:for(console.log(t.editProject),a=t.$refs.tree.getCheckedNodes(),o=[],null!=t.editProject&&null!=t.editProject.buses&&(o=JSON.parse(l()(t.editProject.buses))),s={id:b.a.uuid(),parentId:t.editProject.id,name:t.editProject.name,active:!1,blocks:[{id:b.a.uuid(),name:"",floors:[]}],buses:o,VERSION:1},n=0;n<a.length;n++)"device"==a[n].type&&(null==(c=t.getFloorById(s,a[n].id))&&(c=t.createFloorById(a[n].id),s.blocks[0].floors.push(c)),null!=c&&(null==(u=t.getRoomById(s,a[n].id))&&null!=(u=t.createRoomById(a[n].id))&&c.rooms.push(u),null!=u&&u.devices.push(a[n].tag))),"room"==a[n].type&&(null==(c=t.getFloorById(s,a[n].id))&&(c=t.createFloorById(a[n].id),s.blocks[0].floors.push(c)),null!=c&&null==(u=t.getRoomById(s,a[n].id))&&null!=(u=t.createRoomById(a[n].id))&&c.rooms.push(u));if(console.log(s),d=t,null!=s){i.next=10;break}return i.abrupt("return");case 10:return(m={}).action="APP_SUBMIT_SUB_PROJECT",m.project=s,null!=e&&(m.toUser=e),m.accessToken=t.golbal.accessToken,i.next=17,p()({method:"post",url:d.golbal.GET_DATA,data:"data="+escape(l()(m)),header:{"Content-Type":"application/jsonp"}});case 17:if("SUCCESS"!=(h=i.sent).data.status){i.next=24;break}return v="http://app.lk-control.com/txt2qrcode?txt="+escape(t.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+h.data.projectId),null!=e&&d.$message({message:"分享成功",type:"success",duration:1e3}),i.abrupt("return",v);case 24:return t.$message({type:"error",message:h.data.errorMessage,duration:1e3}),i.abrupt("return","");case 26:case 27:case"end":return i.stop()}},i,t)}))()},sendPojectToUser:function(){var e=this;return d()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.upload(e.toUser);case 2:e.showDialogToUser=!1;case 3:case"end":return t.stop()}},t,e)}))()},getFloorById:function(e,t){if(null!=e&&null!=e.blocks[0].floors&&e.blocks[0].floors.length>0)for(var i=this.createFloorById(t),a=0;a<e.blocks[0].floors.length;a++){var o=e.blocks[0].floors[a];if(null!=i&&i.id==o.id)return o}return null},createFloorById:function(e){if(null!=this.editProject){for(var t=0;t<this.editProject.blocks[0].floors.length;t++){var i=this.editProject.blocks[0].floors[t];if(i.id==e)return{id:i.id,name:i.name,active:!1,isOn:!1,rooms:[]};for(var a=0;a<i.rooms.length;a++){var o=i.rooms[a];if(o.id==e)return{id:i.id,name:i.name,active:!1,isOn:!1,rooms:[]};for(var s=0;s<o.devices.length;s++){if(o.devices[s].id==e)return{id:i.id,name:i.name,active:!1,isOn:!1,rooms:[]}}}}return null}},getRoomById:function(e,t){if(null!=e&&null!=e.blocks[0].floors&&e.blocks[0].floors.length>0)for(var i=this.createRoomById(t),a=0;a<e.blocks[0].floors.length;a++){var o=e.blocks[0].floors[a];if(o.rooms.length>0)for(var s=0;s<o.rooms.length;s++){var n=o.rooms[s];if(null!=i&&i.id==n.id)return n}}return null},createRoomById:function(e){if(null!=this.editProject){for(var t=0;t<this.editProject.blocks[0].floors.length;t++)for(var i=this.editProject.blocks[0].floors[t],a=0;a<i.rooms.length;a++){var o=i.rooms[a];if(o.id==e)return{id:o.id,name:o.name,busId:o.busId,active:!1,isOn:!1,devices:o.devices};for(var s=0;s<o.devices.length;s++){if(o.devices[s].id==e)return{id:o.id,name:o.name,busId:o.busId,active:!1,isOn:!1,devices:[]}}}return null}},closeClick:function(){this.showDialog=!1,this.$router.back(-1)}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK",this.initDataShared()},watch:{filterText:function(e){this.$refs.tree.filter(e)}}},Vi={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"divFormList divFormAndList",staticStyle:{height:"calc(100% - 30px)"}},[i("el-form",{ref:"formFloor",attrs:{"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("div",{staticStyle:{"font-size":"18px",color:"#606266"}},[e._v("选择分享的内容")]),e._v(" "),i("el-form-item",{staticStyle:{"font-size":"18px"},attrs:{label:"",prop:"name"}},[i("div",{staticStyle:{height:"64vh",overflow:"scroll"}},[i("el-tree",{ref:"tree",attrs:{data:e.dataShared,"default-expanded-keys":e.defaultExpend,"show-checkbox":"","node-key":"id",props:e.defaultProps}})],1)]),e._v(" "),i("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:function(t){return e.createSharedProject()}}},[e._v("产生二维码")]),e._v(" "),i("el-button",{staticStyle:{width:"100%","margin-top":"10px","margin-left":"0px"},attrs:{type:"primary"},on:{click:function(t){return e.createSharedProjectToUser()}}},[e._v("分享给指定用户")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"分享",visible:e.showDialog,width:"90%",modal:!0,"append-to-body":!0},on:{"update:visible":function(t){e.showDialog=t}}},[i("div",{staticClass:"divFormAddDevice"},[i("el-form",{attrs:{"label-width":"100%","label-position":"top","inline-message":!0,size:"mini"}},[i("el-form-item",{staticStyle:{"text-align":"center"},attrs:{label:"扫二维码获取分享项目",prop:"panel_name"}},[i("img",{attrs:{src:e.qrcode}})])],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",staticStyle:{height:"20px"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:e.closeClick}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"分享到指定用户",visible:e.showDialogToUser,width:"90%",modal:!0,"append-to-body":!0},on:{"update:visible":function(t){e.showDialogToUser=t}}},[i("el-form",[i("el-form-item",{attrs:{label:"用户名","label-width":"74px"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.toUser,callback:function(t){e.toUser=t},expression:"toUser"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},on:{click:function(t){e.showDialogToUser=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sendPojectToUser()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]},Mi=i("VU/8")(Ni,Vi,!1,null,null,null).exports,Bi={components:{},data:function(){return{showSharedQRCode:!1}},props:["golbal"],methods:{projectCancelShareClick:function(e){var t=this;this.$confirm("确认取消对"+e.nickname+"的分享？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"divUserConfirm"}).then(function(){t.projectCancelShare(e)}).catch(function(){})},projectCancelShare:function(e){var t=this;return d()(r.a.mark(function i(){var a;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a={}).action="APP_DELETE_PROJECT_SHARE",a.uuid=t.golbal.myUuid,a.projectId=e.projectId,a.userId=e.userId,i.next=7,p()({method:"post",url:t.golbal.GET_DATA,data:"data="+escape(l()(a)),header:{"Content-Type":"application/jsonp"}});case 7:"SUCCESS"==i.sent.data.status&&b.a.loadProjectShare();case 9:case"end":return i.stop()}},i,t)}))()},sharedClick:function(){this.$router.push({path:"/projectShared"})}},mounted:function(){this.golbal.showCaseTopLeft="BACK",b.a.loadProjectShare()}},Ui={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main drawerShareList",staticStyle:{"margin-top":"84px",height:"calc(100% - 197px)","border-top":"1px solid #f08519"}},[i("ul",[e._m(0),e._v(" "),e._l(e.golbal.projectShare,function(t){return i("li",{key:t.username},[i("div",{staticClass:"divGateway1"},[e._v(e._s(t.username))]),e._v(" "),i("div",{staticClass:"divGateway2"},[e._v(e._s(t.nickname))]),e._v(" "),i("div",{staticClass:"divGateway3"},[i("i",{staticClass:"icon-delete2",on:{click:function(i){return e.projectCancelShareClick(t)}}})])])})],2)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("div",{staticClass:"divGateway1"},[this._v("用户名")]),this._v(" "),t("div",{staticClass:"divGateway2"},[this._v("昵称")]),this._v(" "),t("div",{staticClass:"divGateway3"},[this._v("删除")])])}]};var $i=i("VU/8")(Bi,Ui,!1,function(e){i("SQYN")},"data-v-72e74238",null).exports,Yi={data:function(){return{heightCameraRC:.58*window.innerWidth,heightCameraRCButton:.58*window.innerWidth*.25}},props:["golbal"],methods:{ptzUp:function(){this._cur_dirt=this.PTZ_DIRT.UP,this.ptzStart(this.PTZ_DIRT.UP),console.log("up")},ptzDown:function(){this._cur_dirt=this.PTZ_DIRT.DOWN,this.ptzStart(this.PTZ_DIRT.DOWN),console.log("down")},ptzLeft:function(){this._cur_dirt=this.PTZ_DIRT.LEFT,this.ptzStart(this.PTZ_DIRT.LEFT),console.log("left")},ptzRight:function(){this._cur_dirt=this.PTZ_DIRT.RIGHT,this.ptzStart(this.PTZ_DIRT.RIGHT),console.log("right")},ptzStop:function(){var e={action:"APP_PTZ_STOP"};e.dirt=this._cur_dirt,e.deviceSerial=this.device.deviceSerial,axios({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(e)),header:{"Content-Type":"application/jsonp"}}).then(function(e){console.log(e.data)}).catch(function(e){console.log(e)}),console.log("stop")},ptzStart:function(e){var t={action:"APP_PTZ_START"};t.dirt=e,t.deviceSerial=this.device.deviceSerial,axios({method:"post",url:this.golbal.GET_DATA,data:"data="+escape(l()(t)),header:{"Content-Type":"application/jsonp"}}).then(function(e){console.log(e.data)}).catch(function(e){console.log(e)})},dialogCameraClose:function(){}},mounted:function(){this.golbal.showCaseTopRight="",this.golbal.showCaseTopLeft="BACK";var e="http://cdn2-unrealengine-1251447533.file.myqcloud.com/homepage-opener-5a55a50aaa4c.mp4",t=this.$route.params.device;this.golbal.isCustomTitle=!0,this.golbal.customTitle=t.name,"HAI_KANG"==t.brand?e="https://bj.bcebos.com/bce-cdn/2023-6/1687254884661/%E5%BE%AA%E7%8E%AF_batch.mp4":"DA_HUA"==t.brand&&(e="http://cdn2-unrealengine-1251447533.file.myqcloud.com/homepage-opener-5a55a50aaa4c.mp4"),console.log(e),"undefined"!=typeof cordova&&window.VideoPlayerVLC.play(e,function(e){},function(e){})}},Fi={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"content"},[i("div",{staticClass:"divDialogCamera"},[i("div",{staticClass:"divDeviceCameraTools"},[i("div",{staticClass:"divDeviceCameraRC",style:"height:"+e.heightCameraRC+"px",on:{touchend:e.ptzStop}},[i("div",{staticClass:"divDeviceCameraRCCenter",style:"height:"+.5*e.heightCameraRC+"px"}),e._v(" "),i("div",{staticClass:"btnDeviceCameraRC",style:"width:"+e.heightCameraRCButton+"px;height:"+e.heightCameraRCButton+"px;line-height:"+e.heightCameraRCButton+"px;left:"+(.5*e.heightCameraRC-.5*e.heightCameraRCButton)+"px;top:0px;",on:{touchstart:e.ptzUp}},[i("i",{staticClass:"el-icon-caret-top"})]),e._v(" "),i("div",{staticClass:"btnDeviceCameraRC",style:"width:"+e.heightCameraRCButton+"px;height:"+e.heightCameraRCButton+"px;line-height:"+e.heightCameraRCButton+"px;right:0px;top:"+(.5*e.heightCameraRC-.5*e.heightCameraRCButton)+"px;",on:{touchstart:e.ptzRight}},[i("i",{staticClass:"el-icon-caret-right"})]),e._v(" "),i("div",{staticClass:"btnDeviceCameraRC",style:"width:"+e.heightCameraRCButton+"px;height:"+e.heightCameraRCButton+"px;line-height:"+e.heightCameraRCButton+"px;left:"+(.5*e.heightCameraRC-.5*e.heightCameraRCButton)+"px;bottom:0px;",on:{touchstart:e.ptzDown}},[i("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),i("div",{staticClass:"btnDeviceCameraRC",style:"width:"+e.heightCameraRCButton+"px;height:"+e.heightCameraRCButton+"px;line-height:"+e.heightCameraRCButton+"px;left:0px;top:"+(.5*e.heightCameraRC-.5*e.heightCameraRCButton)+"px;",on:{touchstart:e.ptzLeft}},[i("i",{staticClass:"el-icon-caret-left"})])])])])])])},staticRenderFns:[]};var Hi=i("VU/8")(Yi,Fi,!1,function(e){i("2w0j")},"data-v-3ca1a81e",null).exports;a.default.use(P.a);var Gi=new P.a({routes:[{path:"/",name:"default",component:ut,meta:{index:10}},{path:"/login1",name:"login1",component:jt,meta:{index:10}},{path:"/login",name:"login",component:jt,meta:{index:10}},{path:"/favorite",name:"favorite",component:lt,meta:{index:10}},{path:"/room",name:"room",component:ht,meta:{index:20}},{path:"/user",name:"user",component:bt,meta:{index:30}},{path:"/secure",name:"secure",component:yt,meta:{index:40}},{path:"/about",name:"about",component:Et,meta:{index:10}},{path:"/message",name:"message",component:St,meta:{index:10}},{path:"/login",name:"login",component:jt,meta:{index:10}},{path:"/device",name:"device",component:Jt,meta:{index:40}},{path:"/addDevice",name:"addDevice",component:si,meta:{index:50}},{path:"/project",name:"project",component:Xt,meta:{index:40}},{path:"/logic",name:"logic",component:ii,meta:{index:40}},{path:"/projectEdit",name:"projectEdit",component:ci,meta:{index:50}},{path:"/projectShared",name:"projectShared",component:Mi,meta:{index:50}},{path:"/sharedList",name:"sharedList",component:$i,meta:{index:50}},{path:"/floorEdit",name:"floorEdit",component:di,meta:{index:60}},{path:"/roomEdit",name:"roomEdit",component:vi,meta:{index:70}},{path:"/sceneEdit",name:"sceneEdit",component:yi,meta:{index:60,isCustomTitle:!0}},{path:"/busEdit",name:"busEdit",component:Ei,meta:{index:50}},{path:"/selectDevice",name:"selectDevice",component:Ri,meta:{index:80}},{path:"/actionEdit",name:"actionEdit",component:Si,meta:{index:70}},{path:"/conditionEdit",name:"conditionEdit",component:ji,meta:{index:70}},{path:"/editValue",name:"editValue",component:Li,meta:{index:80,isCustomTitle:!0}},{path:"/camera",name:"camera",component:Hi,meta:{index:80,isCustomTitle:!0}}]}),Wi={createSocket:function(e,t,i,a){b.a.log("create socket address:"+e+",port:"+t),null!=chrome&&null!=chrome.sockets&&null!=chrome.sockets.udp&&chrome.sockets.udp.create(function(o){console.log("listener:"+i),chrome.sockets.udp.onReceive.addListener(i),chrome.sockets.udp.bind(o.socketId,e,t,function(){chrome.sockets.udp.setBroadcast(o.socketId,!0,function(){console.log("setBroadcast success")}),null!=a&&a(o,chrome.sockets.udp)})})},Buffer:{fromString:function(e){for(var t=new ArrayBuffer(2*e.length),i=new Uint16Array(t),a=0,o=e.length;a<o;a++)i[a]=e.charCodeAt(a);return t},fromHexString:function(e){for(var t=b.a.hexStringToBytes(e),i=new ArrayBuffer(t.length),a=new Uint8Array(i),o=0;o<t.length;o++)a[o]=t[o];return i},fromBytes:function(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),a=0;a<e.length;a++)i[a]=e[a];return t},stringify:function(e){var t=new Uint16Array(e);return String.fromCharCode.apply(null,t)}}};window.UDP=Wi;var Ki=null,zi=function(e,t,i){Ki=i,this.address=e,this.port=t||0,this.udp=null,this.socket=null;var a=this;null!=networkinterface?networkinterface.getWiFiIPAddress(function(e){b.a.log("IP: "+e.ip+" subnet:"+e.subnet),UDP.createSocket(e.ip,10946,i,function(e,t){a.udp=t,a.socket=e,b.a.log("connected")})},function(e){console.log(e)}):UDP.createSocket("192.168.0.119",10996,i,function(e,t){a.udp=t,a.socket=e,b.a.log("connected")})};zi.prototype.onReceive=function(e){console.log("ready to onReceive"),console.log("call back "+e),chrome.sockets.udp.onReceive.addListener(e)},zi.prototype.send=function(e,t,i,a){var o=UDP.Buffer.fromBytes(e);null!=this.udp&&null!=this.socket?this.udp.send(this.socket.socketId,o,null==a?this.address:a,this.port,function(e){t(e)}):null!=i&&i()},zi.prototype.debugReceive=function(e){null!=Ki&&Ki(e)},window.UDP.Client=zi,Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},a.default.use(s.a),new a.default({el:"#app",router:Gi,components:{App:O},template:"<App/>"})},NVJ6:function(e,t,i){"use strict";t.a={HEAD:[170,170],FUNCTION_CODE:{READ:0,WRITE:64,FEEDBACK:128,STATUS_BACK:192,QUERY_STATUS:1,CONTROL:2},DEVICE_TYPE_ENUM:{DEVICE_TYPE_MAIN_ALL:0,DEVICE_TYPE_MAIN:257,DEVICE_TYPE_GATEWAY:258,DEVICE_TYPE_BUS_SCREEN:259,DEVICE_TYPE_LOGIC:260,DEVICE_TYPE_AI_GENIC:261,DEVICE_TYPE_BUS:261,DEVICE_TYPE_REMOTE:513,DEVICE_TYPE_LIGHT:769,DEVICE_TYPE_DIMMER:770,DEVICE_TYPE_CURTAIN:771,DEVICE_TYPE_SCENE:772,DEVICE_TYPE_LIGHT_SCENE:773,DEVICE_TYPE_DIMMER_SCENE:774,DEVICE_TYPE_CURTAIN_SCENE:775,DEVICE_TYPE_LIGHT_DIMMER_SCENE:776,DEVICE_TYPE_LIGHT_CURTAIN_SCENE:777,DEVICE_TYPE_DIMMER_CURTAIN_SCENE:778,DEVICE_TYPE_TEMPERATURE_COMBO:1025,DEVICE_TYPE_TEMPERATURE_AC:1026,DEVICE_TYPE_TEMPERATURE_HEAT:1027,DEVICE_TYPE_TEMPERATURE_AIR:1028,DEVICE_TYPE_MODULE_LIGHT:1281,DEVICE_TYPE_MODULE_DIMMER:1282,DEVICE_TYPE_NL_LOCK:2305,DEVICE_TYPE_SENSOR_PANEL:1029,DEVICE_TYPE_SENSOR_PULES:1030,DEVICE_TYPE_SENSOR_SWITCH:1031,DEVICE_TYPE_SENSOR_TEMPERATURE:1032,DEVICE_TYPE_SENSOR_HUMIDITY:1033,DEVICE_TYPE_SENSOR_BRIGHTNESS:1034,DEVICE_TYPE_SENSOR_PM25:1035,DEVICE_TYPE_SENSOR_HCHO:1036,DEVICE_TYPE_SENSOR_CO2:1037,DEVICE_TYPE_SENSOR_CH4:1038},REMOTE_KEY_LOCATION:{TV:["vol_m","ch_p","ch_p","menu","ch_m","vol_p","power","slient","key1","key2","key3","key4","key5","key6","key7","key8","key9","keyC","key0","AVTV","back","submit","up","left","right","down","main"],TV_BOX:["power","slient","vol_p","vol_m","ch_p","ch_m","up","left","ok","right","down","playpaused","key1","key2","key3","key4","key5","key6","key7","key8","key9","key0","back"]},ARRAY_KEY_VALUE:[{value:1,channel:1,type:"light",func:"L",index:0},{value:2,channel:2,type:"light",func:"L",index:0},{value:3,channel:3,type:"light",func:"L",index:0},{value:4,channel:4,type:"light",func:"L",index:0},{value:5,channel:5,type:"light",func:"L",index:0},{value:6,channel:6,type:"light",func:"L",index:0},{value:7,channel:7,type:"light",func:"L",index:0},{value:8,channel:8,type:"light",func:"L",index:0},{value:9,channel:1,type:"dimmer",func:"U",index:0},{value:10,channel:1,type:"dimmer",func:"P",index:1},{value:11,channel:1,type:"dimmer",func:"D",index:2},{value:12,channel:2,type:"dimmer",func:"U",index:0},{value:13,channel:2,type:"dimmer",func:"P",index:1},{value:14,channel:2,type:"dimmer",func:"D",index:2},{value:15,channel:1,type:"curtain",func:"O",index:0},{value:16,channel:1,type:"curtain",func:"S",index:1},{value:17,channel:1,type:"curtain",func:"C",index:2},{value:18,channel:2,type:"curtain",func:"O",index:0},{value:19,channel:2,type:"curtain",func:"S",index:1},{value:20,channel:2,type:"curtain",func:"C",index:2},{value:15,channel:1,type:"process_curtain",func:"O",index:0},{value:16,channel:1,type:"process_curtain",func:"S",index:1},{value:17,channel:1,type:"process_curtain",func:"C",index:2},{value:18,channel:2,type:"process_curtain",func:"O",index:0},{value:19,channel:2,type:"process_curtain",func:"S",index:1},{value:20,channel:2,type:"process_curtain",func:"C",index:2},{value:21,channel:1,type:"scene",func:"SE",index:0},{value:22,channel:2,type:"scene",func:"SE",index:0},{value:23,channel:3,type:"scene",func:"SE",index:0},{value:24,channel:4,type:"scene",func:"SE",index:0},{value:25,channel:5,type:"scene",func:"SE",index:0},{value:26,channel:6,type:"scene",func:"SE",index:0},{value:27,channel:7,type:"scene",func:"SE",index:0},{value:28,channel:8,type:"scene",func:"SE",index:0}],channelDefineByKeyValue:function(e){for(var t=0;t<this.ARRAY_KEY_VALUE.length;t++){var i=this.ARRAY_KEY_VALUE[t];if(i.value==e)return i}return null},keyValueByChannelDefine:function(e){if(null!=e.locals&&e.locals.length>0){for(var t=[],i=0;i<e.locals.length;i++)for(var a=e.locals[i],o=0;o<this.ARRAY_KEY_VALUE.length;o++){var s=this.ARRAY_KEY_VALUE[o];"light"==e.deviceType||"scene"==e.deviceType?s.type==e.deviceType&&s.channel==e.channel&&t.push(s):s.type==e.deviceType&&s.channel==e.channel&&a.type==s.func&&t.push(s)}return t}return[]},DEVICE_ACTION_DEFINE:{light:{name:"灯控",actions:[{name:"开关",key:"power",type:"boolean"}],conditionCode:4},module_light:{name:"照明模块",actions:[{name:"开关",key:"power",type:"boolean"}],conditionCode:4},module_dimmer:{name:"调光模块",actions:[{name:"亮度",key:"brightness",type:"int",range:[0,100]}],conditionCode:4},dimmer:{name:"调光",actions:[{name:"亮度",key:"brightness",type:"int",range:[0,100]}],conditionCode:4},curtain:{name:"窗帘",actions:[{name:"开关停",key:"action",type:"enum",enum:[{key:"open",name:"开",value:100},{key:"stop",name:"停",value:101},{key:"close",name:"关",value:0}]}],conditionCode:4},process_curtain:{name:"行程窗帘",actions:[{name:"行程",key:"process",type:"int",range:[0,100]}],conditionCode:4},scene:{name:"场景",actions:[{name:"开关",key:"switch",type:"boolean"}],conditionCode:4},ac:{name:"空调",actions:[{name:"开关",key:"ac",type:"ac"}],conditionCode:4},heating:{name:"地暖",actions:[{name:"开关",key:"heat",type:"heat"}],conditionCode:4},fan:{name:"新风",actions:[{name:"开关",key:"air",type:"air"}],conditionCode:4},combo:{name:"三合一温控",actions:[{name:"开关",key:"combo",type:"combo"}],conditionCode:4},nl_lock:{name:"智能锁",actions:[{name:"开关",key:"power",type:"boolean"}],conditionCode:4},sensor_temperature:{name:"温度传感器",actions:[{name:"温度",key:"temperature",type:"logic",range:[16,30]}],conditionCode:5},sensor_humidity:{name:"湿度传感器",actions:[{name:"湿度",key:"humidity",type:"logic",range:[0,100]}],conditionCode:6},sensor_brightness:{name:"亮度传感器",actions:[{name:"亮度",key:"brightness",type:"logic",range:[0,100]}],conditionCode:7},sensor_pm25:{name:"PM2.5传感器",actions:[{name:"PM2.5",key:"pm25",type:"logic",range:[0,100]}],conditionCode:8},sensor_hcho:{name:"甲醛浓度传感器",actions:[{name:"甲醛浓度",key:"hcho",type:"logic",range:[0,100]}],conditionCode:9},sensor_co2:{name:"二氧化碳浓度传感器",actions:[{name:"二氧化碳浓度",key:"co2",type:"logic",range:[0,100]}],conditionCode:10},sensor_pules:{name:"脉冲量传感器",actions:[{name:"3",key:"single",type:"int",range:[0,65535]}],conditionCode:3},sensor_switch:{name:"开关量传感器",actions:[{name:"3",key:"switch",type:"boolean",labelOn:"ON",labelOff:"OFF"}],conditionCode:4},sensor_ch4:{name:"燃气传感器",actions:[{name:"燃气",key:"ch4",type:"logic",range:[0,100]}],conditionCode:10},remoteMusic:{name:"影音遥控",actions:[{name:"遥控",key:"remoteMusic",type:"remoteMusic"}],conditionCode:10},remoteTV:{name:"电视遥控",actions:[{name:"遥控",key:"remoteTV",type:"remoteTV"}],conditionCode:10},remoteAC:{name:"空调遥控",actions:[{name:"遥控",key:"remoteAC",type:"remoteAC"}],conditionCode:10},remoteCustom:{name:"自定义遥控",actions:[{name:"遥控",key:"remoteCustom",type:"remoteCustom"}],conditionCode:10}},JSON_TYPE:{light:["light","dimmer","module_light","module_dimmer"],curtain:["curtain","process_curtain"],ac:["ac","heat","air","combo"],scene:["scene"],video:["camera","video"],lock:["nl_lock"],remote:["remote"],sensor:["sensor_temperature","sensor_switch","sensor_pules","sensor_humidity","sensor_brightness","sensor_pm25","sensor_hcho","sensor_co2","sensor_ch4"]},OPTIONS_REMOTE_MAP:{key_on:"开",key_off:"关",power:"电源",switch:"开关",silen:"静音",vol_up:"音量+",vol_down:"音量-",vol_p:"温度+",vol_m:"温度-",channel_up:"频道+",channel_down:"频道-",key_1:"按键1",key_2:"按键2",key_3:"按键3",key_4:"按键4",key_5:"按键5",key_6:"按键6",key_7:"按键7",key_8:"按键8",key_9:"按键9",key_0:"按键0",key_fav:"收藏",key_back:"后退",key_menu:"菜单",key_home:"主页",key_up:"上",key_down:"下",key_left:"左",key_right:"右",key_ok:"确定",key_return:"返回",key_exit:"退出",play:"播放",pause:"暂停",sun:"制暖",snow:"制冷",fan:"送风",keep:"恒温",dry:"除湿",scan:"扫风",highWind:"高速",middleWind:"中速",lowWind:"低速",more:"更多",eject:"弹出",hdmi:"HDMI",aux:"AUX",usb:"USB",bluetooth:"蓝牙",playstop:"播放/暂停",previous:"上一曲",next:"下一曲",loopone:"单曲循环",loop:"循环",random:"随机播放"}}},NyJZ:function(e,t){},SQYN:function(e,t){},VQRa:function(e,t){},Vf35:function(e,t){},XF4N:function(e,t,i){"use strict";(function(e){t.e=x,t.d=L,t.j=function(e,t,i,a){for(var o=R.length-1;o>=0;o--){var s=R[o];if(F(e,s.data))return}null!=a&&a?R.unshift({data:e,_socket:t,bus:i}):R.push({data:e,_socket:t,bus:i})},t.g=function(){return R.length},t.a=function(){return R=[]},t.i=function(){for(var e=0;e<h.length;e++){var t=h[e];t.close()}f=!0,b=!0},t.f=function(){return I},t.b=function(){null!=d&&(d.close(),d=null);for(var e=h.length-1;e>=0;e--)3===h[e].readyState||2===h[e].readyState?(h[e].onopen=null,h[e].onmessage=null,h[e].onerror=null,h[e].onclose=null,h.splice(e,1)):(h[e].close(),h.splice(e,1))},t.c=function(e){if(null!=h&&h.length>0)for(var t=0;t<h.length;t++)if(h[t].url==e||h[t].url==e+"/"){if(3===h[t].readyState||2===h[t].readyState){h[t].onopen=null,h[t].onmessage=null,h[t].onerror=null,h[t].onclose=null,h.splice(t,1);break}h[t].close()}null!=_[e]&&(_[e]=!1,_[e]=null)},t.h=function(e){if(h.length>0)for(var t=0;t<h.length;t++)if((h[t].url==e||h[t].url==e+"/")&&h[t].readyState==u.OPEN)return!0;return!1};var a=i("mvHQ"),o=i.n(a),s=i("uxah"),n=i("gQoh"),l=i("mtWM"),c=(i.n(l),"ws://192.168.0.119:6432"),r="wss://app.lk-control.com/wss/",u={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},d=null,m=null,h=[],v=0,p=!1,g=null,f=!1,b=!1,_={},y=!1,C=0,k=50,E=1,T=2,D=k,S=!1,w=10,I=0,j=[],O=null,P=null,R=[];function x(t,i,a,o,s){if(L(),"ws://:6432/"!=i){if(null!=_[i]&&_[i]&&null==a)return null;if(h.length>0)for(var n=0;n<h.length;n++)if(h[n].url==i||h[n].url==i+"/"){if(3===h[n].readyState||2===h[n].readyState){h[n].onopen=null,h[n].onmessage=null,h[n].onerror=null,h[n].onclose=null,h.splice(n,1);break}if(null!=a){var l={currentTarget:{url:h[n].url}};setTimeout(a,500,l)}return null!=t&&(P=null!=s&&s?t:null),h[n]}var r=null;return(r=i.indexOf("192.168.0.128:6432")>-1?new WebSocket(i,"echo-protocol"):new WebSocket(null==i?c:i)).onopen=null==a?N:a,r.onmessage=$,r.onerror=null==o?B:o,r.onclose=G,null==a&&(_[i]=!0),h.push(r),null!=s&&s||(O=t),window.removeEventListener("onmessageWS",A),window.addEventListener("onmessageWS",A),p||(window.addEventListener("onmessageWSRemote",function(i){var a=e.from(i.detail.data.data,"base64");null!=t&&t(a,i.detail.data.origin)},!1),p=!0),r}}function A(e){var t=e.detail.data.data,i=new FileReader;i.onload=function(){var t=new Uint8Array(this.result);null!=O&&O(t,e.detail.data.origin),null!=P&&P(t,e.detail.data.origin)},i.readAsArrayBuffer(t),!0,null!=g&&clearTimeout(g),g=setTimeout(function(){!1},3e3)}function L(){console.log("准备创建远程连接："+y),y||0!=(I&T)||null==d&&(console.log("创建远程连接"+r),(d=new WebSocket(r,"echo-protocol")).onopen=V,d.onmessage=Y,d.onerror=U,d.onclose=W,y=!0,p||(window.addEventListener("onmessageWSRemote",function(t){var i=e.from(t.detail.data.data,"base64");s.a.receiveData(i,t.detail.data.origin)},!1),p=!0))}function N(e){v=0,n.a.log("本地连接成功："+e.currentTarget.url),_[e.currentTarget.url]=!1,!0,I|=E;for(var t=n.a.golbal.myProject.buses,i=0;i<t.length;i++)t[i].ws_url==e.currentTarget.url&&(t.isOnline=!0);for(i=0;i<h.length;i++)h[i],m=setInterval(function(){},3e4)}function V(t){console.log(n.a.MyProject.buses),n.a.log("远程连接成功"),y=!1,I|=T;var i={action:"app_ws_login",accessToken:null!=n.a.golbal?n.a.golbal.accessToken:"",buses:[]};if(null!=n.a.MyProject.buses)for(var a=0;a<n.a.MyProject.buses.length;a++){var s=n.a.MyProject.buses[a],l=null!=s.addr?e.from(s.addr,"hex").toString("base64"):"";i.buses.push(l),l+","}d.send(o()(i)),setTimeout(M,5e3)}function M(){try{if(null!=d){var t={action:"app_ws_heart",accessToken:null!=n.a.golbal?n.a.golbal.accessToken:"111222333",userId:null!=n.a.golbal?n.a.golbal.userId:"0",buses:[]};if(null!=n.a.MyProject.buses)for(var i=0;i<n.a.MyProject.buses.length;i++){var a=n.a.MyProject.buses[i],s=null!=a.addr?e.from(a.addr,"hex").toString("base64"):"";t.buses.push(s),s+","}d.send(o()(t)),setTimeout(M,3e4)}}catch(e){}}function B(e){if(H(e.currentTarget.url)){_[e.currentTarget.url]=!1,!1,clearInterval(m),h.indexOf(e.target)>=0&&h.splice(h.indexOf(e.target),1),v>=10&&(n.a.log("重连超出10次，重连结束"),v=0);for(var t=!1,i=e.target.url,a=n.a.golbal.myProject.buses,o=0;o<a.length;o++){if(a[o].source_url==e.currentTarget.url||a[o].ws_url==e.currentTarget.url)t=!0;a[o].source_url==e.currentTarget.url&&a[o].ws_url!=e.currentTarget.url&&(i=a[o].ws_url)}console.log("need reconnect:"+t),t&&setTimeout(function(){H(i)&&x(s.a.receiveData,i)},5e3)}}function U(e){console.log("远程连接失败"),console.log(e),d=null,I&=E,setTimeout(function(){L()},5e3)}function $(e){S=!1,D=k,window.dispatchEvent(new CustomEvent("onmessageWS",{detail:{data:e}}))}function Y(e){window.dispatchEvent(new CustomEvent("onmessageWSRemote",{detail:{data:e}}))}function F(e,t){if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}function H(e){if(null!=n.a.golbal.myProject&&null!=n.a.golbal.myProject.buses&&n.a.golbal.myProject.buses.length>0)for(var t=0;t<n.a.golbal.myProject.buses.length;t++){if(n.a.golbal.myProject.buses[t].ws_url==e)return!0}return!1}function G(e){if(H(e.currentTarget.url)){_[e.currentTarget.url]=!1,I&=T;var t=5e3;f&&(t=100),f=!1,!1,clearInterval(m),n.a.log("本地连接已断开,类型："+e.type+","+t+"毫秒后重连")}}function W(e){console.log("远程连接断开"),console.log(e),d=null,I&=E;var t=2e3;b&&(t=100),b=!1,n.a.log("远程连接已断开,信息："+e.code+" "+e.reason+" "+e.wasClean+","+t+"毫秒后重连"),y=!1,setTimeout(function(){L()},t)}setInterval(function(){++K>=3&&(K=0,function(){S&&C<w?C+=1:C>=w&&(S=!1,C=0,I&=T);D>0&&D--;if(j.length>0){var e=j[0];d.send(o()(e)),j.splice(0,1)}}());if(R.length>0){var t=R.splice(0,1)[0];!function(t,i,a){var l=!1;if(null==i&&(l=!0),0==(I&E)&&(l=!0),l||(null!==i&&3===i.readyState?(i.close(),i=x(s.a.receiveData,i.url),l=!0):1===i.readyState?(console.log("==> "+n.a.bytes2hex(t)+",本地发送"),i.send(t),!S&&D<=0&&(S=!0,C=0)):0===i.readyState&&(setTimeout(function(){i.send(t)},3e3),l=!0)),console.log("needremote:"+l),console.log("Socket4Remote:"+d),l){if(null!=d){var c={action:"message",accessToken:null!=n.a.golbal?n.a.golbal.accessToken:"111222333",bus:e.from(a.addr,"hex").toString("base64"),data:e.from(t).toString("base64")};console.log("==> "+n.a.bytes2hex(t)+",远程发送"),d.send(o()(c))}}else setTimeout(function(){if(0==(I&E)&&null!=d){var i={action:"message",accessToken:null!=n.a.golbal?n.a.golbal.accessToken:"111222333",bus:e.from(a.addr,"hex").toString("base64"),data:e.from(t).toString("base64")};j.push(i)}},1e3)}(t.data,t._socket,t.bus)}},350);var K=0}).call(t,i("EuP9").Buffer)},"YVL/":function(e,t){},aqBC:function(e,t){},dKju:function(e,t){},g3Gj:function(e,t){},gQoh:function(e,t,i){"use strict";(function(e){var a,o,s=i("Xxa5"),n=i.n(s),l=i("exGp"),c=i.n(l),r=i("//Fk"),u=i.n(r),d=i("bOdI"),m=i.n(d),h=i("mvHQ"),v=i.n(h),p=i("22e4"),g=i("mtWM"),f=i.n(g),b=i("XF4N"),_=i("uxah"),y=i("NVJ6");o=c()(n.a.mark(function e(){var t,i,a,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t="",i=0;case 2:if(!(i<E.num)){e.next=11;break}return a=E.upFileName.replace(".json","")+i,e.next=6,T(a);case 6:o=e.sent,t+=o;case 8:i++,e.next=2;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}},e,this)}));function C(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function k(t){for(var i="",a=0;a<t.length;a++)i=i+e.from([t[a]]).toString("hex")+"";return i}t.a=(a={Router:null,devicesAll:null,MyProject:null,golbal:null,root:null,isRequeatStatus500:!1,BusReturn:null,bytes2hex:function(t){for(var i="",a=0;a<t.length;a++)i=i+e.from([t[a]]).toString("hex")+" ";return i},scanBusByWebSocket:function(e){var t=this;if(this.golbal.editing.scanningBus=!0,null!=networkinterface)networkinterface.getWiFiIPAddress(function(i){console.log("IP: "+i.ip+" subnet:"+i.subnet);var a=i.ip.split(".");4==a.length&&t.connectWSBoardCast(a,e)},function(e){console.log(e)});else{console.log("IP: 192.168.1.119 subnet:debug");t.connectWSBoardCast([192,168,1,119],e)}},connectWSBoardCast:function(e,t){for(var i=100;i<=254;i++){var a=e[0]+"."+e[1]+"."+e[2]+"."+i;setTimeout(this.connectWSScan,100*(i-100),a,this,t)}for(i=2;i<100;i++){a=e[0]+"."+e[1]+"."+e[2]+"."+i;setTimeout(this.connectWSScan,100*(i+154),a,this,t)}},connectWSScan:function(e,t,i){var a="ws://"+e+":6432";Object(b.e)(function(a,o){if("wss://app.lk-control.com"!=o){console.log("收到询问12字节地址回复");var s={id:1,ip:o.replace("ws://","").replace("/","").replace(":6432",""),addr:"",addrcode:"01 ff",name:"新建网关",isBind:!1};if(null!=a&&a.length>0&&(192==a[7]||128==a[7])&&13==a[8]){if(a.length>=26)if(0!=(a[21]<<24)+(a[22]<<16)+(a[23]<<8)+a[24])return void console.log("网关"+e+"已存在用户，忽略");for(var n=[],l=0;l<12;l++)n.push(a[l+9]);s.addr=k(n),s.areacode=1,s.areaaddr=255,s.ws_url=o;var c=!0;for(l=0;l<t.golbal.editing.scanBusResult.length;l++){t.golbal.editing.scanBusResult[l].ip==s.ip&&(c=!1)}c&&t.golbal.editing.scanBusResult.push(s)}Object(b.c)(o),null!=i&&i(s)}},a,function(e){console.log("connected"),p.a.sendRequestAddr(e.currentTarget.url)},function(){console.log("连接失败")})},connectWSByUDPBoardCast:function(e,t){var i="ws://"+e+":6432";Object(b.e)(function(e,i){if("wss://app.lk-control.com"!=i){console.log("收到询问12字节地址回复");var a={id:1,ip:i.replace("ws://","").replace("/","").replace(":6432",""),addr:"",addrcode:"01 ff",name:"新建网关"};if(null!=e&&e.length>0&&(192==e[7]||128==e[7])&&13==e[8]){for(var o=[],s=0;s<12;s++)o.push(e[s+9]);a.addr=k(o),a.areacode=1,a.areaaddr=255,a.ws_url=i}Object(b.c)(i),null!=t&&t(a)}},i,function(e){console.log("connected"),p.a.sendRequestAddr(e.currentTarget.url)},function(){console.log("连接失败")},!0)},getVORoomByDeviceId:function(e){var t=this.MyProject;if(null==t)return console.log("project is null"),null;for(var i=0;i<t.blocks.length;i++)for(var a=t.blocks[i],o=0;o<a.floors.length;o++)for(var s=a.floors[o],n=0;n<s.rooms.length;n++)for(var l=s.rooms[n],c=0;c<l.devices.length;c++){var r=l.devices[c];if("ac"==r.type||"heating"==r.type||"fan"==r.type){if(r.id.substring(0,35)==e.substring(0,35))return l}else if(r.id==e)return l}},getVORoomByRoomId:function(e){var t=this.MyProject;if(null==t)return console.log("project is null"),null;for(var i=0;i<t.blocks.length;i++)for(var a=t.blocks[i],o=0;o<a.floors.length;o++)for(var s=a.floors[o],n=0;n<s.rooms.length;n++){var l=s.rooms[n];if(l.id==e)return l}return null},getVODeviceById:function(e){var t=this.MyProject;if(null==t)return console.log("project is null"),null;if(null!=this.devicesAll&&this.devicesAll.length>0)for(var i=0;i<this.devicesAll.length;i++){var a=this.devicesAll[i].device;if(a.id==e)return a}else for(i=0;i<t.blocks.length;i++)for(var o=t.blocks[i],s=0;s<o.floors.length;s++)for(var n=o.floors[s],l=0;l<n.rooms.length;l++)for(var c=n.rooms[l],r=0;r<c.devices.length;r++){var u=c.devices[r];if("ac"==u.type||"heating"==u.type||"fan"==u.type){if(u.id.substring(0,35)==e.substring(0,35))return u}else if(u.id==e)return u}return null},getVODeviceByAddrAndArea:function(e,t){console.log("here");var i=this.MyProject;if(null==i)return console.log("project is null"),null;if(null!=this.devicesAll&&this.devicesAll.length>0)for(var a=0;a<this.devicesAll.length;a++){var o=this.devicesAll[a].device;if(o.addr==e&&o.areacode==t)return o}else for(a=0;a<i.blocks.length;a++)for(var s=i.blocks[a],n=0;n<s.floors.length;n++)for(var l=s.floors[n],c=0;c<l.rooms.length;c++)for(var r=l.rooms[c],u=0;u<r.devices.length;u++){var d=r.devices[u];if(d.addr==e||d.areacode==t)return d}return null},getVOBus:function(e){var t=this.MyProject;if(null==t)return console.log("project is null"),null;var i=null;if(null==t.buses)return null;if(null!=e)for(var a=0;a<t.buses.length;a++)if((i=t.buses[a]).id==e.busId||i.addr==e.busId)return i;return t.buses.length>0?t.buses[0]:null},getVOBusByWSURL:function(e){var t=this.MyProject;if(null==t)return console.log("project is null"),null;for(var i=null,a=0;a<t.buses.length;a++)if((i=t.buses[a]).ws_url==e+"/")return i;return null},getVOBusByRoomId:function(e){var t=this.MyProject;if(null==t)return console.log("project is null"),null;var i=this.getVORoomByRoomId(e);if(null==i)return null;for(var a=null,o=0;o<t.buses.length;o++)if((a=t.buses[o]).id==i.busId)return a;return null},getTypeStatus:function(){if(null!=this.golbal.roomCur&&null!=this.golbal.roomCur.devices){for(var e=1;e<=4;e++)this.golbal.type[e].isOn=!1;for(e=0;e<this.golbal.roomCur.devices.length;e++){var t=this.golbal.roomCur.devices[e];switch(t.type){case"light":t.isOn&&(this.golbal.type[1].isOn=!0);break;case"dimmer":t.value>0&&(this.golbal.type[1].isOn=!0);break;case"module_light":t.isOn&&(this.golbal.type[1].isOn=!0);break;case"module_dimmer":t.value>0&&(this.golbal.type[1].isOn=!0);break;case"curtain":100==t.value&&(this.golbal.type[2].isOn=!0);break;case"process_curtain":t.value>0&&(this.golbal.type[2].isOn=!0);break;case"ac":t.isOn&&(this.golbal.type[3].isOn=!0);break;case"combo":t.ac.isOn&&(this.golbal.type[3].isOn=!0),t.heat.isOn&&(this.golbal.type[3].isOn=!0),t.air.isOn&&(this.golbal.type[3].isOn=!0);break;case"heating":case"fan":t.isOn&&(this.golbal.type[3].isOn=!0);break;case"scene":t.isOn&&(this.golbal.type[4].isOn=!0)}}if(null!=this.golbal.blockCur.floors&&0!=this.golbal.blockCur.floors.length){for(e=0;e<this.golbal.blockCur.floors.length;e++)this.golbal.blockCur.floors[e].isOn=!1;this.golbal.isTypeOn.scene=!1,this.golbal.isTypeOn.light=!1,this.golbal.isTypeOn.curtain=!1,this.golbal.isTypeOn.ac=!1,this.golbal.isTypeOn.module=!1;for(e=0;e<this.golbal.blockCur.floors.length;e++){var i=this.golbal.blockCur.floors[e];if(null!=i.rooms&&i.rooms.length>0)for(var a=0;a<i.rooms.length;a++){var o=i.rooms[a];this.setRoomIsOn(o,i)}}for(e=0;e<this.devicesAll.length;e++){var s=this.devicesAll[e].device;switch(s.type){case"module_dimmer":s.value>0&&(this.golbal.isTypeOn.module=!0);break;case"module_light":s.isOn&&(this.golbal.isTypeOn.module=!0);break;case"process_curtain":s.value>0&&(this.golbal.isTypeOn.curtain=!0);break;case"curtain":100==s.value&&(this.golbal.isTypeOn.curtain=!0);break;case"dimmer":s.value>0&&(this.golbal.isTypeOn.light=!0);break;case"light":s.isOn&&(this.golbal.isTypeOn.light=!0);break;case"scene":s.isOn&&(this.golbal.isTypeOn.scene=!0);break;case"combo":(s.ac.isOn||s.heat.isOn||s.air.isOn)&&(this.golbal.isTypeOn.ac=!0);break;case"heating":case"ac":case"fan":s.isOn&&(this.golbal.isTypeOn.ac=!0)}}}}},setRoomIsOn:function(e,t){if(e.isOn=!1,null!=e.devices&&e.devices.length>0)for(var i=0;i<e.devices.length;i++){var a=e.devices[i];switch(a.type){case"module_dimmer":case"process_curtain":case"dimmer":if(a.value>0)return e.isOn=!0,void(t.isOn=!0);break;case"curtain":if(100==a.value)return e.isOn=!0,void(t.isOn=!0);break;case"combo":if(a.ac.isOn||a.heat.isOn||a.air.isOn)return e.isOn=!0,void(t.isOn=!0);break;default:if(a.isOn)return e.isOn=!0,void(t.isOn=!0)}}},getDeviceTypeHex:function(e,t,i){var a=e,o=[];o.push(a);for(var s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL,n=0;n<this.golbal.roomCur.devices.length;n++){var l=this.golbal.roomCur.devices[n];parseInt(l.areacode)==t&&parseInt(l.addr)==i&&-1==o.indexOf(l.type)&&o.push(l.type)}if(1==o.length)switch(device.type){case"light":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT;break;case"dimmer":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER;break;case"process_curtain":case"curtain":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN;break;case"ac":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AC;break;case"scene":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SCENE;break;case"heating":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_HEAT;break;case"fan":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AIR;break;case"combo":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_COMBO;break;case"module_light":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_LIGHT;break;case"module_dimmer":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_DIMMER;break;case"nl_lock":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_NL_LOCK}else 2==o.length?o.indexOf("scene")>-1&&o.indexOf("light")>-1?s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_SCENE:o.indexOf("scene")>-1&&o.indexOf("dimmer")>-1?s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_SCENE:o.indexOf("scene")>-1&&o.indexOf("curtain")>-1&&(s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN_SCENE):o.length>=3&&(s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE);if(s==y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MAIN_ALL)switch(device.type){case"light":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT;break;case"dimmer":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER;break;case"curtain":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN;break;case"ac":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AC;break;case"scene":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SCENE;break;case"heating":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_HEAT;break;case"fan":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AIR;break;case"combo":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_COMBO;break;case"module_light":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_LIGHT;break;case"module_dimmer":s=y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_DIMMER}return s},getDeviceTypeStr:function(e){var t=[];switch(e){case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT:t.push("light");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_SCENE:t.push("light"),t.push("scene");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE:t.push("light"),t.push("dimmer"),t.push("curtain"),t.push("scene");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_CURTAIN_SCENE:t.push("light"),t.push("curtain"),t.push("process_curtain"),t.push("scene");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER:t.push("dimmer");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_CURTAIN_SCENE:t.push("dimmer"),t.push("curtain"),t.push("process_curtain"),t.push("scene");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_SCENE:t.push("dimmer"),t.push("scene");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN:t.push("curtain"),t.push("process_curtain");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN_SCENE:t.push("curtain"),t.push("process_curtain"),t.push("scene");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AC:t.push("ac");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SCENE:t.push("scene");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_HEAT:t.push("heating");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AIR:t.push("fan");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_COMBO:t.push("combo");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_LIGHT:t.push("module_light");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_DIMMER:t.push("module_dimmer");break;case y.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_NL_LOCK:t.push("nl_lock")}return t},sendQueryDeviceStatus:function(){if(null!=this.golbal.roomCur&&null!=this.golbal.roomCur.devices&&!this.isRequeatStatus500){this.isRequeatStatus500=!0;var e=this;setTimeout(function(){e.isRequeatStatus500=!1},500),Object(b.a)();for(var t=[],i=0;i<this.golbal.roomCur.devices.length;i++){for(var a=!0,o=this.golbal.roomCur.devices[i],s=0;s<t.length;s++)o.type.startsWith("sensor")||parseInt(o.areacode)==t[s].areacode&&parseInt(o.addr)==t[s].addr&&(a=!1);a&&(p.a.queryDeviceStatus(o),t.push({areacode:parseInt(o.areacode),addr:parseInt(o.addr)}))}}},sendQueryDeviceStatusOne:function(e){p.a.queryDeviceStatus(e)},sendQueryDeviceProperty:function(e,t){p.a.queryDeviceProperty(e,t)},log:function(e){var t=new Date,i=t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+" "+e;(console.log("show log:"+i),null!=this.root)&&(this.root.$data.logList.logs.unshift(i)>50&&this.root.$data.logList.logs.splice(50,1))}},m()(a,"bytes2hex",function(t){for(var i="",a=0;a<t.length;a++)i=i+e.from([t[a]]).toString("hex")+" ";return i}),m()(a,"bytes2hexNoSpace",function(t){for(var i="",a=0;a<t.length;a++)i=i+e.from([t[a]]).toString("hex")+"";return i}),m()(a,"hexStringToBytes",function(t){if(null==t||0==t.length)return null;var i=[];if((t=t.toUpperCase()).indexOf(" ")>=0)i=t.trim().split(" ");else{for(var a=t.length/2,o=0;o<a;o++)i.push(0);for(o=0;o<i.length;o++)i[o]=t.substring(2*o,2*o+2)}var s=i.length,n=[];for(o=0;o<s;o++)n.push(parseInt(i[o],16));return e.from(n)}),m()(a,"uuid",function(){return C()+C()+"-"+C()+"-"+C()+"-"+C()+"-"+C()+C()+C()}),m()(a,"saveProject",function(e){if(null!=e&&null!=e.id&&""!=e.id){for(var t=0;t<this.golbal.projectList.length;t++)null==this.golbal.projectList[t].project?this.golbal.projectList[t].id==e.id&&(this.golbal.projectList[t]=e):this.golbal.projectList[t].project.id==e.id&&(this.golbal.projectList[t].project=e);this.golbal.myProject.id==e.id&&this.getData(e),this.saveLocalSystem("projectList"+this.golbal.userId+".json",v()(this.golbal.projectList)),console.log("saved")}}),m()(a,"saveLocalSystem",function(e,t){if(0!=this.golbal.projectList.length){var i={action:"APP_BACKUP_PROJECT_LOCAL"};i.project=this.golbal.myProject,i.accessToken=this.golbal.accessToken,f.a.post(this.golbal.GET_DATA,i,{header:{"Content-Type":"application/jsonp"}}).then(function(e){"SUCCESS"==e.data.status?console.log("save success"):console.log("save error "+e.data.errorMessage)})}else this.golbal.myProject=JSON.parse(v()(this.golbal.myProjectDemo))}),m()(a,"readLocalSystem",function(e){return JSON.parse(window.localStorage.getItem(e))}),m()(a,"saveSetting",function(){var e=window.localStorage;e.setItem("themeCur",this.golbal.themeCur),e.setItem("isGallery",this.golbal.isGallery?1:0)}),m()(a,"setFavourite",function(e){var t=e;if(null==this.MyProject.favouriteList){var i=window.localStorage.getItem("favouriteList"),a=null;a=null!=i?i.split(","):[],this.MyProject.favouriteList=a}this.MyProject.favouriteList.indexOf(t)>-1?this.MyProject.favouriteList.splice(this.MyProject.favouriteList.indexOf(t),1):this.MyProject.favouriteList.push(t),this.saveProject(this.MyProject)}),m()(a,"getFavourite",function(){if(null!=this.MyProject&&null==this.MyProject.favouriteList){var e=window.localStorage.getItem("favouriteList");return this.MyProject.favouriteList=null!=e?e.split(","):[],this.MyProject.favouriteList}return null}),m()(a,"scanQrcode",function(e,t){var i=this,a=e+"&uuid="+this.golbal.myUuid;f.a.post(a).then(function(e){"SUCCESS"==e.data.status?(null!=e.data.projectListLocal&&e.data.projectListLocal.length>0&&(i.golbal.projectList=e.data.projectListLocal),null!=t&&t(e.data.projectId)):alert(e.data.errorMessage)}).catch(function(e){console.log(e)})}),m()(a,"scanQRCodeLocal",function(e){if(null!=e.ips&&!(e.ips.length<=0)&&null!=e.projectId)for(var t=this,i=!1,a=0;a<e.ips.length;a++)if(!i){var o="http://"+e.ips[a]+":3003/api?action=GET_PROJECT_APP&project_id="+e.projectId;f.a.get(o,{},{timeout:3e3}).then(function(e){"SUCCESS"==e.data.status?(t.getData(e.data.project),alert("获取成功"),i=!0):(alert("获取失败"),console.log(e.data.errorMessage))}).catch(function(e){console.log(e)})}}),m()(a,"getData",function(e,t){if(null==e)return this.golbal.roomCur={},this.golbal.floorCur={rooms:[]},this.golbal.blockCur={floors:[]},this.golbal.myProject={},void window.localStorage.setItem("myProject",v()(this.golbal.myProject));var i="",a="";null!=this.golbal.roomCur&&(i=this.golbal.roomCur.id),null!=this.golbal.floorCur&&(a=this.golbal.floorCur.id);var o=!0;if((o=null==this.golbal.myProject||null==this.golbal.myProject.id||(this.golbal.myProject.id!=e.id||(null==this.golbal.myProject.buses||this.golbal.myProject.buses.length<=0)))&&null!=this.golbal.myProject&&null!=this.golbal.myProject.buses&&this.golbal.myProject.buses.length>0)for(var s=0;s<this.golbal.myProject.buses.length;s++){var n=this.golbal.myProject.buses[s];Object(b.c)(n.ws_url)}window.localStorage.setItem("myProject",v()(e)),this.golbal.myProject=e;for(s=0;s<this.golbal.myProject.blocks.length;s++){var l=this.golbal.myProject.blocks[s];l.active=!1;for(var c=0;c<l.floors.length;c++){(p=l.floors[c]).active=!1;for(var r=0;r<p.rooms.length;r++){p.rooms[r].active=!1}}}if(o&&null!=this.golbal.myProject&&null!=this.golbal.myProject.buses&&this.golbal.myProject.buses.length>0)for(s=0;s<this.golbal.myProject.buses.length;s++){n=this.golbal.myProject.buses[s];setTimeout(b.e,2e3*s,_.a.receiveData,n.ws_url)}this.golbal.blockCur=this.golbal.myProject.blocks[0],this.golbal.blockCur.active=!0,null!=this.golbal.blockCur.floors&&this.golbal.blockCur.floors.length>0&&(this.golbal.floorCur=this.golbal.blockCur.floors[0],this.golbal.floorCur.active=!0,null!=this.golbal.floorCur.rooms&&this.golbal.floorCur.rooms.length>0&&(this.golbal.roomCur=this.golbal.floorCur.rooms[0],this.golbal.roomCur.active=!0));var u=[];s=0,c=0;for(s=0;s<this.golbal.myProject.blocks.length;s++)for(c=0;c<this.golbal.myProject.blocks[s].floors.length;c++){this.golbal.myProject.blocks[s].floors[c].isOn=!1;for(r=0;r<this.golbal.myProject.blocks[s].floors[c].rooms.length;r++)if(this.golbal.myProject.blocks[s].floors[c].rooms[r].isOn=!1,null!=this.golbal.myProject.blocks[s].floors[c].rooms[r].devices)for(var d=0;d<this.golbal.myProject.blocks[s].floors[c].rooms[r].devices.length;d++){var m={};m.device=this.golbal.myProject.blocks[s].floors[c].rooms[r].devices[d],m.device.roomId=this.golbal.myProject.blocks[s].floors[c].rooms[r].id,m.busId=this.golbal.myProject.blocks[s].floors[c].rooms[r].busId,m.device.isOn=!1,null!=m.device.value&&(m.device.value=0),u.push(m)}}this.devicesAll=u,this.MyProject=this.golbal.myProject;var h=this.getFavourite();if(null!=h)for(s=0;s<u.length;s++)u[s].device.isFavorite=!1,h.indexOf(u[s].device.id)>-1&&(u[s].device.isFavorite=!0);if(""!=a&&""!=i&&null!=this.golbal.myProject.blocks){for(s=0;s<this.golbal.myProject.blocks[0].floors.length;s++){var p;(p=this.golbal.myProject.blocks[0].floors[s]).id==a&&(this.golbal.floorCur=p,this.golbal.floorCur.active=!0)}if(null!=this.golbal.floorCur)for(s=0;s<this.golbal.floorCur.rooms.length;s++){var g=this.golbal.floorCur.rooms[s];g.active=!1,g.id==i&&(g.active=!0,this.golbal.roomCur=g)}}null!=t&&t()}),m()(a,"cleanProject",function(){if(0==this.golbal.myProject.isMaster){for(var e=!1,t=0;t<this.golbal.projectListCloud.length;t++){var i=this.golbal.projectListCloud[t];this.golbal.myProject.id==i.projectId&&(e=!0)}e||this.getData(null)}}),m()(a,"deleteLocalProject",function(e){for(var t=!1,i=this.golbal.projectList.length-1;i>=0;i--){var a=this.golbal.projectList[i];a.id!=e&&a.projectId!=e||(this.golbal.projectList.splice(i,1),t=!0)}return t}),m()(a,"resetProjectAdmin",function(e,t,i){for(var a=this,o=this.golbal.projectList.length-1;o>=0;o--){(s=this.golbal.projectList[o]).id==e&&(s.isAdmin=t)}if(this.golbal.myProject.id==e&&(this.golbal.myProject.isAdmin=t,null!=i&&(this.golbal.myProject.isMaster=i)),null!=i&&1==i)for(o=this.golbal.projectList.length-1;o>=0;o--){var s;(s=this.golbal.projectList[o]).parentId==e&&(this.golbal.projectList.splice(o,1),this.golbal.myProject.id==s.id&&this.getData(null))}var n={action:"APP_RESUME_PROJECT"};n.id=e,n.accessToken=this.golbal.accessToken,f.a.post(this.golbal.GET_DATA,n,{header:{"Content-Type":"application/jsonp"}}).then(function(e){"SUCCESS"==e.data.status&&a.loadProjectList()})}),m()(a,"updateProject",function(e){var t=this,i={action:"APP_RESUME_PROJECT"};i.id=e,i.accessToken=this.golbal.accessToken,f.a.post(this.golbal.GET_DATA,i,{header:{"Content-Type":"application/jsonp"}}).then(function(e){if("SUCCESS"==e.data.status){var i=e.data.project;null==i.projectName&&(i.projectName=i.name),null==i.projectSummary&&(i.projectSummary=i.summary),i.localUserId=t.golbal.userId,null!=t.golbal.myProject&&i.id!=t.golbal.myProject.id&&i.id!=t.golbal.myProject.projectId||t.getData(i,function(){t.golbal.qrcode="http://app.lk-control.com/txt2qrcode?txt="+escape(t.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+t.golbal.projectId)})}})}),m()(a,"loadProjectAndInit",function(){this.golbal.fullscreenLoading=!0}),m()(a,"addDesignLogic",function(e,t){for(var i=0;i<this.golbal.arrDesignLogic.length;i++){var a=this.golbal.arrDesignLogic[i];if(a.addr==e.addr&&a.channel==e.channel&&a.name==e.name)return void(a.status=this.getDeviceStatus(e))}var o={name:e.name,addr:e.addr,channel:e.channel,room:this.golbal.roomCur.name,floor:this.golbal.floorCur.name,status:this.getDeviceStatus(e)};this.golbal.arrDesignLogic.push(o)}),m()(a,"getDeviceStatus",function(e){var t={};switch(e.type){case"light":t.label="开关",t.display=e.isOn?"开":"关",t.value=e.isOn?1:0;break;case"dimmer":t.label="亮度",t.display=e.value,t.value=e.value;break;case"process_curtain":case"curtain":t.label="进程",t.display=e.value,t.value=e.value;break;case"ac":break;case"scene":case"module_light":t.label="开关",t.display=e.isOn?"开":"关",t.value=e.isOn?1:0;break;case"module_dimmer":t.label="亮度",t.display=e.value,t.value=e.value}return t}),m()(a,"loadProjectShare",function(e){var t=this,i={action:"APP_LOAD_PROJECT_SHARE"};i.uuid=this.golbal.myUuid,i.projectId=null==e?this.golbal.myProject.id:e,f.a.post(this.golbal.GET_DATA,i,{header:{"Content-Type":"application/jsonp"}}).then(function(e){if("SUCCESS"==e.data.status){t.golbal.projectShare=e.data.records;for(var i=0;i<t.golbal.projectShare.length;i++)null==t.golbal.projectShare[i].isAdmin||0==t.golbal.projectShare[i].isAdmin?t.golbal.projectShare[i].isAdmin=!1:t.golbal.projectShare[i].isAdmin=!0}else t.golbal.projectShare=[]})}),m()(a,"loadProjectList",function(){var e=this,t={action:"APP_GET_PROJECT_LIST"};t.accessToken=this.golbal.accessToken,f.a.post(this.golbal.GET_DATA,t,{header:{"Content-Type":"application/jsonp"}}).then(function(t){"SUCCESS"==t.data.status&&(null!=t.data.projectListLocal&&t.data.projectListLocal.length>0&&(e.golbal.projectList=t.data.projectListLocal),"/project"==e.Router.currentRoute.path&&e.root.$refs.routerView.initProjectList())})}),m()(a,"resumeProjectLocal",function(e,t,i){var a=this,o=e;if(null==e){if(!(this.golbal.projectList.length>0))return o=JSON.parse(v()(this.golbal.myProjectDemo)),this.golbal.myProject=o,void a.getData(o,function(){});o=this.golbal.projectList[0],this.golbal.myProject=o}else if(0==this.golbal.projectList.length)return void(this.golbal.myProject=JSON.parse(v()(this.golbal.myProjectDemo)));for(var s=0;s<this.golbal.projectList.length;s++)this.golbal.projectList[s].isDefault=0;o.isDefault=1;var n={action:"APP_RESUME_PROJECT_LOCAL"};n.id=null==o.projectId?o.id:o.projectId,n.accessToken=t.golbal.accessToken,null!=this.golbal.myProject&&null!=e&&(n.nowProject=this.golbal.myProject),f.a.post(t.golbal.GET_DATA,n,{header:{"Content-Type":"application/jsonp"}}).then(function(e){if("SUCCESS"==e.data.status){var o=e.data.project;o.isDefault=1,a.golbal.projectId=o.projectId,a.golbal.isMaster=o.isMaster,a.golbal.isAdmin=o.isAdmin,Object(b.b)(),a.golbal.floorCur=null,a.golbal.roomCur=null,a.getData(o,function(){t.visibleBlock=!1,null!=t.$route&&("/room"!=t.$route.path&&"/favorite"!=t.$route.path||setTimeout(function(){a.sendQueryDeviceStatus(),a.getTypeStatus()},1e3)),null!=i&&i(),t.golbal.qrcode="http://app.lk-control.com/txt2qrcode?txt="+escape(t.golbal.HOST+"/do?action=APP_SCAN_QRCODE&type=share&project_id="+t.golbal.projectId)})}})}),m()(a,"checkIsMaster",function(){return 1==this.golbal.myProject.isMaster||1==this.golbal.myProject.isAdmin}),m()(a,"isDevEqual",function(e,t){if(null==e||null==t)return!1;if(e.type!=t.type)return!1;if(null==e.channel&&null==t.channel){if(e.areacode==t.areacode&&e.addr==t.addr&&e.typecode==t.typecode)return!0}else if(e.areacode==t.areacode&&e.addr==t.addr&&e.typecode==t.typecode&&e.channel==t.channel)return!0;return!1}),m()(a,"updateSceneSummary",function(e,t,i,a){console.log("updateSceneSummary");for(var o=0;o<e.scenes.length;o++){var s=e.scenes[o];if(null!=s.actions.length)for(var n=0;n<s.actions.length;n++){var l=s.actions[n],c=null;if(null!=l.device&&(c=l.device),null!=l.deviceId&&(c=this.getVODeviceById(l.deviceId)),this.isDevEqual(c,t)){l.deviceId=t.id,l.deviceName=i+" "+a+" "+t.name,l.summary=i+" "+a+" "+t.name,console.log(l);var r=y.a.DEVICE_ACTION_DEFINE[t.type];if("boolean"==r.actions[0].type)"scene"!=c.deviceType&&(l.summary=l.summary+" "+(l.status.value?"开":"关"));else if("int"==r.actions[0].type)l.summary=l.summary+" "+(l.name+l.status.value);else if("enum"==r.actions[0].type){var u="";for(n=0;n<l.enum.length;n++)l.status.value==l.enum[n].value&&(u=l.enum[n].name);l.summary=l.summary+" "+u}else"ac"==r.actions[0].type?(l.summary=l.summary+" ",l.summary=action.summary+(l.status.ac.isOn?"开":"关"),l.status.ac.isOn&&(l.summary=l.summary+" "+l.status.ac.value+"℃",l.summary=l.summary+" "+l.status.ac.mode,l.summary=l.summary+" "+("1"==l.status.ac.fan?"低速":"2"==l.status.ac.fan?"中速":"3"==l.status.ac.fan?"高速":"自动"))):"heating"==r.actions[0].type?(l.summary=l.summary+" ",l.summary=l.summary+(l.status.heat.isOn?"开":"关"),l.status.heat.isOn&&(l.summary=l.summary+" "+l.status.heat.value+"℃")):"fan"==r.actions[0].type?(l.summary=l.summary+" ",l.summary=l.summary+(l.air.isOn?"开":"关"),l.air.isOn&&(l.summary=l.summary+" "+("1"==l.status.ac.fan?"低速":"2"==l.status.ac.fan?"中速":"3"==l.status.ac.fan?"高速":"自动"))):"combo"==r.actions[0].type&&(l.summary=l.summary,l.ac.isOn&&(l.summary=l.summary+" 空调:开",l.summary=l.summary+" "+l.status.ac.value+"℃",l.summary=l.summary+" "+l.status.ac.mode,l.summary=l.summary+" "+("1"==l.status.ac.fan?"低速":"2"==l.status.ac.fan?"中速":"3"==l.status.ac.fan?"高速":"自动")),l.status.heat.isOn&&(l.summary=l.summary+" 地暖:开",l.summary=l.summary+" "+l.status.heat.value+"℃"),l.status.air.isOn&&(l.summary=l.summary+" 新风:开",l.summary=l.summary+" "+("1"==l.status.ac.fan?"低速":"2"==l.status.ac.fan?"中速":"3"==l.status.ac.fan?"高速":"自动")))}}}}),m()(a,"onGetQRData",function(e){for(var t=this,i=0;i<this.golbal.projectList.length;i++){var a=this.golbal.projectList[i];if(a.id==e||a.projectId==e)return this.resumeProjectLocal(a,this),void setTimeout(function(){t.Router.push({path:"/room"})},1e3)}}),a);var E={num:1,upFileName:""};function T(e){return new u.a(function(t,i){window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,function(i){console.log("文件存储路径: "+cordova.file.externalDataDirectory),i.getFile(e+".txt",{create:!1},function(e){console.log("指定目录下获取到相关文件 --基础文件信息",e),e.file(function(i){var a=new FileReader;a.onloadend=function(o){console.log("文件信息："+e),console.log("文件信息："+i),t(a.result)},a.readAsText(i)})},function(e){console.log("getFile错误",e),t("")})},function(e){console.log("resolveLocalFileSystemURL错误",e)})})}}).call(t,i("EuP9").Buffer)},kDt2:function(e,t){},ktjB:function(e,t){},oSA3:function(e,t){},uorx:function(e,t){},uxah:function(e,t,i){"use strict";(function(e){var a=i("mvHQ"),o=i.n(a),s=i("NVJ6"),n=i("gQoh");function l(e,t){if(194==t[7]){var i=e;if(1==t[9]&&(i=e.ac),2==t[9]&&(i=e.heat),3==t[9]&&(i=e.air),1==t[10]&&(i.isOn=1==t[11]),2==t[10]&&(i.value=t[11]),3==t[10])switch(t[11]){case 1:i.mode="制冷";break;case 2:i.mode="制热";break;case 3:i.mode="送风"}4==t[10]&&(i.fan=t[11]),5==t[10]&&(e.air.lock=t[11])}else{e.ac.value=t[9];var a=t[8];switch(e.ac.isOn=a>>7==1,e.air.lock=a>>5&3,e.ac.fan=a>>3&3,3&a){case 1:e.ac.mode="制冷";break;case 2:e.ac.mode="制热";break;case 3:e.ac.mode="送风";break;default:e.ac.mode="恒温"}e.heat.value=t[11];var o=t[10];e.heat.isOn=o>>7==1,e.air.value=t[13];var s=t[12];e.air.isOn=s>>7==1,e.air.fan=s>>3&3,e.value=((128&t[14])>0?-1:1)*(127&t[14])}}function c(e,t){if(194==t[7]){if(1==t[8]&&1==t[9]){if(1==t[10]&&(e.isOn=1==t[11]),2==t[10]&&(e.value=t[11]),3==t[10])switch(t[11]){case 1:e.mode="制冷";break;case 2:e.mode="制热";break;case 3:e.mode="送风"}4==t[10]&&(e.fan=t[11]),5==t[10]&&(e.lock=t[11])}}else{e.value=t[9];var i=t[8];switch(e.isOn=i>>7==1,e.lock=i>>5&3,e.fan=i>>3&3,3&i){case 1:e.mode="制冷";break;case 2:e.mode="制热";break;case 3:e.mode="送风";break;default:e.mode="恒温"}t.length>14?e.actValue=((128&t[14])>0?-1:1)*(127&t[14]):e.actValue=((128&t[10])>0?-1:1)*(127&t[10]),e.summary=e.mode+" "+e.value+"℃"}}function r(e,t){if(194==t[7])1==t[8]&&2==t[9]&&(1==t[10]&&(e.isOn=1==t[11]),2==t[10]&&(e.value=t[11]),5==t[10]&&(e.lock=t[11]));else{e.value=t[11];var i=t[10];e.isOn=i>>7==1,e.lock=i>>5&3}}function u(e,t){if(194==t[7])1==t[8]&&3==t[9]&&(1==t[10]&&(e.isOn=1==t[11]),4==t[10]&&(e.fan=t[11]),5==t[10]&&(e.lock=t[11]));else{e.value=t[13];var i=t[12];e.isOn=i>>7==1,e.lock=i>>5&3,e.fan=i>>3&3}}function d(e,t,i){"sensor_temperature"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_TEMPERATURE?t[8]>0?e.value=0-t[9]:e.value=t[9]:"sensor_humidity"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_HUMIDITY?e.value=(t[8]<<8)+t[9]:"sensor_brightness"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_BRIGHTNESS?e.value=(t[8]<<8)+t[9]:"sensor_pm25"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PM25?e.value=(t[8]<<8)+t[9]:"sensor_hcho"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_HCHO?e.value=(t[8]<<8)+t[9]:"sensor_co2"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_CO2?e.value=(t[8]<<8)+t[9]:"sensor_pules"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_PULES?e.value=(t[8]<<8)+t[9]:"sensor_switch"==e.type&&i==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SENSOR_SWITCH&&e.channel==t[8]&&(e.isOn=100==t[9])}t.a={receiveData:function(t,i){var a=null;if(null!=i&&i.startsWith("ws:")&&(a=n.a.getVOBusByWSURL(i)),console.log("<== "+n.a.bytes2hex(t)),123!=t[0]||125!=t[t.length-1]){if(t.length==t[2]&&66!=t[7]){var m=(t[5]<<8)+t[6];if(n.a.golbal.scanDevice.isGet&&function(e,t){var i=e[3],a=e[4],l=e[7],c=e[8],r=(e[5]<<8)+e[6],u=n.a.getDeviceTypeStr(r);if(128==l&&48==c){n.a.golbal.scanDevice.isGet=!1;var d={deviceType:"",channel:0,keyValue:0,locals:[]},m=n.a.uuid();n.a.golbal.scanDevice.channelList=[],n.a.golbal.scanDevice.addr=a,n.a.golbal.scanDevice.areacode=i,n.a.golbal.scanDevice.panelId=m,n.a.golbal.scanDevice.bus=t;var h=null;if(3==e[5])for(var v=9;v<=16;v++){var p=null,g=s.a.channelDefineByKeyValue(e[v]);if(null!=g){for(var f=0;f<n.a.golbal.scanDevice.channelList.length;f++)(h=n.a.golbal.scanDevice.channelList[f]).channel==g.channel&&h.deviceType==g.type&&(p=h);null!=p?p.locals.push({lo:v-8,type:g.func}):((p=JSON.parse(o()(d))).deviceType=g.type,p.channel=g.channel,p.keyValue=g.value,p.locals.push({lo:v-8,type:g.func}),p.panelId=m,p.isSwitch=(e[17]&v-9)>0,n.a.golbal.scanDevice.channelList.push(p))}}else if(5==e[5]){var b="";1==e[6]&&(b="module_light"),2==e[6]&&(b="module_dimmer");for(var v=1;v<=e[9];v++){var p=JSON.parse(o()(d));p.deviceType=b,p.channel=v,n.a.golbal.scanDevice.channelList.push(p)}}else h={deviceType:u[0],channel:1},n.a.golbal.scanDevice.channelList.push(h);return void console.log(n.a.golbal.scanDevice)}for(var _=!1,v=0;v<n.a.devicesAll.length;v++){var y=n.a.devicesAll[v];!_&&y.areacode==i&&y.addr==a&&u.indexOf(y.deviceType)>-1&&(console.log("设备已存在"),console.log(y),_=!0)}_||n.a.sendQueryDeviceProperty(i,a)}(t,a),n.a.golbal.waitingBusReturn&&(n.a.golbal.waitingBusReturn=!1),128!=t[7]||49!=t[8]||1!=t[9]){for(f=0;f<n.a.devicesAll.length;f++){var h=n.a.devicesAll[f].device;if(t[3]==h.areacode&&t[4]==h.addr)if("light"==h.type){if(h.isSwitch&&135!=t[7]&&199!=t[7]&&198!=t[7])if(m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT)if(129==t[7]||193==t[7]){var v=(t[11]<<8)+t[10];h.isOn=(v&Math.pow(2,h.channel-1))>0}else h.channel==t[8]&&(h.isOn=100==t[9]);else if(m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_SCENE)if(129==t[7]||193==t[7]){v=(t[11]<<8)+t[10];h.isOn=(v&Math.pow(2,h.channel-1))>0}else h.channel==t[8]&&(h.isOn=100==t[9]);else m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE&&(129!=t[7]&&193!=t[7]||null==t[h.channel+9]?h.channel==t[8]&&(h.isOn=100==t[9]):h.isOn=100==t[h.channel+9])}else if("scene"==h.type)h.isSwitch&&(m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_SCENE?130!=t[7]&&194!=t[7]&&198!=t[7]&&(129==t[7]||193==t[7]?h.isOn=(t[9]&Math.pow(2,h.channel-1))>0:h.channel==t[8]&&(h.isOn=100==t[9])):m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_SCENE&&m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN_SCENE&&m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_SCENE&&m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE||130!=t[7]&&194!=t[7]&&198!=t[7]&&(129==t[7]||193==t[7]?h.isOn=(t[9]&Math.pow(2,h.channel-1))>0:h.channel==t[8]&&(h.isOn=100==t[9])));else if("dimmer"==h.type)135!=t[7]&&199!=t[7]&&198!=t[7]&&197!=t[7]&&(m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER?129==t[7]||193==t[7]?1==h.channel?h.value=t[10]:h.value=t[11]:h.channel==t[8]&&(h.value=t[9]):m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_DIMMER_SCENE&&m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE||(129==t[7]||193==t[7]?1==h.channel?h.value=t[10]:2==h.channel?h.value=t[11]:3==h.channel&&t.length>13?h.value=t[12]:4==h.channel&&t.length>14&&(h.value=t[13]):h.channel==t[8]&&(h.value=t[9])));else if("process_curtain"==h.type)135!=t[7]&&199!=t[7]&&198!=t[7]&&197!=t[7]&&(m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN?129==t[7]||193==t[7]?1==h.channel?h.value=t[10]:h.value=t[11]:h.channel==t[8]&&(h.value=t[9]):m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN_SCENE&&m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE||(129==t[7]||193==t[7]?1==h.channel?h.value=t[10]:2==h.channel?h.value=t[11]:3==h.channel&&t.length>13?h.value=t[12]:4==h.channel&&t.length>14&&(h.value=t[13]):h.channel==t[8]&&(h.value=t[9])));else if("curtain"==h.type)135!=t[7]&&199!=t[7]&&198!=t[7]&&(m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN?129==t[7]||193==t[7]?1==h.channel?h.value=t[10]:h.value=t[11]:h.channel==t[8]&&(h.value=t[9]):m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_CURTAIN_SCENE&&m!=s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_LIGHT_DIMMER_SCENE||(129==t[7]||193==t[7]?1==h.channel?h.value=t[10]:2==h.channel?h.value=t[11]:3==h.channel&&t.length>13?h.value=t[12]:4==h.channel&&t.length>14&&(h.value=t[13]):h.channel==t[8]&&(h.value=t[9])));else if("ac"==h.type&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AC)c(h,t);else if("heating"==h.type&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_HEAT)r(h,t);else if("fan"==h.type&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_AIR)u(h,t);else if("combo"==h.type&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_TEMPERATURE_COMBO)l(h,t);else if("module_light"==h.type){if(h.isSwitch&&135!=t[7]&&199!=t[7]&&198!=t[7]&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_LIGHT)if(129==t[7]||193==t[7]){v=(t[12]<<24)+(t[11]<<16)+(t[10]<<8)+t[9];h.isOn=(v&Math.pow(2,h.channel-1))>0}else h.channel==t[8]&&(h.isOn=100==t[9])}else"module_dimmer"==h.type?135!=t[7]&&199!=t[7]&&198!=t[7]&&197!=t[7]&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_MODULE_DIMMER&&(129==t[7]||193==t[7]?1==h.channel?h.value=t[9]:2==h.channel?h.value=t[10]:3==h.channel?h.value=t[11]:4==h.channel&&(h.value=t[12]):h.channel==t[8]&&(h.value=t[9])):"nl_lock"==h.type&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_NL_LOCK?135!=t[7]&&199!=t[7]&&198!=t[7]&&m==s.a.DEVICE_TYPE_ENUM.DEVICE_TYPE_NL_LOCK&&(129==t[7]||193==t[7]?1==t[8]?h.isOn=!0:0==t[8]?h.isOn=!1:t[8]:1==t[8]?h.isOn=!0:0==t[8]&&(h.isOn=!1)):h.type.startsWith("sensor")&&d(h,t,m)}n.a.getTypeStatus()}else n.a.BusReturn=t}}else{console.log(e.from(t).toString());var p=JSON.parse(e.from(t).toString());if(null!=p.deleteProjects&&p.deleteProjects.length>0){for(var g=!1,f=0;f<p.deleteProjects.length;f++)n.a.deleteLocalProject(p.deleteProjects[f].projectId)&&(g=!0);g&&(n.a.resumeProjectLocal(null,n.a.root),setTimeout(function(){n.a.Router.push({path:"/room"})},1e3))}if(null!=p.resetProjects&&p.resetProjects.length>0)for(var f=0;f<p.resetProjects.length;f++)n.a.resetProjectAdmin(p.resetProjects[f].projectId,p.resetProjects[f].isAdmin,p.resetProjects[f].isMaster),console.log("my project is admin="+n.a.golbal.myProject.isAdmin),n.a.golbal.myProject.id==p.resetProjects[f].projectId&&n.a.getData(n.a.golbal.myProject,function(){});if(null!=p.updateProjects&&p.updateProjects.length>0)for(f=0;f<p.updateProjects.length;f++)n.a.updateProject(p.updateProjects[f].projectId),n.a.golbal.myProject.id==p.updateProjects[f].projectId&&n.a.getData(n.a.golbal.myProject,function(){n.a.Router.push({path:"/room"})});if(null!=p.newSharedProjects&&p.newSharedProjects.length>0&&(n.a.loadProjectList(),p.newSharedProjects.length>0&&setTimeout(function(){n.a.onGetQRData(p.newSharedProjects[0].projectId)},1e3)),null!=p.weather&&"1"==p.weather.status){var b=p.weather.lives[0],_="";b.weather.indexOf("雨")>-1?_+='<i  class="el-icon-heavy-rain"></i>':b.weather.indexOf("雪")>-1?_+='<i class="el-icon-light-rain"></i>':b.weather.indexOf("雷")>-1?_+='<i class="el-icon-lightning"></i>':b.weather.indexOf("阴")>-1||b.weather.indexOf("云")>-1?_+='<i class="el-icon-cloudy"></i>':_+='<i style="font-size:20px" class="el-icon-sunny"></i>',_=(_='<div style="float:left">'+_+"</div>")+"&nbsp;&nbsp;"+b.temperature+"℃&nbsp;Temp&nbsp;&nbsp;|&nbsp;&nbsp;"+b.humidity+"%&nbsp;RH&nbsp;",_+='<i class="el-icon-arrow-right"></i>',n.a.golbal.weather=_}if(null!=p.busesStatus&&p.busesStatus.length>0)for(f=0;f<n.a.golbal.myProject.buses.length;f++){a=n.a.golbal.myProject.buses[f];for(var y=0;y<p.busesStatus.length;y++)null==a.addr&&(a.addr=""),a.addr.toLowerCase()==p.busesStatus[y].addr.toLowerCase()&&(1==p.busesStatus[y].isOnline?a.isOnline=!0:0==p.busesStatus[y].isOnline&&(a.isOnline=!1))}}}}}).call(t,i("EuP9").Buffer)},ymNt:function(e,t){},z08P:function(e,t){}},["NHnr"]);